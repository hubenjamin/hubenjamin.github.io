<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 14">
<meta name=Originator content="Microsoft Word 14">



<link rel=File-List href="SAG_files/filelist.xml">
<link rel=Edit-Time-Data
href="SAG_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Bin Hu</o:Author>
  <o:LastAuthor>Bin Hu</o:LastAuthor>
  <o:Revision>46</o:Revision>
  <o:TotalTime>58</o:TotalTime>
  <o:Created>2014-12-16T05:34:00Z</o:Created>
  <o:LastSaved>2014-12-17T06:15:00Z</o:LastSaved>
  <o:Pages>57</o:Pages>
  <o:Words>32494</o:Words>
  <o:Characters>185221</o:Characters>
  <o:Company>AT&amp;T</o:Company>
  <o:Lines>1543</o:Lines>
  <o:Paragraphs>434</o:Paragraphs>
  <o:CharactersWithSpaces>217281</o:CharactersWithSpaces>
  <o:Version>14.00</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=themeData
href="SAG_files/themedata.thmx">
<link rel=colorSchemeMapping
href="SAG_files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>130</w:Zoom>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-US</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:EnableOpenTypeKerning/>
   <w:DontFlipMirrorIndents/>
   <w:OverrideTableStyleHps/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="true"
  DefSemiHidden="true" DefQFormat="false" DefPriority="99"
  LatentStyleCount="267">
  <w:LsdException Locked="false" Priority="0" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 9"/>
  <w:LsdException Locked="false" Priority="35" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" Priority="10" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" Priority="1" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" Priority="11" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" Priority="22" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" Priority="59" SemiHidden="false"
   UnhideWhenUsed="false" Name="Table Grid"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" QFormat="true" Name="TOC Heading"/>
 </w:LatentStyles>
</xml><![endif]-->

<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1030"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
 

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<meta name="format-detection" content="telephone=no">

<link rel="stylesheet" href="css/html5reset-1.6.1.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/tools.css" type="text/css" />
 
</head>

<body lang=EN-US link=blue vlink=purple>

<div class=WordSection1>

<h2><b><span>Smarter Apps for Smarter Phones</span></b><span><o:p></o:p></span></h2>

<p class=MsoNormal><b><span>Version 4.0</span></b><span><o:p></o:p></span></p>

<p class=MsoNormal><b><span>03 November 2014</span></b><span><o:p></o:p></span></p>

<p class=MsoNormal><i><span>This is a Non-binding
Permanent Reference Document of the GSMA</span></i><span><o:p></o:p></span></p>

<p class=MsoNormal><b><span>Security Classification:
Non-confidential</span></b><span><o:p></o:p></span></p>

<p class=MsoNormal><span>Access to and
distribution of this document is restricted to the persons permitted by the
security classification. This document is confidential to the Association and
is subject to copyright protection. This document is to be used only for the
purposes for which it has been supplied and information contained in it must
not be disclosed or in any other way made available, in whole or in part, to
persons other than those permitted under the security classification without
the prior written approval of the Association.<o:p></o:p></span></p>

<p class=MsoNormal><b><span>Copyright Notice</span></b><span><o:p></o:p></span></p>

<p class=MsoNormal><span>Copyright &copy; 2014 GSM
Association<o:p></o:p></span></p>

<p class=MsoNormal><b><span>Disclaimer</span></b><span><o:p></o:p></span></p>

<p class=MsoNormal><span>The GSM Association
("Association") makes no representation, warranty or undertaking (express or
implied) with respect to and does not accept any responsibility for, and hereby
disclaims liability for the accuracy or completeness or timeliness of the
information contained in this document. The information contained in this
document may be subject to change without prior notice.<o:p></o:p></span></p>

<p class=MsoNormal><b><span>Antitrust Notice</span></b><span><o:p></o:p></span></p>

<p class=MsoNormal><span>The information contain
herein is in full compliance with the GSM Association's antitrust compliance
policy.<o:p></o:p></span></p>

<p class=MsoNormal><b><span>Table of Contents</span></b><span><o:p></o:p></span></p>

<p class="MsoNormal list_item"><a href="#1_to_application_developers"><span><strong>1</strong>
To Application Developers</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#2_introduction"><strong>2</strong><span> Introduction</span></b></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#2_1_overview"><span><strong>2.1</strong>
Overview</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#2_2_scope"><span><strong>2.2</strong>
Scope</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#2_2_1_who_should_read_this_document"><span><strong>2.2.1</strong> Who Should Read this <span
class=GramE>Document</span></span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#2_2_2_organisation_of_the_document"><span><strong>2.2.2</strong> <span class=SpellE>Organisation</span>
of the Document</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#2_3_definition_of_terms"><span><strong>2.3</strong>
Definition of Term</span></a><span>s<o:p></o:p></span></p>

<p class=MsoNormal><a
href="#3_network_friendliness"><strong>3</strong><span> Network Friendliness</span></b></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#3_1_requirements_and_constraints_in_mobile_broadband"><span><strong>3.1</strong>
Requirements and Constraints in Mobile Broadband</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#3_2_smooth_user_experience"><span><strong>3.2</strong> Smooth
User Experience</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#3_2_1_asynchrony"><span><strong>3.2.1</strong> Asynchrony</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#3_2_2_non-blocking_user_interface"><span><strong>3.2.2</strong> Non-blocking User Interface</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#3_2_3_offline_mode"><span><strong>3.2.3</strong> Offline Mode</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#3_2_4_bandwidth_awareness"><span><strong>3.2.4</strong> Bandwidth Awareness</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#3_3_efficient_network_connection_usage"><span><strong>3.3</strong>
Efficient Network Connection Usage</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_ideal_mobile_application"><strong>4</strong><span>Ideal Mobile
Application</span></b></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_1_asynchrony"><span><strong>4.1</strong>
Asynchrony</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_2_connection_loss_and_error_handling"><span><strong>4.2</strong>
Connection Loss and Error Handling</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_3_security"><span><strong>4.3</strong>
Security</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_3_1_classification_of_information"><span><strong>4.3.1</strong> Classification of Information</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_3_2_authentication"><span><strong>4.3.2</strong> Authentication</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_3_3_secure_data_exchange"><span><strong>4.3.3</strong> Secure Data Exchange</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_3_4_input_validation"><span><strong>4.3.4</strong> Input Validation</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_3_5_ideal_platform"><span><strong>4.3.5</strong> Ideal platform</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_4_efficient_traffic_usage"><span><strong>4.4</strong>
Efficient Traffic Usage</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_4_1_cloud_based_transformations"><span><strong>4.4.1</strong> Cloud-based Transformations</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_4_2_media_transcoding"><span><strong>4.4.2</strong> Media Transcoding</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_4_3_presence"><span><strong>4.4.3</strong> Presence</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_4_4_email"><span><strong>4.4.4</strong> Email</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_4_5_push_notification"><span><strong>4.4.5</strong> Push Notification</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_5_compression"><span><strong>4.5</strong>
Compression</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_6_background_foreground_modes"><span><strong>4.6</strong>
Background / Foreground Modes</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#4_7_application_scaling"><span><strong>4.7</strong>
Application Scaling</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#5_best_practices_for_applications"><strong>5</strong><span> Best Practices for
Applications</span></b></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#5_1_best_practices_and_tools"><span><strong>5.1</strong> Best
Practices and Tools</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#5_2_combine_requests"><span><strong>5.2</strong>
Combine Requests</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#5_3_file_minification"><span><strong>5.3</strong>
File <span class=SpellE>Minification</span></span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#5_4_periodic_connections"><span><strong>5.4</strong>
Periodic Connections</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#5_5_reduce_number_of_redirects"><span><strong>5.5</strong>
Reduce Number of Redirects</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#5_6_400_500_errors"><span><strong>5.6</strong>
400/500 Errors</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#5_7_third_party_content"><span><strong>5.7</strong>
Third Party Content</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#5_8_asynchronous_javaScript"><span><strong>5.8</strong>
Asynchronous JavaScript</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#5_9_file_compression"><span><strong>5.9</strong>
File Compression</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_detailed_recommendations"><strong>6</strong><span> Detailed
Recommendations</span></b></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_1_ios"><span><strong>6.1</strong>
iOS</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_1_1_asynchrony"><span><strong>6.1.1</strong> Asynchrony</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_1_2_connection_loss_and_error_handling"><span><strong>6.1.2</strong> Connection Loss and Error Handling</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_1_3_caching"><span><strong>6.1.3</strong> Caching</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_1_4_references"><span><strong>6.1.4</strong> References</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_1_5_security"><span><strong>6.1.5</strong> Security</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_1_6_push_notification"><span><strong>6.1.6</strong> Push Notifications</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_1_7_data_formats"><span><strong>6.1.7</strong> Data Formats</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_1_8_compression"><span><strong>6.1.8</strong> Compression</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_1_9_background_foreground_modes"><span><strong>6.1.9</strong> Background / Foreground Modes</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_1_10_scheduling"><span><strong>6.1.10</strong> Scheduling</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_2_android"><span><strong>6.2</strong>
Android</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_2_1_asynchrony"><span><strong>6.2.1</strong> Asynchrony</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_2_2_offline_mode"><span><strong>6.2.2</strong> Offline Mode</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_2_3_caching"><span><strong>6.2.3</strong> Caching</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_2_4_security"><span><strong>6.2.4</strong> Security</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_2_5_push_notifications"><span><strong>6.2.5</strong> Push Notifications</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_2_6_data_formats"><span><strong>6.2.6</strong> Data Formats</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_2_7_compression"><span><strong>6.2.7</strong> Compression</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_2_8_background_foreground_modes"><span><strong>6.2.8</strong> Background / Foreground Modes</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_2_9_scheduling"><span><strong>6.2.9</strong> Scheduling</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_2_10_spreading_network_activity_timing_among_different_devices"><span><strong>6.2.10</strong> Spreading Network Activity Timing <span
class=GramE>Among</span> Different Devices</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_3_windows_phone"><span><strong>6.3</strong>
Windows Phone</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_3_1_asynchrony"><span><strong>6.3.1</strong> Asynchrony</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_3_2_connection_loss_and_error_handling"><span><strong>6.3.2</strong> Connection Loss and Error Handling</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_3_3_caching"><span><strong>6.3.3</strong> Caching</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_3_4_security"><span><strong>6.3.4</strong> Security</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_3_5_push_notifications"><span><strong>6.3.5</strong> Push Notifications</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_3_6_data_ormats"><span><strong>6.3.6</strong> Data Formats</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_3_7_compression"><span><strong>6.3.7</strong> Compression</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_3_8_background_foreground_modes"><span><strong>6.3.8</strong> Background / Foreground Modes</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#6_3_9_scheduling"><span><strong>6.3.9</strong> Scheduling</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a href="#7_video_delivery_over_mobile_networks"><strong>7</strong><span> Video Delivery over
Mobile Networks</span></b></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#7_1_image_quality_experienced_by_customers_using_video_delivery_service"><span><strong>7.1</strong>
Image Quality Experienced by Customers Using Video Delivery Service</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#7_1_1_factors_affecting_the_image_quality_of_video_delivery_service"><span><strong>7.1.1</strong> Factors Affecting the Image Quality
of Video Delivery Service</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#7_1_2_relationship_between_encoding_conditions_and_image_quality"><span><strong>7.1.2</strong> Relationship between Encoding
Conditions and Image Quality</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#7_1_3_degradation_in_quality_of_qxperience_in_a_congested_mobile_network"><span><strong>7.1.3</strong> Degradation in Quality of Experience
in a Congested Mobile Network</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#7_2_technological_trends_of_video_delivery"><span><strong>7.2</strong>
Technological Trends of Video Delivery</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#7_2_1_high_compression_codec_technologies"><span><strong>7.2.1</strong> High-Compression Codec Technologies</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#7_2_2_video_streaming_technologies"><span><strong>7.2.2</strong> Video Streaming Technologies</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#7_3_suggested_measures_of_efficient_network_utilization"><span><strong>7.3</strong>
Suggested Measures of Efficient Network Utilization</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#7_3_1_optimization_of_content_bit_rate"><span><strong>7.3.1</strong> Optimization of Content Bit Rate
(Image Quality)</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#7_3_2_optimization_of_delivery_bit_rate"><span><strong>7.3.2</strong> Optimization of Delivery Bit Rate
(Quality of Experience)</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><a
href="#7_3_3_other_optimization_measures"><span><strong>7.3.3</strong> Other Optimization Measures</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<h2 id="1_to_application_developers"><span><span>1.</span></span></b><span>To Application Developers:<o:p></o:p></span></h2>

<p class=MsoNormal><span>Smartphones have changed the way information is accessed. They
have catapulted the development and distribution of mobile apps to a new level.<o:p></o:p></span></p>

<p class=MsoNormal><span>However, unlike fixed networks, the mobile environment places constraints
on the resources available to apps on the mobile device. For example, the power
consumption of each application can have an extreme impact on battery life. The
frequency of device-server communication needs to strike a balance between
delivering a good user experience while not draining the battery or impacting
the user's phone bill (e.g. when roaming). High traffic levels can cause <span
class=SpellE>signalling</span> overload in the network, triggering delays that
impact the app performance and user experience.<o:p></o:p></span></p>

<p class=MsoNormal><span>Understanding and applying key principles of the mobile
environment will help you improve your app's connectivity, data and power
consumption and security. This will improve the user experience, and help to
create and maintain the popularity of your app.<o:p></o:p></span></p>

<p class=MsoNormal><span>This document explains key differences between fixed and mobile
environments, and highlights key principles to bear in mind when developing
applications for mobile devices. It also provides detailed tips for Android,
Windows Phone and iOS.<o:p></o:p></span></p>

<p class=MsoNormal><span>The following table outlines key recommendations with detailed
explanations in later chapters. Considering these will help to make your app
even smarter.<o:p></o:p></span></p>

<p class=MsoNormal><b><span>High Level
Recommendations:</span></b><span><o:p></o:p></span></p>

<p class=MsoNormal><b><span>Term Description:</span></b><span><o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0>
 <tr>
  <th width=206>
  <p class=MsoNormal><b><span>Relevance</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=206>
  <p class=MsoNormal><b><span>Guideline</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=204>
  <p class=MsoNormal><b><span>For more details</span></b><span><o:p></o:p></span></p>
  </th>
 </tr>
 <tr>
  <td width=206>
  <p class=MsoNormal><span>Usability/ Asynchrony<o:p></o:p></span></p>
  </td>
  <td width=206>
  <p class=MsoNormal><span>Techniques such as
  pipelining and asynchrony should be used to ensure that the client operates
  smoothly<o:p></o:p></span></p>
  </td>
  <td width=204>
  <p class=MsoNormal><span>Sections 2.2.1, 5.1.1,<o:p></o:p></span></p>
  <p class=MsoNormal><span>5.2.1, 5.3.1<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=206>
  <p class=MsoNormal><span>Efficient network
  connection usage<o:p></o:p></span></p>
  </td>
  <td width=206>
  <p class=MsoNormal><span>Use strategies that <span
  class=SpellE>minimise</span> and <span class=SpellE>optimise</span> data
  traffic and avoid unnecessary data transfers, especially when roaming.<o:p></o:p></span></p>
  </td>
  <td width=204>
  <p class=MsoNormal><span>Section 2.3<o:p></o:p></span></p>
  <p class=MsoNormal><span>Background/ foreground
  modes Deactivate background processes when not required. Section 2.3, 3.6,
  5.2.8<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=206>
  <p class=MsoNormal><span>Background/ foreground
  modes<o:p></o:p></span></p>
  </td>
  <td width=206>
  <p class=MsoNormal><span>Deactivate background
  processes when not required.<o:p></o:p></span></p>
  </td>
  <td width=204>
  <p class=MsoNormal><span>Section 2.3, 3.6,
  5.2.8<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=206>
  <p class=MsoNormal><span>Background/ foreground
  modes, Scheduling<o:p></o:p></span></p>
  </td>
  <td width=206>
  <p class=MsoNormal><span>Design polling
  applications to aggregate their network activities.<o:p></o:p></span></p>
  </td>
  <td width=204>
  <p class=MsoNormal><span>Section 2.3, 3.6,
  5.2.9<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=206>
  <p class=MsoNormal><span>Connection loss and
  error handling<o:p></o:p></span></p>
  </td>
  <td width=206>
  <p class=MsoNormal><span>Applications should be
  resilient to changing network conditions and errors.<o:p></o:p></span></p>
  </td>
  <td width=204>
  <p class=MsoNormal><span>Section 3.2<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=206>
  <p class=MsoNormal><span>Compression<o:p></o:p></span></p>
  </td>
  <td width=206>
  <p class=MsoNormal><span>Applications using
  HTTP should support compression.<o:p></o:p></span></p>
  </td>
  <td width=204>
  <p class=MsoNormal><span>Section 3.5<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=206>
  <p class=MsoNormal><span>Data push<o:p></o:p></span></p>
  </td>
  <td width=206>
  <p class=MsoNormal><span>Applications should
  use push services in preference to polling.<o:p></o:p></span></p>
  </td>
  <td width=204>
  <p class=MsoNormal><span>Section 3.6, 5.2.5,
  5.3.3<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span>These guidelines have been compiled with inputs from developers,
operators and terminal vendors. Updated versions will be provided, enhancing
the contents and extending the scope to other relevant technologies and
platforms. Although the underlying focus of the guidelines is predicated on
addressing relevant issues in the context of wireless connectivity, similar
issues may require attention in a wider context. AQUA (App Quality Alliance)
has published its ‘</span><a href="http://www.appqualityalliance.org/resources"><span>Best Practice Guidelines, <span class=SpellE>AQuA</span>
Test criteria for Android'</span></a><span>&nbsp;that
complement the current document.<o:p></o:p></span></p>

<p class=MsoNormal><span>We want to continuously improve the content of this document.
Should you wish to contribute, please contact us at&nbsp;</span><a
href="mailto:devguide@gsma.com"><span>devguide@gsma.com</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><span>Alternatively you can join the dedicated W3C community discussion
at:&nbsp;</span><a href="http://www.w3.org/community/networkfriendly/"><span>http://www.w3.org/community/networkfriendly/</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shapetype id="_x0000_t75"
 coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
 filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="Picture_x0020_303" o:spid="_x0000_i1057" type="#_x0000_t75"
 alt="clip_image008" style='width:452.25pt;height:342.75pt;visibility:visible;
 mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image001.gif"
  o:title="clip_image008"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=603 height=457
src="SAG_files/image001.gif"
alt="clip_image008" v:shapes="Picture_x0020_303"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 1</span></b><span>: Smarter Apps<o:p></o:p></span></p>

<h2 id="2_introduction"><b><span>2&nbsp;&nbsp;&nbsp;Introduction<o:p></o:p></span></b></h2>

<h3 id="2_1_overview"><b><span>2.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Overview</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>The rapid rise in demand for mobile data has taken key industry
stakeholders by surprise, particularly the network operators at the forefront
of delivering services to customers. A direct consequence of the huge success
in the uptake of data services is a greatly increased <span class=SpellE>signalling</span>
load at the network level independent of the volume of data traffic. End-users
and application developers are largely unaware of increased <span class=SpellE>signalling</span>
load as this is only visible to network operators/service providers. However,
increased <span class=SpellE>signalling</span> load impacts smartphone users,
who can experience rapid battery drainage, unresponsive user interface, slow
network access and non-functional applications.<o:p></o:p></span></p>

<p class=MsoNormal><span>As use of smartphone applications increases, so does the <span
class=SpellE>signalling</span> load on a disproportionate <span class=GramE>scale.</span>
This is caused by a number of factors, but aspiring enthusiasts, (perhaps with
a background in developing desktop applications), who are translating their
ideas into network-unfriendly apps that can be easily installed on smartphones
are amongst the main culprits.<o:p></o:p></span></p>

<p class=MsoNormal><span>As a result, network operators are facing the challenge of
unprecedented <span class=SpellE>signalling</span> load that is out of
proportion to the level of data usage.<o:p></o:p></span></p>

<p class=MsoNormal><span>The industry has responded by introducing the ‘fast dormancy'
feature. This means the mobile device notifies the network that its data
session is complete, and requests the device be moved to a more battery
efficient state controlled by the network. This has been implemented in 3GPP
Release 8.<o:p></o:p></span></p>

<p class=MsoNormal><span>A number of other aspects relating to the development of
network-friendly smartphone apps need to be considered. These include:<o:p></o:p></span></p>

<ol>
<li>Optimal use of wireless connectivity on target platforms by third party developers This leads to better data bandwidth usage</li>
<li>Competent development of third party apps that
are user and network friendly This provides a much improved user experience and can improve
battery efficiency</li>
<li>Identifying and addressing underlying
peculiarities in smartphone software platforms This improves network performance, user friendliness and battery
consumption</li>
<li>Robust handling of failures This can reduce battery consumption and reduce unnecessary data bandwidth
usage</li>

</ol>


<h3 id="2_2_scope"><b><span>2.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scope</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>This document is designed to provide as much information as
possible to all developers (private application designers, operators or OEMs)
to encourage a better approach to developing mobile apps.<o:p></o:p></span></p>

<p class=MsoNormal><span>By following the guidelines and recommendations, developers will
be better equipped to create fit-for-purpose apps; mobile operators will see a
reduced strain on network resources leading to more responsive and reliable
apps and improved battery life.<o:p></o:p></span></p>

<h4>Network efficient apps
will benefit developers by:</span></b><span><o:p></o:p></span></h4>

<ul>
<li>Improving the overall
user experience of apps, making them more responsive, providing more control to
users, and providing better user experience due to less loaded/congested
networks</li>
<li>Improving reliability
in the mobile network environment</li>
<li>Providing higher
levels of user satisfaction by reducing traffic levels, potentially resulting
in lower customer bills and improved device battery life</li>
</ul>


<h4><b><span>The scope of these
developer guidelines is limited to:</span></b><span><o:p></o:p></span></h4>

<ul>
<li>General guidelines for
native apps that require mobile network connectivity</li>
<li>Specific guidelines
for iOS, Android and Windows Phone. These specific guidelines should be updated
periodically as target platforms evolve over time</li>
</ul>


<p class=MsoNormal><span>The theoretical parts of Sections 3 and 4 are generic; they can be
applied to any other platforms.<o:p></o:p></span></p>

<h4><b><span>This document does not
provide guidelines on:</span></b><span><o:p></o:p></span></h4>


<ul>
<li>Generic user interface</li>
<li>Complete device security, it only highlights what is available per platform</li>
<li>Back end implementation</li>
<li>The higher levels of
security required in rare cases for specific apps serving banking or enterprise
systems</li>
<li>Web applications (HTML
5): Relevant developer guidelines have already been published on 14 December 2010
by W3C (Mobile Web Application Best Practices)<a href="http://www.w3.org/TR/2010/REC-mwabp-20101214/" target="_blank">&nbsp;<span class=GramE>http://www.w3.org/TR/2010/REC-mwabp-20101214/</a></span><o:p></o:p></li>
<li>M2M (Machine to Machine)</li>
</ul>


<h3 id="2_2_1_who_should_read_this_document"><b><span>2.2.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W</span></b><b><span>ho Should Read this <span class=GramE>Document</span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>The document is not meant to explain the basics of developing a
mobile app. It is aimed at developers (private application designers, operators
or OEMs) who are able to develop or intend to develop mobile network-dependent
apps. The "Detailed Recommendations" in Chapter 4 are aimed at improving the
quality of apps relying on mobile network connectivity, and explain how to
overcome the challenges that mobile networks introduce.<o:p></o:p></span></p>

<h3 id="2_2_2_organisation_of_the_document"><b><span>2.2.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></b><span
class=SpellE><span><b><span>Organisation</span></b></span></span><span><b><span>
of the&nbsp;</span></b></span><b><span>Document<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Chapter 2 provides the relevant background and lays down the
fundamental constraints that are generic to all mobile platforms.<o:p></o:p></span></p>

<p class=MsoNormal><span>Chapter 3 considers the
characteristics of an ‘ideal' app/platform, to demonstrate optimal use of
network connectivity.<o:p></o:p></span></p>

<p class=MsoNormal><span>Chapter 4 maps the outcome of preceding chapters to target
platforms, highlighting specific functionality or limitations to further assist
developers.<o:p></o:p></span></p>

<h3 id="2_3_definition_of_terms"><b><span>2.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Definition
of Terms</span></b><b><span><o:p></o:p></span></b></h3>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0>
 <tr>
  <th width=64>
  <p class=MsoNormal><b><span>Term &nbsp;</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=548>
  <p class=MsoNormal><b><span>Description</span></b><span><o:p></o:p></span></p>
  </th>
 </tr>
 <tr>
  <td width=64>
  <p class=MsoNormal><span>3G<o:p></o:p></span></p>
  </td>
  <td width=548>
  <p class=MsoNormal><span>3rd Generation and
  usually refers to mobile networks offering data rates over 200kbit/s<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=64>
  <p class=MsoNormal><span>3GPP<o:p></o:p></span></p>
  </td>
  <td width=548>
  <p class=MsoNormal><span>The 3rd Generation Partnership
  Project is a global telecomm organization that defines and maintains
  standards and recommendations for the deployment of the GSM family of network
  technologies.<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=64>
  <p class=MsoNormal><span>APIs<o:p></o:p></span></p>
  </td>
  <td width=548>
  <p class=MsoNormal><span>Application
  Programming Interface is a source code based specification intended to be
  used as an interface by software components to communicate with each other.
  An API may include specifications for routines, data structures, object
  classes, and variables<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=64>
  <p class=MsoNormal><span>EDGE<o:p></o:p></span></p>
  </td>
  <td width=548>
  <p class=MsoNormal><span>Enhanced Data rates for
  GSM Evolution is a mobile network technology offering download speeds up to
  236.8kbit/s<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=64>
  <p class=MsoNormal><span>FACH<o:p></o:p></span></p>
  </td>
  <td width=548>
  <p class=MsoNormal><span>Forward Access Channel
  is a radio channel used in UMTS networks that provides connectivity with
  reduced battery drain compared to a dedicated radio connection<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=64>
  <p class=MsoNormal><span>FIN<o:p></o:p></span></p>
  </td>
  <td width=548>
  <p class=MsoNormal><span>Finish message; it is
  a TCP segment with the FIN bit set, indicating that a device wants to
  terminate the connection<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=64>
  <p class=MsoNormal><span>GPRS<o:p></o:p></span></p>
  </td>
  <td width=548>
  <p class=MsoNormal><span>General Packet Radio
  Service is a mobile network technology offering download speeds up to
  60kbit/s<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=64>
  <p class=MsoNormal><span>JSON<o:p></o:p></span></p>
  </td>
  <td width=548>
  <p class=MsoNormal><span>JavaScript Object
  Notation is a lightweight text-based open standard, designed for
  human-readable data interchange. It is derived from the JavaScript scripting
  language for representing simple data structures and associative arrays,
  called objects<o:p></o:p></span></p>
  </td>
 </tr>
</table>

<h2 id="3_network_friendliness"><b><span>3&nbsp;&nbsp;&nbsp;Network&nbsp;</span></b><b><span>Friendliness<o:p></o:p></span></b></h2>

<p class=MsoNormal><span>Today's mobile broadband downlink speeds can range from 1.8 Mb/s
upwards. In contrast, fixed line broadband based on cable-modem or ADSL/DSL
technologies provides a connection speed of up to 50Mb/s downlink. Fixed line
broadband deploys less complex technologies than mobile broadband, and Wi-Fi
offers very limited terminal mobility. Mobile networks differ from fixed
broadband networks in that they have limited variable bandwidth, higher latency
and a non­permanent communication channel. Loss of Internet is not considered
abnormal.<o:p></o:p></span></p>

<p class=MsoNormal><span>Mobile networks have their own specific requirements and
constraints, and even a Wi-Fi connection may not deliver the steady
connectivity of the fixed network. As a developer, you should take these into
account as you design and build your apps. These requirements and constraints
are described in the following section.<o:p></o:p></span></p>

<h3 id="3_1_requirements_and_constraints_in_mobile_broadband"><b><span>3.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Requirements
and Constraints in&nbsp;</span></b><b><span>Mobile Broadband<o:p></o:p></span></b></h3>


<ul>
<li>Limited bandwidth: The
available bandwidth for mobile networks may vary depending on the geographic
coverage and the underlying technologies used. On average it is lower than a
Wi-Fi connection. In addition, when the mobile consumer is on the move, the
bandwidth can dynamically step up or down.</li>
<li>Data is not always
free: Outside monthly allocations and bundled price plans, mobile data usage
can be expensive, particularly when roaming. This can mean high costs for
users.</li>
<li>Battery life: Mobile
terminals are a <span class=SpellE>miniaturised</span> feast of technologies
powered by a battery. When in full operation, the battery runs a processor with
an active screen and data communication over the mobile network. Transferring
large amounts of data puts the radio access into high drive mode. Add an active
<span class=SpellE>colour</span> screen and the battery can drain in just a few
hours. Considered use of the network, screen and processor resources when
designing an app can dramatically improve battery life. For example, serving
ads is popular with free apps but it can dramatically impact battery life and
bandwidth usage. This could be improved by reducing the number/frequency of
different ads being downloaded, or by introducing an ad-free (often paid)
version that doesn't contain ads.</li>
<li>Network connectivity: Mobile
networks cannot by nature guarantee reliable connectivity at all times. Blind
coverage spots, the limitations of deployed technologies, switching between
cells, or moving in heavily built-up areas, can all result in lost data
packets, increased latency, reduced network speed, and connectivity
interruption</li>
<li>Security: Users do not
always have direct control over their choice of wireless access networks. They
can be connected to public Wi-Fi hotspots or in extreme cases even to spoofed
networks, so privacy can be compromised or identity stolen. Authentication,
secure protocols and a cautious approach to content transmission should be
adopted by all developers</li>

</ul>


<p class=MsoNormal><span>When network communication is <span class=SpellE>optimised</span>,
the overall user experience is greatly improved. Developers should adopt all
possible methods of optimal data transmission (efficient protocols, caching,
compression, data aggregation, pipelining, etc.).<o:p></o:p></span></p>

<p class=MsoNormal><span>Although many mobile users have access to Wi-Fi networks at home,
work or public places, their primary access to the Internet is via the mobile
network. Developers often do not take this into account and do not perform
rigorous field testing in the mobile environment – hoping instead that users
will find a reliable connection. Development in simulated environments running
on fast and well-connected laboratory machines may never uncover real-life user
experiences. Therefore day-to-day testing of your app on a device connected to
a commercial mobile network is essential.<o:p></o:p></span></p>

<h3 id="3_2_smooth_user_experience"><b><span>3.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S</span></b><b><span>mooth User Experience<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Although network efficiency may be understood as the most
effective use of bandwidth, it is also important to pay attention to the
reality of mobile devices and mobile networks. All users today know that a
mobile connection can be lost or data transfer delayed. The user experience of
network friendly apps should be adjusted accordingly to smooth the impact of
such issues.<o:p></o:p></span></p>

<h3 id="3_2_1_asynchrony"><b><span>3.2.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Asynchrony</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>The first assumption to be made is that any response in a mobile
network environment might be delayed or not delivered at all. To ensure a
smooth user experience, an app's architecture should not solely rely on a
sequence of responses, but be ready to deliver some results to the user even if
not all the data has arrived.<o:p></o:p></span></p>

<p class=MsoNormal><span>A basic item list explains the problem in general terms. Figure 1
shows the sequence of requests required to download if all requests had been
made synchronously:<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_259"
 o:spid="_x0000_i1056" type="#_x0000_t75" alt="clip_image010" style='width:452.25pt;
 height:24pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image002.gif"
  o:title="clip_image010"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=603 height=32
src="SAG_files/image002.gif"
alt="clip_image010" v:shapes="Picture_x0020_259"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 2</span></b><span>: Synchronous requests<o:p></o:p></span></p>

<p class=MsoNormal><span>In this example the list contains three items.<o:p></o:p></span></p>

<p class=MsoNormal><span>If the same requests were sent in parallel, then the timeline will
be as shown in Figure 2:<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_258"
 o:spid="_x0000_i1055" type="#_x0000_t75" alt="clip_image012" style='width:270.75pt;
 height:108pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image003.gif"
  o:title="clip_image012"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=361 height=144
src="SAG_files/image003.gif"
alt="clip_image012" v:shapes="Picture_x0020_258"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 3</span></b><span>: &nbsp;Asynchronous
requests<o:p></o:p></span></p>

<p class=MsoNormal><span>Should the network connection be reliable with constant speed, the
user will not notice the requests had been sent in parallel. The overall
loading time will not show a tangible difference. However, such an arrangement
can only exist in ‘ideal' networks, with no latencies and connection
interruptions.<o:p></o:p></span></p>

<p class=MsoNormal><span>In reality, the same sequence could potentially result in the
arrangement in Figure 3, where a requested image may be received much later and
some requests might not receive any response at all.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_257"
 o:spid="_x0000_i1054" type="#_x0000_t75" alt="clip_image014" style='width:444.75pt;
 height:100.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image004.gif"
  o:title="clip_image014"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=593 height=134
src="SAG_files/image004.gif"
alt="clip_image014" v:shapes="Picture_x0020_257"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 4</span></b><span>: Asynchronous request
in reality<o:p></o:p></span></p>

<p class=MsoNormal><span>If an app waits to receive every single response and does not
progressively show results to the user before completion of the entire cycle
(as described above), the user might simply face a blank screen.<o:p></o:p></span></p>

<p class=MsoNormal><span>Network connections should be arranged in an asynchronous manner.
This separation will ensure that delayed responses will not block the user
interaction entirely.<o:p></o:p></span></p>

<p class=MsoNormal><span>Where possible, the user should be able to see the progress of
data loading. This could be achieved by using progress bars, placeholders or a
simple network indicator. In Figure 4, text information can be displayed
already when the list is loaded without waiting for images to arrive. As soon
as an image is loaded it can be displayed immediately.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape
 id="Picture_x0020_256" o:spid="_x0000_i1053" type="#_x0000_t75" alt="clip_image016"
 style='width:448.5pt;height:203.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image005.gif"
  o:title="clip_image016"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=598 height=271
src="SAG_files/image005.gif"
alt="clip_image016" v:shapes="Picture_x0020_256"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 5</span></b><span>: Timeline of
asynchronous request<o:p></o:p></span></p>

<p class=MsoNormal><span>Apps should assume that any of the requested responses may fail to
arrive. An appropriate user interface should keep the user informed of the
progress without giving the impression that the software has crashed or hung.<o:p></o:p></span></p>

<h3 id="3_2_2_non-blocking_user_interface"><b><span>3.2.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Non-blocking&nbsp;</span></b><b><span>User Interface<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>A blocking User Interface (UI) is where the user is faced with a
single UI element that prevents use of the mobile device. These can pop up from
an app if there is a delay in receiving data, or when the app logic's decision
tree is unable to proceed because it has encountered a missing data item.<o:p></o:p></span></p>

<p class=MsoNormal><span>In reality, it is not necessary for an app to block the user from
other operations. Even during a login process, when a user cannot progress any
further within that app until access is granted, it should be possible to use
other device applications.<o:p></o:p></span></p>

<p class=MsoNormal><span>In most cases, network operations should be completed in the
background, allowing the user to cancel or switch to other views. It is
inconvenient to the user to allow a web browser to block the screen with the
message "Loading" until the page completes.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_252"
 o:spid="_x0000_i1052" type="#_x0000_t75" alt="clip_image018" style='width:313.5pt;
 height:221.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image006.gif"
  o:title="clip_image018"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=418 height=295
src="SAG_files/image006.gif"
alt="clip_image018" v:shapes="Picture_x0020_252"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 6</span></b><span>: Non-blocking user
interface examples<o:p></o:p></span></p>

<p class=MsoNormal><span>When designing an app's UI and its decision tree it is important
to distinguish between a user-initiated network connection and an
application-driven activity. This can define how the user is notified of
progress and errors.<o:p></o:p></span></p>

<p class=MsoNormal><span>For example, if the user requests a web page to be loaded and the
browser fails to connect to the server, then a modal error message
(dialogue/information box) should be displayed. However, if an image has not
been delivered, it would be more sensible to show placeholders with broken
images instead.<o:p></o:p></span></p>

<p class=MsoNormal><span>Another example of an unhelpful error message occurs in some
offline games. Whenever these games are launched on an unconnected device, an
error message is often shown that reads "Could not connect to server", probably
as a result of failure to send game statistics back to the server. The user is
not expecting any result from a server, and these irrelevant messages can
create an unnecessary and annoying break in the user experience.<o:p></o:p></span></p>

<h3 id="3_2_3_offline_mode"><b><span>3.2.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offline&nbsp;</span></b><b><span>Mode<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>There are occasions when a mobile device cannot connect or remain
connected to the network, so it is important that developers take the following
into consideration when building an app:<o:p></o:p></span></p>

<ul>
<li>If the network
connection drops, the user should be alerted as to why an operation could not
be completed</li>
<li>To prevent data loss,
users should be able to save current or active data with the option to
retry/resume the activity when reconnected to the network</li>
</ul>


<p class=MsoNormal><span>Examples of user disappointment include losing a long text string
typed on a mobile device keyboard when it should be clear that the application
cannot send the text to the server; or after downloading a huge chunk of data,
finding it impossible to resume downloading and having to start the whole
process all over again<o:p></o:p></span></p>

<ul>
<li>The user should be
notified of any functionality that is not available in offline mode</li>
<li>It is best practice to
enable continued use of an app with data stored in offline mode for later <span
class=SpellE>synchronisation</span> when the network connection is
re-established</li>
<li>The app should be
capable of scanning for data connectivity in background mode without affecting
operation in offline mode</li>
</ul>



<h3 id="3_2_4_bandwidth_awareness"><b><span>3.2.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bandwidth&nbsp;</span></b><b><span>Awareness<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Apps with excessive network dependency, such as audio or video
streaming, require an assured level of data transmission speed. Considering the
variety of wireless technologies such as GPRS, EDGE, 3G or Wi-Fi, it would be
sensible for the app to first ascertain the access network and connection
quality in order to request the appropriate quality of content from the server;
and notify the user about the possible additional cost of using mobile data. If
the app needs a more precise estimation of speed, then it would be reasonable
to measure or dynamically adjust the quality of streamed data according to
latencies.<o:p></o:p></span></p>

<p class=MsoNormal><span>The app should be capable of adapting to changes in access network
and data speed at any given time, and make allowances for users leaving a Wi-Fi
Hotspot, for example, or a mobile network handover from 3G to GPRS.<o:p></o:p></span></p>

<h3 id="3_3_efficient_network_connection_usage"><b><span>3.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E</span></b><b><span>fficient Network Connection Usage<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>The constraints and limitations of wireless technologies have
already been highlighted. Operating within these limitations means the frugal
use of any data upload/download that impacts a user's mobile data plan charges
when roaming, user experience responsiveness, and device battery life. Any <span
class=SpellE>optimisation</span> of traffic will be appreciated by users, so
double check if all network transfers are really necessary, protocols are
chosen optimally, and caching is used appropriately.<o:p></o:p></span></p>

<p class=MsoNormal><span>Apart from data traffic, there are a few <span class=SpellE>behaviours</span>
in a 3G network that need additional consideration. These are caused by the
implementation of Fast Dormancy, a feature that aims to <span class=SpellE>minimise</span>
network <span class=SpellE>signalling</span> and battery consumption, both key
issues given the increasing number of smartphones and online applications.<o:p></o:p></span></p>

<p class=MsoNormal><span>When a device requests data to be sent or received over a mobile
network, the device switches from an idle to a dedicated channel state that
consumes about 60-100 times more power compared to the idle mode. However, the
very process of switching requires sending network <span class=SpellE>signalling</span>
messages that also take a certain amount of time. Keeping the device in a high
power state is not an ideal option as the battery will drain rapidly.<o:p></o:p></span></p>

<p class=MsoNormal><span>Between the idle and dedicated channel states there are few more
3GPP radio resource control (RRC) states that come into use. Fast dormancy
technology defines an algorithm that dictates when a device can be switched to
lower state after the last data transmission. Figure 6 below shows how the
power drops after a certain period of inactivity in data transfer. Times T1 and
T2 are network dependent.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_242"
 o:spid="_x0000_i1051" type="#_x0000_t75" alt="Description: 2" style='width:231pt;
 height:176.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image007.jpg"
  o:title=" 2"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=308 height=235
src="SAG_files/image007.jpg"
alt="Description: 2" v:shapes="Picture_x0020_242"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 7</span></b><span>: Power Consumption –
Example 1<o:p></o:p></span></p>

<p class=MsoNormal><span>Once the state has switched to idle, establishing a new data
connection may require the exchange of between 24-28 signals with the network,
which could take one to two seconds.<o:p></o:p></span></p>

<p class=MsoNormal><span>This is an example of when the app has many short connections over
a specific period of time:<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_241"
 o:spid="_x0000_i1050" type="#_x0000_t75" alt="Description: 4" style='width:363.75pt;
 height:152.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image008.jpg"
  o:title=" 4"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=485 height=203
src="SAG_files/image008.jpg"
alt="Description: 4" v:shapes="Picture_x0020_241"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 8</span></b><span>: Power Consumption –
Example 2<o:p></o:p></span></p>

<p class=MsoNormal><span>The red-hatched areas in Figure 7 show the overhead in battery usage
compared to Figure 8 when all data connections are <span class=SpellE>synchronised</span>
and completed in the same time.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_240"
 o:spid="_x0000_i1049" type="#_x0000_t75" alt="Description: 6" style='width:372pt;
 height:150pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image009.jpg"
  o:title=" 6"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=496 height=200
src="SAG_files/image009.jpg"
alt="Description: 6" v:shapes="Picture_x0020_240"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 9</span></b><span>: Power Consumption –
Example 3<o:p></o:p></span></p>

<p class=MsoNormal><span>Although most of the timers and conditions of switching between
the channel states are network dependent, it is good to at least have an
example of the approximate characteristics.<o:p></o:p></span></p>

<p class=MsoNormal><span>According to tests that have been done by XMPP Foundation:<o:p></o:p></span></p>

<p class=MsoNormal><span>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dedicated channel (the
highest level) consumes about 380mA which can drain an average smartphone
battery in less than four hours. The time before dropping to the lower state is
approximately eight seconds<o:p></o:p></span></p>

<p class=MsoNormal><span>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FACH (shared channel –
intermediate level) consumes about 140mA. In order to keep this state and
prevent switching into the higher power mode, the packet sizes must be around
128 bytes and after deducting TCP and TLS overheads this leaves only about 70
bytes of actual data. Timeout before switching to the lower state is around
eight seconds. Battery life can reach a maximum of around seven hours in this
mode.<o:p></o:p></span></p>

<p class=MsoNormal><span>The general recommendation is to transfer data in one go and not
spread network activities. This should be done across multiple apps where
possible and within apps (see 2.2.1).<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>In the ‘across apps' scenario, the available
scheduling mechanisms of the OS or the target application framework should be
used.</span></span><span> These are meant to
ensure that the app's network activities, such as HTTP requests, are <span
class=SpellE>synchronised</span> with other applications to achieve the <span
class=SpellE>behaviour</span> explained in Figure 8 (for an example, see 5.2.9
for details on scheduling in the case of Android).<o:p></o:p></span></p>

<p class=MsoNormal><span>The same principle applies to push notifications too. Unless your
app has real-time requirements you should not push notifications more often
than you would have polled (sent a request to see if new data is available), if
push was not available.<o:p></o:p></span></p>

<p class=MsoNormal><span>References XMPP on
Mobile Devices:&nbsp;</span><a
href="http://xmpp.org/extensions/xep-0286.html#sect-id115219"><span>http://xmpp.org/extensions/xep-0286.html#sect-id115219</span></a><span><o:p></o:p></span></p>

<h2 id="4_ideal_mobile_application"><b><span>4&nbsp;&nbsp;&nbsp;I</span></b><b><span>deal Mobile Application<o:p></o:p></span></b></h2>

<p class=MsoNormal><span>We have already established the type of constraints that mobile
apps need to address, where critical resources (such as battery, memory and
processor) have certain limits.<o:p></o:p></span></p>

<p class=MsoNormal><span>Key generic characteristics of functionality or user case
scenarios are addressed in subsequent sections.<o:p></o:p></span></p>

<h3 id="4_1_asynchrony"><b><span>4.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Asynchrony</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>The concept of asynchrony has already been introduced briefly in
chapter 2. There are two main aspects to asynchronous network connections:<o:p></o:p></span></p>

<ul>
<li>Network connections
should not block the main thread responsible for handling user interface and
system events</li>
<li>If network requests do
not depend on each other, they should be handled in parallel</li>
<li>Asynchronous
networking would always imply separate threads; although it makes the tracking
of results and the state of an app non-trivial. This drawback, however, is well
understood and competent solutions have been provided.</li>
</ul>


<p class=MsoNormal><span>App architecture is driven by the APIs that platform vendors
provide. To a great extent, the quality of most app implementations is
dependent on the platform vendor's level of generic API support and <span
class=SpellE>optimisation</span> at a platform level. For example, creating
separate threads and managing them effectively should already be part of the
underlying features of a target platform. This can save you time and money as
you don't need to re-invent the wheel.<o:p></o:p></span></p>

<p class=MsoNormal><span>In this context the ideal APIs should have the following features:<o:p></o:p></span></p>

<ul>
<li>Creation and
management of the network connections can be done from the main thread;
however, the calls can lead to separate threads that are managed by framework
transparent to the user</li>
<li>All changes of states,
received data, errors and timeouts are event driven</li>
<li>The connection can be
cancelled at any time</li>
</ul>


<p class=MsoNormal><span>The design of APIs allows the simple management of several
connections at the same time Developers are recommended to establish
connections within a single connectivity session whenever it is possible to
avoid losing dedicated channel state, which is described in Section 2.3. This
reduces network <span class=SpellE>signalling</span> and, depending on the
communication pattern, can make a significant impact on device battery life.<o:p></o:p></span></p>

<h3 id="4_2_connection_loss_and_error_handling"><b><span>4.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connection
Loss and&nbsp;</span></b><b><span>Error Handling<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Monitoring connectivity
status and error handling are extremely important as mobile networks are by
definition not in a constant state.<o:p></o:p></span></p>

<p class=MsoNormal><span>Most platforms provide information on current connections. It is
essential to check if the device is actually connected. Sometimes it is
necessary to identify the type of connection: mobile network or, for example,
Wi-Fi.<o:p></o:p></span></p>

<p class=MsoNormal><span>Although the actual bandwidth cannot be predicted precisely (as it
depends on many factors, like signal strength, current network load, etc.),
developers may assume that:<o:p></o:p></span></p>

<ul>
<li>Wi-Fi networks are
generally faster than mobile networks</li>
<li>Traffic over Wi-Fi is
relatively cheaper in comparison, or free</li>
</ul>


<p class=MsoNormal><span>If checks show the device is not connected, the app can switch to
offline mode and let the user work with cached data only. This avoids handling
inevitable network exceptions and notifications for each network error; the
overall user experience is much smoother if constant error messages can be
avoided. However, if the app switches into offline mode, it is best practice to
monitor the device connectivity status so the app can switch back into online
mode once a connection is established. At this point, data <span class=SpellE>synchronisation</span>
between the server and client can be initiated or resumed.<o:p></o:p></span></p>

<h4><b><span>Request types</span></b><span><o:p></o:p></span></h4>

<p class=MsoNormal><span>When establishing the connection, different approaches can be used
to display the status to the user and determine how to handle any network
issues. A network request can be identified as user initiated if it is going to
deliver the main information requested by the user. User initiated network
requests can also be considered as primary.<o:p></o:p></span></p>

<p class=MsoNormal><span>Non-user initiated requests are those created by scheduled
activities or triggered by a change in a system state, such as geo-location
tracking or sending usage statistics to a server.<o:p></o:p></span></p>

<p class=MsoNormal><span>Secondary requests usually occur as a result of the primary
request and do not bring any critical information to the user. Examples of
secondary requests could be an image in a friends list (the list of names is
critical), style sheets or images in web page.<o:p></o:p></span></p>

<h4><b><span>Cancellation</span></b><span><o:p></o:p></span></h4>

<p class=MsoNormal><span>Ideally, the user should see the progress of a primary request. It
is also sensible to make the primary request cancellable, but this depends on
the nature of the content and how it displays in the UI.<o:p></o:p></span></p>

<p class=MsoNormal><span>As a general rule if it is possible to perform any other
operations on the same UI screen, it is a good practice to ensure ‘cancel' is
available as an option.<o:p></o:p></span></p>

<p class=MsoNormal><span>A good example when cancellation improves usability is the web
browser, which is just another network-enabled application. A user can load
different web pages on the same screen, so if the loading of one page takes too
long, or there is a mistake in entering the address, the user can cancel the
request and open a different web site.<o:p></o:p></span></p>

<p class=MsoNormal><span>When the primary request is cancelled, all secondary requests
should be cancelled automatically.<o:p></o:p></span></p>

<h4><b><span>Error handling</span></b><span><o:p></o:p></span></h4>

<p class=MsoNormal><span>Mobile apps should always be prepared to handle situations when
network requests fail. Most secondary requests can fail without a major impact
on the user experience. Sometimes it is appropriate to indicate subtly in the
UI that information for a secondary request cannot be delivered, such as broken
image placeholders in web browsers or silhouette images in a contacts list.<o:p></o:p></span></p>

<p class=MsoNormal><span>When a primary request fails, it means that the main functionality
cannot be completed and this is where error handling becomes important for the
user experience.<o:p></o:p></span></p>

<p class=MsoNormal><span>As proposed earlier, it makes sense to distinguish between a user
initiated request and non-user initiated (scheduled). If the request was user
initiated and the information is expected to be delivered rapidly, then a modal
error notification such as ‘Retry' or ‘Retry later' is appropriate. If a
request is supposed to take longer time, and the user expects delivery to be
guaranteed, for example, downloading music, an electronic book or a digital
issue of a magazine, then in case of network failure, the app can automatically
try to re-establish the connection. If up to five attempts have failed, then
the request can be suspended (but not cancelled) with an option for manual resume
later. It is also important to not lose any downloaded data and to be able to
resume the download from the place where it has stopped rather than starting
from scratch.<o:p></o:p></span></p>

<p class=MsoNormal><span>Retry mechanisms can vary and depend on the importance and volume
of downloaded data. Possible solutions can be:<o:p></o:p></span></p>

<ul>
<li>Simple counting of
failed attempts since the connection was first established (often the easiest
solution).</li>
<li>The number of failed
attempts within a certain period of time. For example, if the connection is lost
more than five times within an hour, then the request can be suspended. This
can be a more reliable technique to avoid short but regular network problems,
such as when a device is moving away from one network cell to another. The
connection can be lost when the device switches between cells, but when the
cell is providing good coverage; the request can be processed successfully.</li>
</ul>


<p class=MsoNormal><span>Regardless of the mechanism chosen, it is important to ensure that
a failed operation will only be retried a limited number of times. Without such
a limit, an application may retry a failed operation for days or weeks while
running in the background incurring data bandwidth usage and battery drain.<o:p></o:p></span></p>

<p class=MsoNormal><span>If the request is not user initiated then error notifications can
be either non-modal with a retry option or not shown at all. However, if the
request is scheduled and repetitive, then it would make sense to change the
interval dynamically to avoid re-establishing connections too frequently during
network loss over a long period of time. Recommended retry intervals are one
minute, then five minutes, and then 15 minutes. More frequent retries will
drain the battery rapidly.<o:p></o:p></span></p>

<h4><b><span>Resuming large downloads</span></b><span><o:p></o:p></span></h4>

<p class=MsoNormal><span>The HTTP protocol supports requesting parts of files that can be
used for resuming downloads. If the server supports it and the content can be
returned split (i.e. content is not dynamic), then the server may include HTTP
Header as described in sections 14.5 and 3.12 of RFC2616:<o:p></o:p></span></p>

<p class=MsoNormal><span>Accept-Ranges: bytes<o:p></o:p></span></p>

<p class=MsoNormal><span>The client can send subsequent requests for part of the file,
specifying the download, for example, download first 500 bytes<o:p></o:p></span></p>

<p class=MsoNormal><span>Range: bytes=0-499<o:p></o:p></span></p>

<p class=MsoNormal><span>Or for segment starting
from 9500<sup>th</sup>&nbsp;byte:<o:p></o:p></span></p>

<p class=MsoNormal><span>Range: bytes=9500-<o:p></o:p></span></p>

<p class=MsoNormal><span>The response HTTP Status 206 (Partial Content) will show if the
requested range is correct, otherwise, there will be status 416 (Requested
range not <span class=SpellE>satisfiable</span>). See Section 14.35 of RFC2616
for more details.<o:p></o:p></span></p>

<p class=MsoNormal><span>Section 3.f below describes how the verification of cached version
can be done in HTTP using an <span class=SpellE>ETag</span> (entity tag). It is
also possible to retrieve partial content with preceding verification of the
content version by the HTTP request header If-Range, as specified in Section
14.27 of RFC2616. The idea is that the value of the If-Range header should
contain the <span class=SpellE>ETag</span> value and the same request should
also have a Range header specifying what part of content is to be received if
the <span class=SpellE>ETag</span> is valid. If the server verifies the <span
class=SpellE>ETag</span>, then the partial content should be returned,
otherwise, the full version of the updated content will be sent.<o:p></o:p></span></p>

<p class=MsoNormal><span>Though the client can also use a Range header with conditional
headers such as If-Unmodified-Since or If-Match, if the condition fails then
the client should handle the HTTP status code and a new request for retrieving
the updated content. The If-Range header can help to do this in a single
request using either <span class=SpellE>ETag</span> or last modified date.<o:p></o:p></span></p>

<p class=MsoNormal><span>Support for resuming downloads is extremely important for large
content transfers on mobile devices, especially with the growing number of
tablet devices, where quality of content is relatively high for a big display
size. For instance, a single issue of a digital magazine can be 200-400 Mb. It
is not acceptable for the user to have to download the whole file again if the
network fails after already downloading several hundred megabytes.<o:p></o:p></span></p>

<h4><b><span>In summary:</span></b><span><o:p></o:p></span></h4>


<ul class="numeric">
<li>Check connection availability.</li>
<li>In offline mode use cached data.
	<ul>
    	<li>For any outgoing request that includes
user-entered data, the data should be saved locally and an attempt made to
deliver to the server.</li>
		<li>If delivery of the request fails, then the user
should be asked if the request should be retried or retried later (with
permanent saving in case the application is terminated). If the primary request is done in online mode, then a progress
indicator should be used to keep the user notified.</li>
    </ul>
</li>
<li>If the primary request is supposed to take more
than one minute and the user expects to get the result however long it takes
(download application, song, new magazine issue, e-book, etc.), then automatic
retry should be implemented.
	<ul>
    	<li>If several consecutive retries have failed, then
manual retry can be implemented</li>
    	<li>It is good to indicate the progress of secondary
requests, however, failure of them is not important and can be displayed only
as a special placeholder (broken image placeholder for instance).</li>
    	<li>If the request is user initiated then error
notification can be modal.</li>
    	<li>For repetitive scheduled requests, the retry
interval should increase dynamically during long periods with no network
connectivity.</li>
    	<li>Applications often fail to determine whether or
not the user has any credit remaining if on a PAYG tariff. Lack of credit is
quite common, and a status that may last for some time, so the application
should specifically avoid making repeated requests as the returned error
messages will clog up the network and may not reflect the reality of the issue.</li>
    </ul>
</li>
</ul>


<h4><b><span>Caching</span></b><span><o:p></o:p></span></h4>

<p class=MsoNormal><span>Caching is using the most effective means of data storage or
transfer. For network applications, especially in mobile networks, the cache
becomes essential. However, there are a few common challenges to address in
terms of overall reliability, and ensuring the delivery of up-to-date
information to the user.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_230"
 o:spid="_x0000_i1048" type="#_x0000_t75" alt="clip_image026" style='width:411.75pt;
 height:153.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image010.gif"
  o:title="clip_image026"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=549 height=205
src="SAG_files/image010.gif"
alt="clip_image026" v:shapes="Picture_x0020_230"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 10</span></b><span>:
Caching<o:p></o:p></span></p>

<p class=MsoNormal><span>Although the entire client/server solution may contain many
different levels of cache, generally two categories are supported: local cache
and server cache. Local cache is used to <span class=SpellE>minimise</span> the
number of network requests and enable faster delivery of results. The server
cache works with the local cache to decrease the amount of data transferred via
the network, whilst ensuring that the user gets the latest version of the
information.<o:p></o:p></span></p>

<p class=MsoNormal><span>Figure 9 above shows the journey of a regular request from a
mobile client to a web server:<o:p></o:p></span></p>

<ul>
	<li>During the first stage
the client checks if the requested content is stored in local cache and if it
is still valid. If so, the data is sent to the user immediately without sending
any requests to the network</li>
	<li>If the local cache
contains data but needs validation, the client includes a version or checksum
or the last modified date of the content that the client already has. If the
server cannot find a newer version of the content, it notifies the client that
the local version can be used without sending the whole file over the network</li>
	<li>If there is no local
version of the file, or the data is not up-to-date, then the server sends the
latest version over the network. With proprietary implementations (depends on
the nature of the requested data), it might be possible to send only changes to
the local version</li>
	<li>When designing an app, it is best practice to define the types of
content that will be used and specify the caching strategy accordingly:</li>
	<li>Content can be cached
without further validation. For example, if content has a unique identifier and
cannot be modified on the server side, such as static photos in user albums
(usually new photos can be added or old photos deleted, but not modified)&nbsp;</li>
	<li>Content can be cached
locally, but needs validation with the server. A good example is the user's
profile or profile picture which usually does not change very often but
occasionally may be updated.</li>
	<li>Content cannot be
cached at all. Examples: audio streaming, chat, etc.</li>
</ul>


<p class=MsoNormal><span>Depending on the privacy of the content and security of local
storage, some cacheable content should not be kept on device.<o:p></o:p></span></p>

<p class=MsoNormal><span>Local caches face the following problems:<o:p></o:p></span></p>

<ul>
	<li>Size limitations –
Device storage is always limited and depending on the app or the data, the
cache should be limited to the corresponding size. Sometimes, it may be worth
giving the user an option to define cache size as it will improve the perceived
speed of the app for the user</li>
	<li>Invalidation of
content – Usually, web content has an expiration date that can be defined by
the server; however, it also can be defined manually depending on the nature of
the data</li>
	<li><span class=SpellE>Prioritisation</span>
of content – As storage is <span class=GramE>limited,</span> eventually the
cache will be full. New entries in the cache should replace old ones with lower
priority. The cache storage may have different strategies for this – removing
the least frequent used, the oldest or the biggest entries</li>
</ul>



<p class=MsoNormal><span>With HTTP version 1.1 the cache control became part of the
standard and is well described in section 14.9 of RFC2616: which sets out the
options for defining if content can be cached, the expiry date and the
versioning of the content.<o:p></o:p></span></p>

<p class=MsoNormal><span>The HTTP protocol defines a mechanism for checking if the client's
cache has the same version as the server. If the server <span class=SpellE>recognises</span>
that the client has the up-to-date version of the requested data, then the
response will consist only of HTTP headers and the whole content is not sent
which can considerably reduce the network traffic.<o:p></o:p></span></p>

<p class=MsoNormal><span>The general idea is that on the first request the server sends a
response with an additional header that can indicate the version of the
content. The second request already comes from the client with information
about the version to the server and if the server does not have any updates to
it, it replies with HTTP Status Code 304 (Not Modified), or, otherwise, it
sends the full content with the new version indication.<o:p></o:p></span></p>

<p class=MsoNormal><span>The version can be indicated simply by the last modified date in
the Last-Modified HTTP response header (See Section 14.29 of RFC2616 for more
details). The consequent request should come with HTTP request header
"If-Modified-Since", as defined in Section 14.25 of RFC2616 or "If-Unmodified-Since",
as defined in Section 14.28 of RFC2616.<o:p></o:p></span></p>

<p class=MsoNormal><span>Example<o:p></o:p></span></p>

<p class=MsoNormal><span>First request:<o:p></o:p></span></p>

<p class=MsoNormal><span>GET /image.png HTTP/1.1<o:p></o:p></span></p>

<p class=MsoNormal><span>Host: www.example.com<o:p></o:p></span></p>

<p class=MsoNormal><span>Connection: keep-alive<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>First response:<o:p></o:p></span></p>

<p class=MsoNormal><span>HTTP/1.1 200 OK<o:p></o:p></span></p>

<p class=MsoNormal><span>Cache-Control:
max-age=31536000<o:p></o:p></span></p>

<p class=MsoNormal><span>Content-Type: image/<span
class=SpellE>png</span><o:p></o:p></span></p>

<p class=MsoNormal><span>Date: Mon, 21 Feb 2011
12:41:47 GMT<o:p></o:p></span></p>

<p class=MsoNormal><span>Expires: Tue, 21 Feb
2012 12:41:47 GMT<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span>ETag</span></span><span>:
&quot;11f-49bc3eabc9c80&quot;<o:p></o:p></span></p>

<h4><b><span>Last-Modified: Tue, 08
Feb 2011 11:47:46 GMT</span></b><span><o:p></o:p></span></h4>

<p class=MsoNormal><span>Content-Length: 28702<o:p></o:p></span></p>

<p class=MsoNormal><span>Connection: Keep-Alive<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Consequent request:<o:p></o:p></span></p>

<p class=MsoNormal><span>GET /image.png HTTP/1.1<o:p></o:p></span></p>

<p class=MsoNormal><span>Host: www.example.com<o:p></o:p></span></p>

<h4><b><span>If-Modified-Since: Tue,
08 Feb 2011 11:47:46 GMT</span></b><span><o:p></o:p></span></h4>

<p class=MsoNormal><span>Connection: keep-alive<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Response:<o:p></o:p></span></p>

<h4><span>HTTP/1.1&nbsp;<b>304 Not
Modified</b><o:p></o:p></span></h4>

<p class=MsoNormal><span>Date: Mon, 21 Feb 2011
12:44:07 GMT<o:p></o:p></span></p>

<p class=MsoNormal><span>This example shows that consequent requests can produce huge
savings. In this case the response is short headers that are less than 1KB
rather than 28KB of actual content, and reliability in delivering up-to-date
content. If the server had a more recent copy of the picture, it would reply
with 200 <span class=GramE>status</span> and the full content instead of 304
HTTP status.<o:p></o:p></span></p>

<p class=MsoNormal><span>Content can also be marked with an <span class=SpellE>ETag</span>
(see Section 3.11 of RFC2616) and these must be unique across all versions of
all entities associated with a particular resource.<o:p></o:p></span></p>

<p class=MsoNormal><span>When the <span class=SpellE>ETag</span> is received from the
server, then the client can use HTTP request headers:<o:p></o:p></span></p>

<ul>
<li>"If-Match" [RFC2616
section 14.24] – to deliver only the version that is requested, otherwise HTTP
Status Code 412 (Precondition Failed) is returned</li>
<li>"If-None-Match"
[RFC2616 section 14.26] – to deliver only if the server has any other versions
other than the client has, otherwise HTTP Status Code 304 (Not Modified)</li>
<li>And "If-Range"
[RFC2616 section 14.27] – to deliver part of file (using Range header) only if <span
class=SpellE>ETag</span> matches, otherwise the whole file is delivered.</li>
</ul>

<p class=MsoNormal><span>Taking the same example, the first response also includes the <span
class=SpellE>ETag</span>, so the consequent requests contain either only one
condition or both conditions for the <span class=SpellE>ETag</span> and last
modified date, for example:<o:p></o:p></span></p>

<p class=MsoNormal><span>Example:<o:p></o:p></span></p>

<p class=MsoNormal><span>Consequent request:<o:p></o:p></span></p>

<p class=MsoNormal><span>GET /image.png HTTP/1.1<o:p></o:p></span></p>

<p class=MsoNormal><span>Host: www.example.com<o:p></o:p></span></p>

<h4><b><span>If-None-Match:
&quot;11f-49bc3eabc9c80&quot;</span></b><span><o:p></o:p></span></h4>

<p class=MsoNormal><span>Connection: keep-alive<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Response:<o:p></o:p></span></p>

<h4><span>HTTP/1.1&nbsp;<b>304 Not
Modified</b><o:p></o:p></span></h4>

<p class=MsoNormal><span>Date: Mon, 21 Feb 2011
12:44:07 GMT<o:p></o:p></span></p>

<p class=MsoNormal><span>When selecting a caching strategy, it is important for developers
to evaluate the pros and cons of each mechanism, as differences in server
implementations may have a significant impact on reliability and efficiency of
the caching solution. Both Last-Modified-Since and <span class=SpellE>ETag</span>
mechanisms have their own pros and cons, so bear in mind the following points:<o:p></o:p></span></p>

<ul>
<li>When the same content
is distributed between multiple servers, <span class=SpellE>unsynchronised</span>
time or an <span class=SpellE>unsynchronised</span> <span class=SpellE>ETag</span>
generation algorithm can lead to inconsistent marking of the content and
therefore inconsistent responses from the servers. Server clusters or cloud
based services are usually prone to such issues.</li>
<li>For frequently
changing or time sensitive contents (such as strongly related elements of the
same data) preference should be given to the <span class=SpellE>ETag</span>
mechanism, as it handles sub-second update issues.</li>
</ul>


<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape
 id="Picture_x0020_229" o:spid="_x0000_i1047" type="#_x0000_t75" alt="clip_image028"
 style='width:408pt;height:246pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image011.gif"
  o:title="clip_image028"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=544 height=328
src="SAG_files/image011.gif"
alt="clip_image028" v:shapes="Picture_x0020_229"><![endif]></span><span><o:p></o:p></span></p>

<h3 id="4_3_security"><b><span>4.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Security</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Although many aspects of security apply to both mobile apps and
mobile platforms, this section addresses network security, covering secure data
exchange between the mobile device and cloud web services. The key aspects are:<o:p></o:p></span></p>

<ul>
<li>Classification of information</li>
<li>Authentication of users on web services</li>
<li>Secure data exchange</li>
</ul>


<p class=MsoNormal><span>The following aspects of security must always be taken into
consideration by developers, but they are out of the scope of this document.<o:p></o:p></span></p>

<ul>
<li>Device Security - Aspects of device access security, such as device unlock and
remote wipe of storage in case of device loss</li>
<li>Content protection -
Access control to user's personal data including personal contact information,
address book, call history, SMS messages, mobile wallets, current location,
passwords, VPN keys, etc.</li>
<li>Encryption of locally
stored data</li>
<li>Protection against attacks</li>
<li>Internal and external factors, damage caused by malicious software and viruses</li>
</ul>


<h3 id="4_3_1_classification_of_information"><b><span>4.3.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Classification
of Information</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>When designing mobile
apps, it is important to understand user concerns about data privacy. In a
simplistic way the data is classified as:<o:p></o:p></span></p>

<ul>
<li>Public: Information
which is freely available on the Internet, can be found by other users, and
cannot be associated with a particular user</li>
<li>Private: The data
which can be associated with an identifiable user, leading to compromised
security</li>
</ul>

<p class=MsoNormal><span>Below is an example list:<o:p></o:p></span></p>

<ul>
<li>Use case #1: The app
provides read-only access to the information which can be easily found on the
Internet by&nbsp;other users</li>
</ul>

<p class=MsoNormal><span>Classification: Public<o:p></o:p></span></p>

<ul>
<li>Use case #2: The app
presents the same information as in Use Case #1, but some feedback is collected
and stored in the cloud. This can be customer preferences, history of articles
viewed, user comments or rating of the content.</li>
<li><i><span>Classification</span></i><span>: Private – as data associated with the user can be potentially
used against him. The same data can be classified as Public if it is <span
class=SpellE>anonymised</span> – this however, must be made clear to the user.
User consent is required in both cases</li>
<li>Use case #3: A productivity
application, such as "TODO list", which <span class=SpellE>synchronises</span>
data to the cloud.</li>
<li><i><span>Classification</span></i><span>: Private – the user could store sensitive information within the
app, such as holiday dates, which can potentially indicate the location of the
user. User consent is required</li>
<li>Use case #4: A messaging or social networking app</li>
<li><i><span>Classification</span></i><span>: Private – the user can exchange sensitive information which
could potentially compromise his security. User consent is required</li>
</ul>

<p class=MsoNormal><span>When the data flow and sensitivity of transferred information is
understood, it is a good time to estimate the impact on the user of monitoring
("Sniffing") of such traffic by an <span class=SpellE>unauthorised</span>
party. Sniffing of user traffic may occur over Internet connections provided by
public Wi-Fi access points, those provided by small businesses, or any other
unregulated access point. It may take seconds for an intruder to intercept an
authentication token and impersonate the user. A number of examples of such
intrusions can be found on YouTube, including impersonation of users on social
networks.<o:p></o:p></span></p>

<h3 id="4_3_2_authentication"><b><span>4.3.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Authentication</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Access to any Private data must be controlled and this is normally
achieved by authenticating the client. The most basic authentication is
achieved by validation of a pre-registered client ID with a password. Although
client ID is most frequently just a personal email address of the user, device
ID can also represent a client.<o:p></o:p></span></p>

<p class=MsoNormal><span>It is important to differentiate device authentication from device
identification, where the latter does not require password validation and is
often used by mobile network operators just to trace customers. Solutions
relying on device identification pose a security threat if the mobile device
contains or accesses Private data. Transfer of the mobile device to a different
person if lost, stolen or sold, will automatically provide access to the data
of the previous user.<o:p></o:p></span></p>

<p class=MsoNormal><span>Static device IDs such as serial number, telephone number or IMEI
in clear form should never be used. Obscured device IDs (can be hash code based
on the listed IDs) or automatically provisioned Unique Identifiers (UID) <span
class=GramE>are</span> acceptable and considered to be a good practice.<o:p></o:p></span></p>

<p class=MsoNormal><span>User authentication can also be implemented by integration into
third-party authentication providers, such as Google ID, Facebook ID or
Microsoft Passport. For this reason, refer to APIs provided by these vendors or
adopt open protocol <span class=SpellE>OAuth</span> (</span><a
href="http://oauth.net/"><span>http://oauth.net</span></a><span>).<o:p></o:p></span></p>

<p class=MsoNormal><span>Authentication must be
performed every time the app establishes a new session. Whichever approach is
used for this purpose, it is important to ensure that:<o:p></o:p></span></p>

<ul>
	<li>Authentication is
performed using secure authentication protocols – Basic authentication over
HTTPS is sufficient but over HTTP it is not enough. HTTP digest would be more
appropriate, but again only becomes sufficiently secure over HTTPS. In some
cases, a combination of stronger authentication over encrypted channel
(SSL/TLS) is required. Proprietary implemented authentication must be performed
over secure SSL/TLS based communication channel</li>
	<li>When a session is
established, user or device credentials are not exchanged over an unsecured
connection, so that session IDs, application PINs, service passwords, etc. are
never exposed as these will provide an open door for intruders</li>
	<li>Apps should have an
intelligent built-in logic to ensure all parameters related to user credentials
(e.g. passwords, etc.) are populated prior to sending an <span class=SpellE>authorisation</span>
request to the server</li>
</ul>


<h3><b><span>4.3.2.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Strong
Authentication<o:p></o:p></span></b></h3>

<ul>
<li>Multi-factor
authentication involves a combination of two or more stages. A variety of
approaches exists – one example is a combination of user and server
authentication, where verification of the server is performed by the client
using additional security certificates. This type of authentication is used by
businesses for implementation of Virtual Private Networks (VPNs).</li>
</ul>

<h3 id="4_3_3_secure_data_exchange"><b><span>4.3.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Secure
Data Exchange</span></b><b><span><o:p></o:p></span></b></h3>

<ul>
	<li>Implementation of
secure communication using HTTP over SSL/TLS protocols (HTTPS) within the
applications is not always <span class=SpellE>favoured</span> due to the effort
involved. However, extra effort is needed for the implementation of secure
solutions, and the investment you make in the security of your app will be <span
class=SpellE>recognised</span> and appreciated by users. In many cases, the
additional effort may be only the requirement to purchase and install a trusted
certificate on the server and update the client to use HTTPS instead of HTTP.</li>
<li>Encryption/decryption
of traffic may have an impact on user experience, as additional processing time
at both ends contributes to higher latency. This also has an impact on battery
life. On high-end devices these drawbacks are addressed by hardware accelerated
encryption, which <span class=SpellE>maximises</span> app performance.</li>
</ul>


<h3 id="4_3_4_input_validation"><b><span>4.3.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Input
Validation</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>The consequences of invalidated user input can be crashing apps,
loss of data or theft of sensitive information as malware exploits breaches
such as buffer overflow, format string vulnerabilities, stack overflow or race
conditions.<o:p></o:p></span></p>

<p class=MsoNormal><span>Although many programming languages check input in standard APIs
to prevent buffer overflows, native languages such as C, C++ and Objective C
put this responsibility on the developer. Even though managed languages do aim
for prevention, they still may be linked to native C libraries, and sometimes,
open-source libraries that are not protected from defects and potential
security problems.<o:p></o:p></span></p>


<h3 id="4_3_5_ideal_platform"><b><span>4.3.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ideal
platform</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>An ideal platform would:<o:p></o:p></span></p>

<ul>
<li>Support seamless secure user and server authentication</li>
<li>Provide secure transport by default</li>
<li>Provide secure storage for credentials</li>
</ul>


<h3 id="4_4_efficient_traffic_usage"><b><span>4.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Efficient&nbsp;</span></b><b><span>Traffic Usage<o:p></o:p></span></b></h3>

<h3 id="4_4_1_cloud_based_transformations"><b><span>4.4.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cloud-based&nbsp;</span></b><b><span>Transformations<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>There are mobile apps that use data from public resources such as
news web sites. However, using public resources which are not under your
control poses several risks as they fail to exploit <span class=SpellE>standardised</span>
APIs, and are often inefficient:<o:p></o:p></span></p>


<uL>
<li>The format of data
(HTML code) can be changed at any time which may cause app failure on the
user's device.</li>
</uL>


<p class=MsoNormal><span>The amount of data that is required for the app might be
significantly more than actually necessary, thus increasing network traffic and
latency.<o:p></o:p></span></p>

<p class=MsoNormal><span>In this case, it is highly recommended to check if there are any
APIs (web services) provided from the public resource that are <span
class=SpellE>standardised</span>, less likely to be changed and contain less
unnecessary mark-up information.<o:p></o:p></span></p>

<p class=MsoNormal><span>Note that the API should not be used to deliver excessive amount
of data to the app; otherwise its performance will decrease dramatically.<o:p></o:p></span></p>

<p class=MsoNormal><span>If no APIs are available, then you can also consider creating your
own web service in order to have full control over the protocol and data being
transferred between mobile device and server. In this case, even if the website
changes its HTML code, then only the web service should be updated with the
client remaining unchanged.<o:p></o:p></span></p>

<p class=MsoNormal><span>Many third party tools exist that can be used to transform
content. A good example is Yahoo Pipes (</span><a href="http://pipes.yahoo.com/"><span>http://pipes.yahoo.com</span></a><span>). This provides a graphical user interface to aggregate,
manipulate and mash up content from different sources around the web. Results
can be delivered as RSS or JSON.<o:p></o:p></span></p>

<p class=MsoNormal><span>A few examples of types of operations that can be done with Yahoo
Pipes:<o:p></o:p></span></p>

<ul>
<li>Fetch data from
different sources like feeds, web pages, Google or Yahoo search, Flickr photos</li>
<li>Custom input data can
be used as an external parameter – i.e. a search query</li>
<li>String manipulations
such as regular expressions, text <span class=SpellE>analyser</span>,
translation, etc.</li>
<li>Location builder from
a string</li>
<li>Mathematical
operations</li>
<li>Filtering and sorting
of the result</li>
</ul>

<p class=MsoNormal><span>The picture below shows an example Yahoo Pipe that aggregates the
results of search from four different sources, sorts the items by date and
filters out non-unique titles, and compiles a result of maximum 40 news
stories. It is also possible to combine the feeds of different languages and
automatically translate them before aggregation<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape
 id="Picture_x0020_207" o:spid="_x0000_i1046" type="#_x0000_t75" alt="Description: &#748;°"
 style='width:441pt;height:262.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image012.jpg"
  o:title=" &#748;°"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=588 height=350
src="SAG_files/image012.jpg"
alt="Description: &#748;°" v:shapes="Picture_x0020_207"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 11</span></b><span>:
Yahoo Pipes solution<o:p></o:p></span></p>

<h3 id="4_4_2_media_transcoding"><b><span>4.4.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Media
Transcoding</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>If the inefficiency in text based data formats can be improved by
compression, the case for media formats – pictures, audio and video – is
somewhat more complex as the quality of the media has a huge impact on its
size. Therefore, special care should be taken when transferring media.<o:p></o:p></span></p>

<p class=MsoNormal><span>Most mobile phones have fairly low (i.e. few-megapixel) cameras;
however if an app uploads a picture taken by this camera for a social network
website, which will reduce the size of any picture, there is no point in
sending the image in its original quality. The difference in size can be around
30-50 times, which can also be the time difference taken in uploading the picture.<o:p></o:p></span></p>

<p class=MsoNormal><span>The same applies for downloading pictures. If the picture is
supposed to be displayed only on the mobile device, then there is no point in
downloading the original file size. This is always applicable, for example, for
thumbnails; however, for full-screen photos some additional overhead might be
allowed to allow users scaling up the image.<o:p></o:p></span></p>

<p class=MsoNormal><span>The size of video files can be enormous if a smartphone has an HD
camera; in this case it might not be possible to upload a video over the mobile
network without transcoding to a smaller, lower quality file.<o:p></o:p></span></p>

<p class=MsoNormal><span>If an app has video playback functionality, then a few points
should be taken into account:<o:p></o:p></span></p>

<ul>
<li>It is better to not to
exceed the resolution of the display where the video is going to be played
(mobile device display or external display)</li>
<li>If the video is played
in real time, then the bandwidth of the current network should be checked to
identify the appropriate bit rate of video that can be played without constant
delays. Progressive download and download resuming (section 3.2) may be used</li>
<li>Apple lays down strict
requirements for online video in apps. If the video exceeds either 10 minutes
duration or 5 Mb of data in a five minute period, you are required to use HTTP
Live streaming; otherwise Progressive Download can be used.</li>
<li>As an alternative
mechanism, MPEG DASH (Dynamic Adaptive Streaming over HTTP) provides a
standardized, adaptive streaming protocol solution to use network resource
efficiently. More information about MPEG DASH can be found in &lt;ISO/IEC 23009
1:2012&gt;</li>
<li>Previously there were
several commercial products for adaptive streaming such as Apple's HTTP Live
streaming, MS's Smooth Streaming or Adobe's HTTP Dynamic Streaming. But In
practice however, media service providers have adopted the streaming solution
associated to the platform through which they delivered their media content,
there was no interoperability between them. Acting on the demand from the
industry, a standard for adaptive streaming, DASH was issued by MPEG.</li>
</ul>

<p class=MsoNormal><span>The ideal APIs on the platform to ensure that developers can
leverage media transcoding would be:<o:p></o:p></span></p>

<ul>
<li>Basic image resizing</li>
<li>Codecs that allow
quality reduction (and size) of the audio file</li>
<li>Reducing quality and
resolution in order to reduce the size of the video file</li>
<li>Support of media
streaming protocols such as DASH, HTTP Live Streaming or RTSP</li>
</ul>


<h3 id="4_4_3_presence"><b><span>4.4.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Presence</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>With the growth of presence-based services, it is important to
manage high traffic and balance load generated by the services. Presence event
distribution systems may generate numerous and unnecessary traffic such as
separate presence subscription requests for multiple target users thus
increasing the load on the mobile network. As such, many common methods have
been developed to reduce the network traffic generated by Presence event
distribution systems.<o:p></o:p></span></p>

<p class=MsoNormal><span>Developers should consider applying such methods to their
applications to reduce the network traffic.<o:p></o:p></span></p>

<p class=MsoNormal><span>However, some optimization techniques may lengthen the delivery
time of presence updates, preventing users from receiving presence in a timely
manner. For this reason, developers should also consider prioritizing presence
information to be delivered when adopting some of these techniques<o:p></o:p></span></p>

<h3><b><span>4.4.3.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bundling
of Individual Presence Subscription Requests<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Based on traditional mechanisms, a presence subscription request
is sent for each target user individually. When the number of target users to
subscribe is large, application developers should consider reducing the number
of subscription requests by bundling them in a single request to reduce the
network traffic generated.<o:p></o:p></span></p>

<p class=MsoNormal><span>For example, in the SIP-based mechanism, RLS (Resource List
Server) is a mechanism for subscribing to a list of target users. Instead of
sending individual subscription requests, the watcher (requesting user) sends a
single subscription request that contains a list of <span class=SpellE>presentities</span>
(target users) to the RLS. Based on the list of <span class=SpellE>presentities</span>,
the RLS sends multiple individual subscription requests to the presence server
on behalf of the watcher. More detailed information about RLS can be found in
&lt;IETF RFC4662 <span class=GramE>A</span> Session Initiation Protocol (SIP)
Event Notification Extension for Resource Lists&gt;.<o:p></o:p></span></p>

<h3><b><span>4.4.3.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Partial
Publication<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Partial publication is a mechanism in which the target user sends
only the parts of presence information that have changed since the previous
update. Initially, complete presence information is sent to the watcher
(requesting user) and then only parts of presence information are sent,
reducing the amount of necessary data transferred over the network.<o:p></o:p></span></p>

<p class=MsoNormal><span>An example of mechanism for partial publication can be found in
IETF draft-simple-partial-PIDF format &lt;IETF RFC 5262 Presence Information
Data Format (PIDF) Extension for Partial Presence&gt;. This technique does not
reduce the number of presence notifications but reduces the size of the
notifications. A watcher device can construct then the complete presence
information from the partial publication received.<o:p></o:p></span></p>

<h3 id="4_4_4_email"><b><span>4.4.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Email</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Applications that send
or receive email should carefully consider how to address a number of special
cases specific to email:<o:p></o:p></span></p>

<ul class="alpha">
<li>Creating large messages<br><br>Many applications and devices allow users to paste images, videos,
or other multimedia content into email messages. By simply pasting some images
or a short video into an email message it is possible to generate a message in
the 10's or 100's of MB.<br><br>When developing an application that can send email, it is
important to understand if this type of scenario applies, and if so, how to
handle it. Some important considerations are:
	<ul>
    	<li>If it is possible to
paste multimedia content, consider limiting the amount of information that can
be pasted to avoid running out of memory or generating unreasonably large
emails that it may not be possible to send / receive.</li>
    	<li>If it is possible to
paste images, consider displaying the resulting message size to the user and
providing an option to reduce the image size/quality.</li>
    	<li>Consider implementing
a limit on the maximum message size that can be sent, and/or prompting the user
if the message is larger than a certain size.</li>
    	<li>Many email servers
limit the maximum size of a message that can be sent. When sending large
messages, it is recommended that the application checks the maximum message
size supported by the server before sending the message to avoid wasting a
large amount of data bandwidth and battery power transmitting a message that
the server will not accept. For SMTP, this mechanism is described in RFC1870.</li>
    </ul>

</li>
<li>Downloading large messages</li>
<li>When downloading messages, it is recommended to check the message
size before downloading it to avoid unnecessarily downloading email messages
which may be arbitrarily large and may not be able to be stored or displayed
correctly on the device.</li>
<li>Frequent polling for messages<br><br>If possible, it is recommended to use a Push Server to notify the
application when new messages are available on the server. If this is not
supported, the client must <span class=SpellE>periodicallypoll</span> the
server to check for new messages. Polling is very resource intensive on the
device and frequent polling can have a significant impact on battery life.
Developers are advised to carefully select the default and supported polling
intervals in their application. As a best practice, a default polling interval
of 60-minutes is suggested with a minimum polling interval of no less than
5-minutes.</li>
<li>Error handling / retries<br><br>Special care needs to be taken when re-sending email messages that
failed. In many cases, it is possible for the client to determine that the
failure is permanent and the message can never be successfully sent – for
example 5xx series errors in SMTP – these cases should never lead to a retry.<br><br>In cases where a network error or temporary server error occurred
– including a timeout where no reply is received – the number of retries should
be limited and staggered over time to limit the potential impact on data
bandwidth and battery life. This is especially important if the client does not
limit the maximum size of email messages since each attempt could lead to
multiple MB of network traffic.</li>
</ul>



<h3 id="4_4_5_push_notification"><b><span>4.4.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Push
Notification</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Excessive background data traffic of smartphones creates adverse
impacts on mobile networks, such as:<o:p></o:p></span></p>

<ul>
<li><span class=SpellE>Signalling</span>
loop issue: smartphone sends <span class=SpellE>signalling</span> in a
continuous loop, and/or aggressively re-sends signals with no success, or when
it is not necessary to do so</li>
<li>Reduces the real
capacity of the network and wastes network resources</li>
<li>Potentially creates <span
class=SpellE>signalling</span> storm and <span class=SpellE>signalling</span>
congestion</li>
<li>Potentially creates
overload of network<br>Unnecessary background data traffic may also impact user
experience negatively, such as:</li>
<li>Reduced battery life</li>
<li>Reduced throughput
and/or increased delay for other users etc.</li>
</ul>

<p class=MsoNormal><span>The best practice to minimize excessive background data traffic
from smartphones is to use push notifications at every effort instead of the
long polling type of method.<o:p></o:p></span></p>

<p class=MsoNormal><span>While it is understood that push notification is quite platform
dependent in today's market, such as Apple Push Notification service (APN) for
iOS device (5.1.5), Google Cloud Messaging (GCM) for Chrome and Android device
(5.2.5), and Microsoft Push Notification Service (MPNS) for Windows Phone
device (5.3.5), alternative methods such as SMS and/or WAP Push is also
available to enable push notifications on many operators' networks.<o:p></o:p></span></p>

<p class=MsoNormal><span>Please refer to documentation of specific operators' developer
programs for how to utilize their SMS and/or other network APIs to enable push
notification on smartphones.<o:p></o:p></span></p>

<h3 id="4_5_compression"><b><span>4.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compression</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>The HTTP protocol defines the mechanism of transferring data in
compressed ways, if the server can support it, and most do. Enabling compression
is a very simple task for the most popular web servers.<o:p></o:p></span></p>

<p class=MsoNormal><span>Compression can be very effective for XML or JSON formatted text
data, by reducing the overall size by 80% on average. For binary contents, like
photos or videos, however, compression does not make much difference.<o:p></o:p></span></p>

<p class=MsoNormal><span>The main idea of the HTTP compression is that if the client
supports any of the standard compression methods such as <span class=SpellE>GZip</span>,
Deflate (<span class=SpellE>zlib</span>) or LZW, then it mentions it in the
request to the server. If the server supports the listed methods it can send a
compressed response.<o:p></o:p></span></p>

<p class=MsoNormal><span>The indication that the client supports compressions is sent via
HTTP Header Accept-Encoding.<o:p></o:p></span></p>

<p class=MsoNormal><span>Example request indicating that client supports <span
class=SpellE>GZip</span> and Deflate compression methods:<o:p></o:p></span></p>

<p class=MsoNormal><span>GET / HTTP/1.1<br>
Accept-Encoding:&nbsp;<span class=SpellE><b>gzip</b></span><b>, deflate</b><br>
Host:&nbsp;</span><span>www.example.com</span><span><o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Example response
indicating that content is compressed:<o:p></o:p></span></p>

<p class=MsoNormal><span>HTTP/1.1 200 OK<o:p></o:p></span></p>

<p class=MsoNormal><span>Content-Length: 438<o:p></o:p></span></p>

<p class=MsoNormal><span>Content-Type: text/html;
charset=UTF-8<o:p></o:p></span></p>

<p class=MsoNormal><span>Content-Encoding:&nbsp;<span
class=SpellE><b>gzip</b></span><o:p></o:p></span></p>

<p class=MsoNormal><span>…<o:p></o:p></span></p>

<p class=MsoNormal><span>RFC2616 section 14.3 and section 3.9 explain the Accept-Encoding
header in more detail, and particularly, tips on defining the priorities
(importance) of using different methods. The HTTP compression technique
includes negotiation, to make sure that both the client and server support the
same compression methods, so even more efficient methods can be implemented for
certain types of content.<o:p></o:p></span></p>

<p class=MsoNormal><span>In order to simplify compression, the ideal API for HTTP client
would support the main compression methods <span class=SpellE>GZip</span>,
Deflate (<span class=SpellE>zlib</span>) and compress (LZW) with the
corresponding Accept-Encoding header added by default and the content
decompressed by default. However, you would also be able to disable or redefine
handling of compression in order to support custom methods.<o:p></o:p></span></p>

<h4><span>References Request compression<o:p></o:p></span></h4>

<h5><a
href="http://httpd.apache.org/docs/2.0/mod/mod_deflate.html#input">http://httpd.apache.org/docs/2.0/mod/mod_deflate.html#input</a><span><o:p></o:p></span></h5>

<h4><span>Speed Web delivery with HTTP compression<o:p></o:p></span></h4>

<h5><a
href="http://www.ibm.com/developerworks/web/library/wa-httpcomp/">http://www.ibm.com/developerworks/web/library/wa-httpcomp/</a><span><o:p></o:p></span></h5>

<h4><span>RFC2616<o:p></o:p></span></h4>

<h5><a href="http://www.ietf.org/rfc/rfc2616.txt">http://www.ietf.org/rfc/rfc2616.txt</a><span><o:p></o:p></span></h5>

<h3 id="4_6_background_foreground_modes"><b><span>4.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Background
/ Foreground&nbsp;</span></b><b><span>Modes<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Most mobile platforms support some distinction between background
and foreground modes for apps. The precise distinction varies from platform to
platform but typically an app is said to be in the background if no part of its
UI is visible and the user is unable to interact with it.<o:p></o:p></span></p>

<p class=MsoNormal><span>Given that a user interaction is not possible, careful
consideration should be given to this aspect of app design to ensure that
unnecessary network resources are not being used while in background mode. This
will generally help to improve the user experience of the foreground
application.<o:p></o:p></span></p>

<p class=MsoNormal><span>More specifically the app will receive some indication from the
platform when a transition between modes occurs and should take advantage of
this to gracefully release (or otherwise disable) the following application
components:<o:p></o:p></span></p>

<ul>
<li>Handlers</li>
<li>Timers</li>
<li>Network transactions</li>
<li>Memory/Objects</li>
<li>Media codecs</li>
<li>File &amp; databases</li>
</ul>

<p class=MsoNormal><span>Special attention should be given to apps that interact with the
network on a regular basis as this drains the device battery and generates <span
class=SpellE>signalling</span> traffic. In most cases the app should be
prevented from interacting with the network whilst in background mode, as there
is no way to present results, unless a notifications system is used. Idle
screen widgets (e.g. weather / news) are common culprits here; however, this
does not apply for apps such as instant messengers, as they need a constant
connection.<o:p></o:p></span></p>

<p class=MsoNormal><span>There can be no hard and fast rules in this area – for instance a
music player is likely to want to continue to decode audio even when in
background mode. At the very least you should review the detailed operation of
your app in each state to ensure its resource footprint is appropriate.<o:p></o:p></span></p>

<p class=MsoNormal><span>Similarly, apps that do need to interact with the network whilst
in background mode should consider alternative approaches. For example it may
be possible to batch the transactions of several apps so the background app <span
class=GramE>can</span> "piggy-back" its transactions. This batching capability
may be provided by the platform itself; it is particularly important for
background events when there is no user interaction with the phone (e.g. the
phone is on a desk). A common reason for background apps to access the network
is to poll a server, however a better approach is to use push notification (if
supported).<o:p></o:p></span></p>

<p class=MsoNormal><span>The HTTP "Keep-Alive" mechanism is frequently used as the basis
for push notification systems, but this only works well if there is a <span
class=SpellE>centralised</span> client side component for receiving/routing
notifications (i.e. as part of the platform e.g. Android GCM ).<o:p></o:p></span></p>

<p class=MsoNormal><span>If push notifications are not available or not suitable,
keep-alive connections can be used to replicate a push notification mechanism
and avoid frequent polling of data. The main advantage of keep-alive over
polling is that the connection can be kept open without frequent transfer of data,
enabling the mobile state to switch to lower power. However, if anything needs
to be delivered from the server, this can happen immediately. It is also
necessary to make sure that the connection is still alive by sending
non-frequent data packets (minimum 10 minutes, but slightly less than 30
minutes seem to be the optimal setting as many <span class=GramE>firewall/NAT's</span>
timeout TCP connection after 30 minutes).<o:p></o:p></span></p>

<p class=MsoNormal><span>Some platforms provide a
richer (more fine grained) application lifecycle than others. You should
exploit the lifecycle to its fullest to achieve the best user experience.<o:p></o:p></span></p>

<p class=MsoNormal><span>It may be desirable, for example, to retain a group of thumbnails
across several application states that represent the "active" cycle of the app
(where "active" might encompass background as well as foreground modes) but
release them across states that represent a less active cycle. Failing to
consider the target lifecycle can result in apps that perform well<span
class=GramE>&nbsp; on</span> one platform having poor performance on another.<o:p></o:p></span></p>

<p class=MsoNormal><span>You should also consider altering your app's resource footprint in
response to changes in the mobile device state. In some cases these may fall
within the scope of the application lifecycle (e.g. an incoming phone call is
likely to result in the app making a transition to background mode). Other
changes may lead to a different form of notification (apps may need to register
to receive screen lock event notifications for instance). A useful approach is
to treat each state transition as a separate use-case and identify those cases
that impact on the app. This would, for example, show that in the case of the
music player mentioned earlier it might be worth shutting down the audio
decoder task when the speaker is muted.<o:p></o:p></span></p>

<p class=MsoNormal><span>Another aspect to highlight is that many apps seem to trigger
network activity (e.g. polling, status update) when the screen display turns on
and the device wakes up from sleep mode. The intention may be to obtain/update
the latest information when the user starts interacting with the device.
However, the screen display may turn on regardless of the user's intention to
interact with the device, and the device screen may remain locked. For example,
the screen display may just turn on due alarm clocks or the user tapping the
screen display to check time. Thus, to avoid unnecessary network <span
class=SpellE>signalling</span> / draining of device battery, it is recommended
to trigger such network activity when requested explicitly rather than being
triggered by the event of screen display turning on.<o:p></o:p></span></p>

<h3 id="4_7_application_scaling"><b><span>4.7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application
Scaling</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Your app should be designed to ensure that network activity is not
concentrated at specific times and is tolerant of geographical loading problems<o:p></o:p></span></p>

<ul>
<li>Handsets are
frequently <span class=SpellE>synchronised</span> to a standard clock source,
so frequent updates using exact times (especially for apps that are used by
many users) may cause short overloads to the application servers and the radio
network. A better example of how to do this is antivirus tools which launch
update requests back to servers independently of one another. Perhaps the most
popular example is RSS feed used in browser application. They may result in
delayed responses and impacting user experience. Designing an app to spread
network activity timing across different devices would reduce such overloads,
and improve app performance and device battery life.</li>
<li>To illustrate the
point let us take a closer look at the RSS feed example (where it can also be
implemented as a native application)</li>
<li>RSS newsfeed may
require the RSS reader on handsets to check for updates on servers periodically
(e.g. every 30 <span class=SpellE>mins</span>), but not necessarily at exact
times (e.g. XXhr<span class=GramE>:00min</span>, XXhr:30min). In such cases, it
would be ideal to evenly spread the network activity timings (i.e. the timings
which the RSS readers checks for updates) across devices as in Figure 11 below.
<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_185"
 o:spid="_x0000_i1045" type="#_x0000_t75" alt="clip_image032" style='width:351.75pt;
 height:135pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image013.gif"
  o:title="clip_image032"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=469 height=180
src="SAG_files/image013.gif"
alt="clip_image032" v:shapes="Picture_x0020_185"><![endif]></span><span><o:p></o:p></span></p>
<p class=MsoNormal align=center><b><span>Figure 12</span></b><span>: Spreading an App's NW activity timing<o:p></o:p></span></p>
</li>
<li>One way to <span
class=SpellE>realise</span> such <span class=SpellE>behaviour</span> would be
to schedule network activity timings using relative times (e.g. "30 min from
the current time"), and using a timing which would not be aligned across
devices as the base timing. For example, the base timing can be the time of the
device boot up.</li>
<li>Weather widgets may
require data retrieval from servers at exact times of a day (e.g. 05hr<span
class=GramE>:00min</span>, 11hr:00min, 17hr:00min) when the latest information
is made available. In such cases, it would be better to spread the network
activity timings (i.e. the timings which the weather widgets retrieves data)
across devices within an acceptable time window (e.g. 5min) as in Figure 12
below.
<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape
 id="Picture_x0020_184" o:spid="_x0000_i1044" type="#_x0000_t75" alt="clip_image034"
 style='width:387pt;height:198.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image014.gif"
  o:title="clip_image034"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=516 height=265
src="SAG_files/image014.gif"
alt="clip_image034" v:shapes="Picture_x0020_184"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 13</span></b><span>: Spreading an App's NW activity timing within an acceptable
window<o:p></o:p></span></p>
</li>
<li>Such <span
class=SpellE>behaviour</span> can be <span class=SpellE>realised</span> by
including a random offset (within a desired time window) when scheduling
network activities. E.g. "Activity at 17hr<span class=GramE>:00min</span> +
offset", where the offset is defined with a random function having an uniform
distribution within the desired window.</li>
<li>Developers are recommended
to avoid, as much as possible, using exact times for an app's network
activities, and to use <span class=SpellE>randomisation</span> design
techniques to spread network activity timings across different devices. The
network capacity of a local area will be significantly lower than the product
of the number of handsets and their assigned bandwidth. On occasions there may
be large numbers of users in a specific location. In general, apps should use
some <span class=SpellE>randomisation</span> design techniques to spread
network synching and connectivity load.</li>
</ul>



<h2 id="5_best_practices_for_applications"><b><span>5&nbsp;&nbsp;&nbsp;Best
Practices for Applications</span></b></a><b><span><o:p></o:p></span></b></h2>

<h3 id="5_1_best_practices_and_tools"><b><span>5.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Best
Practices and Tools</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Automatically detect where your app can improve. Suggested Best
Practices for File Download<o:p></o:p></span></p>

<p class=MsoNormal><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/text-file-compression"><span>Text File Compression</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><span>Provides background on the different methods for text file
compression, looks at the issue of when it is most beneficial to use
compressions, and provides a recommendation for using text file compression to
make your app pages render faster.<o:p></o:p></span></p>

<p class=MsoNormal><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/duplicate-content"><span>Duplicate Content</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><span>Looks at how content becomes duplicated, how that effects an
application, and offers recommendations for developing a caching strategy to
reduce duplicate content.<o:p></o:p></span></p>


<p class=MsoNormal><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/cache-control"><span>Cache Control</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><span>Describes the caching mechanisms and Cache-Control directives that
are specified in the HTTP/1.1 Protocol, discusses why caching is important, and
provides recommendations for implementing a cache in an application.<o:p></o:p></span></p>

<p class=MsoNormal><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/cache-expiration"><span>Cache Expiration</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><span>Describes the components of the expiration model that are
specified in the HTTP 1.1 Protocol, gives an example of what can occur when the
expiration model is not used correctly, and provides recommendations for how to
take advantage of the cache expiration mechanism in an application.<o:p></o:p></span></p>

<p class=MsoNormal><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/content-pre-fetching"><span>Content Pre-fetching</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><span>Looks at how pre-fetching works, describes some issues involved in
content management, and provides recommendations for how to use pre-fetching in
an application.<o:p></o:p></span></p>

<p class=MsoNormal><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/combine-java-script-and-css-requests"><span>Combine JavaScript and CSS Requests</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><span>Explains how combining the requests for files of the same type can
speed up the loading of your app.<o:p></o:p></span></p>

<p class=MsoNormal><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/resize-images-for-mobile"><span>Resize Images for Mobile</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><span>Describes the pros and cons of different approaches for sizing and
displaying images, and provides recommendations for determining which images
are causing inefficiency and how they can be resized for mobile devices.<o:p></o:p></span></p>

<p class=MsoNormal><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/minify-css-js-and-html"><span>Minify CSS, JS, and HTML</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><span>Describes some issues involved with removing unnecessary
characters from text files, tells you how AT&amp;T ARO can help identify files
that could be minified, and provides recommendations for minifying your CSS,
JS, and HTML files.<o:p></o:p></span></p>

<p class=MsoNormal><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/managing-images-with-css-sprites"><span>Managing Images with CSS Sprites</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>Looks at CSS sprites as a way to speed up web
connections in your app by reducing the number of image requests.</span></span><span><o:p></o:p></span></p>

<h4><b><span>Suggested Best Practices
for Connections</span></b><span><o:p></o:p></span></h4>

<ul>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/opening-connections"><b><span>Opening Connections</span></b></a><br>
Describes the impact that opening connections inefficiently can
have on a wireless application and offers recommendations on how to open
connections more efficiently.
</li>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/multiple-simultaneous-tcp-connections"><b><span>Multiple Simultaneous TCP Connections</span></b></a><br>
Takes a look at how TCP connections are established to see why
persistent connections are more efficient, examines the issue of latency when
multiple persistent connections are opened on a wireless network, and offers
recommendations for smarter connection management in mobile apps to deal with
this issue.
</li>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/periodic-transfers"><b><span>Periodic Transfers</span></b></a><br>
Explains how periodic transfers can cause an application to drain
energy and offers recommendations on how to use periodic transfers effectively
so that they have the least effect on user experience and network resources.
</li>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/screen-rotations"><b><span>Screen Rotations</span></b></a>
<br>
Looks at how accelerometers are used in mobile apps, describes the
issues involved in managing screen rotation, and provides a recommendation for
how to manage screen rotation more efficiently.
</li>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/closing-connections"><b><span>Closing Connections</span></b></a><br>
Describes the ways in which TCP connections can be closed,
examines an issue that occurs when TCP connections are not deliberately closed,
and offers recommendations for closing connections more efficiently.
</li>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/offloading-to-wifi"><b><span>Offloading to Wi-Fi</span></b></a><br>
Discusses the costs and benefits of using Wi-Fi
in an application.
</li>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/third-party-scripts"><b><span>Third-Party Scripts</span></b></a><br>
Looks at the issues involved with using third-party scripts and
provides recommendations for reducing the impact of third-party scripts on an
app.<br><br>Suggested Best Practices
for HTML
</li>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/http-400-and-500-error-codes"><b><span>HTTP 400 and 500 Status Codes</span></b></a><br>
Provides some background on what the different classes of HTTP Status
Codes represent, describes the issues raised by the most common 400 and 500
Status Codes, and discusses possible resolutions for them.
</li>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/http-300-status-codes"><b><span>HTTP 300 Status Codes</span></b></a><br>
Provides some background on what the different classes of HTTP
Status Codes represent, describes the issues raised by the most common 300
Status Codes, and discusses possible resolutions for them.
</li>
<li>
<a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/asynchronous-load-of-javascript-in-html"><b><span>Asynchronous Loading of JavaScript</span></b></a><br>
Describes how you can speed up the rendering of pages in your app
by downloading JavaScript files asynchronously.
</li>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/http-1-0-usage"><b><span>HTTP 1.0 Usage</span></b></a><br>
Describes the improvements that were added in the HTTP 1.1
protocol and discusses the issues faced by apps that use the older protocol
HTTP 1.0.
</li>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/file-order-external-style-sheets-and-script"><b><span>File Order of External Style Sheets and Scripts</span></b></a><br>
Looks at different types of peripheral applications and the issues
involved in using them, and provides recommendations for how to use them
efficiently in an application.
</li>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/empty-source-and-link-attributes"><b><span>Empty Source and Link Attributes</span></b></a><br>
Describes how leaving source or link attributes empty can cause
extra overhead and delays in your app, and tells you how AT&amp;T ARO can help
identify files that contain empty attributes so you can mitigate the issue.</li>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/flash-files"><b><span>Flash Files</span></b></a>
<br>
Looks at different types of peripheral applications and the issues
involved in using them, and provides recommendations for how to use them
efficiently in an application.
</li>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/displaying-none-in-css"><b><span>Displaying None in CSS</span></b></a><br>
Looks at why the CSS rule &quot;display: none&quot; is often used
in apps, how it can cause issues, and describes how AT&amp;T ARO can help you
minimize its use.
</li>
</ul>
<h4>Other Suggested Best Practices</h4>
<ul>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/accessing-peripherals"><b><span>Accessing Peripherals</span></b></a><br>
Looks at different types of peripheral applications and the issues
involved in using them, and provides recommendations for how to use them
efficiently in an application.
</li>
</ul>


<h4><b><span>General Topics</span></b><span><o:p></o:p></span></h4>

<ul>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/comparing-lte-and-3g-energy-consumption"><b><span>Comparing LTE and 3G Energy Consumption</span></b></a><br>
Describes the differences in the state machines and power usage of
the LTE and 3G networks, and shows you how AT&amp;T ARO displays those
differences so you can be aware of how your app is performing on both networks.
</li>
<li><a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/content-optimization-for-mobile-devices"><b><span>Content Optimization for Mobile Devices</span></b></a><br>
Content design and management for mobile devices has long been a
challenge due to screen size and network speeds. Even as devices and networks
have made amazing improvements, developers still need to carefully manage their
content and look for ways to optimize it.
</li>
</ul>


<h4><b><span>The Application Resource
Optimizer</span></b><span><o:p></o:p></span></h4>

<p class=MsoNormal><span>The AT&amp;T ARO diagnostic tool tests for most of these best
practices. Using ARO in conjunction with best practices can make a developer's
job easier and more productive. And it is&nbsp;<b>FREE</b>.&nbsp;</span><a
href="http://developer.att.com/application-resource-optimizer"><span>Learn more about ARO</span></a><span>.<o:p></o:p></span></p>

<h3 id="5_2_combine_requests"><b><span>5.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Combine
Requests</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Speed up load times.<o:p></o:p></span></p>

<p class=MsoNormal><span>Multiple requests for separate files of the same type can slow the
loading of a page. Whenever possible, consider combining similar file types
into as few files as is practical.<o:p></o:p></span></p>

<p class=MsoNormal><span>CSS and JavaScript are susceptible to this issue. Dependence on
multiple external CSS files and multiple external JavaScript files will incur
multiple downloads.<o:p></o:p></span></p>

<p class=MsoNormal><span>To speed up the loading of a page, you can combine multiple JS
files into a single file or multiple CSS files into a single file. This can be
done manually or programmatically, but combining files can create some issues:<o:p></o:p></span></p>

<ul>
<li>Combined files can
cause issues with the namespaces of other scripts and create unpredictable
bugs.</li>
<li>Combined files can
become large and unwieldy.</li>
<li>One change to any part
of the combined file invalidates the whole file in the browser's cache and requires
a slow re-download.</li>
<li>Combined JavaScript
files can lose the benefits of cross-site JavaScript CDNs which effectively
pre-load common scripts into the visitor's cache in transit.</li>
</ul>


<p class=MsoNormal><span>The Best Practice Recommendation is to reduce the number of external
JavaScript and CSS files to as few as possible. This will cut down on the
number of file requests and RTTs that can slow your app and can cause delays in
downloading other resources.<o:p></o:p></span></p>

<ul>
<li>Read more about&nbsp;<a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/combine-java-script-and-css-requests"><b><span>Combining Multiple Requests for Files</span></b></a>.</li>
<li>The AT&amp;T ARO
diagnostic tool checks for multiple CSS files which might be combined together,
and separately checks for multiple JavaScript files which might be combined
together.&nbsp;<a
href="http://developer.att.com/application-resource-optimizer"><b><span>Learn more about ARO</span></b></a>.</li>
</ul>


<h3 id="5_3_file_minification"><b><span>5.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File
</span></b><span class=SpellE><span><b><span>Minification</span></b></span></span><span></span><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Reduce data usage and speed up load times.<o:p></o:p></span></p>

<p class=MsoNormal><span>Computer code often contains extra whitespace and formatting to
make it easier for human beings to read. However, when a code file is being
executed it will be read primarily by machines and the excess white space and
other unneeded characters no longer provide value.<o:p></o:p></span></p>

<p class=MsoNormal><span>Removing unnecessary characters (<span class=SpellE>minification</span>)
will reduce file size, causing the file to be downloaded and executed more
quickly.<o:p></o:p></span></p>

<p class=MsoNormal><span>You can minify your files manually or programmatically.<o:p></o:p></span></p>

<p class=MsoNormal><span>There are many third party solutions available for minifying your
code. By adding <span class=SpellE>minification</span> steps to your
publication workflow, you reduce the size of the files, allowing them to be
transmitted and processed more quickly, removing milliseconds from your app
loading time.<o:p></o:p></span></p>

<p class=MsoNormal><span>The Best Practice Recommendation is to minify files whenever
possible as long as it is compatible with your code and your workflow.<o:p></o:p></span></p>

<ul>
<li>Read more about&nbsp;<a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/minify-css-js-and-html"><b><span>Minifying CSS, JS, and HTML</span></b></a>.</li>
<li>The AT&amp;T ARO diagnostic
tool runs a test that checks for opportunities to streamline your files through
<span class=SpellE>minification</span>.&nbsp;<a
href="http://developer.att.com/application-resource-optimizer"><b><span>Learn more about ARO</span></b></a>.</li>
</ul>

<h3 id="5_4_periodic_connections"><b><span>5.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Periodic
Connections</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Improve user experience by optimizing connections.<o:p></o:p></span></p>

<p class=MsoNormal><span>Periodic transfers are specific packets that are sent repeatedly
by a server over an infinite time horizon. They typically occur at regular
intervals, and the timing of the intervals can be adjusted.<o:p></o:p></span></p>

<p class=MsoNormal><span>The Best Practice Recommendations for using periodic transfers
effectively in a wireless application are:<o:p></o:p></span></p>

<ul>
<li>Determine the best
timing for analytics and <span class=SpellE>keepalives</span> so that your
application uses as long a period as possible between transfers.</li>
<li>Use piggybacking to
combine analytics with other data and remove standalone pings.</li>
<li>Use batching to bundle
as much data as possible into a single message.</li>
<li>Experiment with
different scenarios to determine which combination of periodic transfer timing,
piggybacking and batching can improve your application the most.</li>
<li>On the AT&amp;T
Developer site you can read a lot more about&nbsp;<a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/periodic-transfers"><b><span>Periodic Transfers</span></b></a>.</li>
<li>The AT&amp;T ARO
diagnostic tool runs a test that analyzes the periodic transfers in your
application.&nbsp;<a
href="http://developer.att.com/application-resource-optimizer"><b><span>Learn more about ARO</span></b></a>.</li>
</ul>


<h3 id="5_5_reduce_number_of_redirects"><b><span>5.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduce
Number of Redirects</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span class=GramE><span>Removes unnecessary delays while loading.</span></span><span><o:p></o:p></span></p>

<p class=MsoNormal><span>HTTP 301 and 302 Status Codes indicate a redirection response from
the server that will lead to some additional overhead for the application.<o:p></o:p></span></p>

<p class=MsoNormal><span>The 3xx class of HTTP Status Codes indicates that further action
needs to be taken by the user agent in order to fulfil a request. The required
action may be carried out by the user agent without interaction with the user,
if and only if, the method used in the second request is GET or HEAD. A client
should make an effort to detect infinite redirection loops, since such loops
generate network traffic for each redirection.<o:p></o:p></span></p>

<p class=MsoNormal><span>A Best Practice Recommendation for HTTP 301 and 302 Status
Response Codes is to review each occurrence of these codes in an HTTP response
and take action where needed.<o:p></o:p></span></p>

<ul>
<li>On the AT&amp;T Developer site you can read a lot more about&nbsp;<a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/http-300-status-codes"><b><span>Reducing HTTP</span></b><span>&nbsp;Redirects</span></a>.</li>
<li>The AT&amp;T ARO
diagnostic tool specifically identifies instances of HTTP 301 and 302 Response
Status Codes that are found in an application trace.&nbsp;<a
href="http://developer.att.com/application-resource-optimizer"><b><span>Learn more about ARO</span></b></a><b><span>.</span></b></li>
</ul>


<h3 id="5_6_400_500_errors"><b><span>5.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;400/500
Errors</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Find possible resolutions
to common status codes.<o:p></o:p></span></p>	

<p class=MsoNormal><span>HTTP 400 and 500 Status Codes are an important part of application
analysis, because they provide information about possible errors resulting from
an HTTP request.<o:p></o:p></span></p>

<p class=MsoNormal><span>The best known HTTP Status Code is the error code 404, which has
come into common public knowledge because of the Web. It means that a requested
page doesn't exist.<o:p></o:p></span></p>

<p class=MsoNormal><span>The first digit of the HTTP Status Code specifies one of five
classes of response. The bare minimum for an HTTP client is that it recognizes
these five classes. A first digit of 1, 2, or 3 represents a fully functional
request. A first digit of 4 represents a client-side error, with the most
common codes in the range of 400 to 404. A first digit of 5 represents a
server-side error, with the most common codes in the range of 500 to 510.
Because the codes in 400 and 500 range represent errors, they are also referred
to as HTTP Error Codes.<o:p></o:p></span></p>

<p class=MsoNormal><span>A Best Practice Recommendation for HTTP 400 and 500 Status Codes
is to do everything possible to resolve the issue causing the error. It's
important to be aware of what the various Error Codes mean so that you can
address the issues that they raise, especially if you have control over the
cause.<o:p></o:p></span></p>

<ul>
<li>On the AT&amp;T
Developer site you can read a lot more about&nbsp;<a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/http-400-and-500-error-codes"><b><span>HTTP 400 and 500 Status Codes</span></b></a><b><span>.</span></b></li>
<li>The AT&amp;T ARO
diagnostic tool specifically identifies all HTTP 400 and 500 Status Codes that
are found in an application trace.&nbsp <a href="http://developer.att.com/application-resource-optimizer"><b><span>Learn more about ARO</span></b></a>.</li>
</ul>


<h3 id="5_7_third_party_content"><b><span>5.7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Third
Party Content</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Reduce the performance
impacts.<o:p></o:p></span></p>

<p class=MsoNormal><span>Third-party scripts can provide a wide range of functionality for
an app, such as ads, widgets, analytics, and tracking software.<o:p></o:p></span></p>

<p class=MsoNormal><span>However, connecting to third-party content can create slowdowns in
a mobile app. If external files from a third party fail to load, it can have a
big effect on the user experience by slowing down or even blocking the loading
of other files.<o:p></o:p></span></p>

<ul>
<li>Weigh the value of
each third-party script against the risk of it impacting your apps performance,
and use as few as possible.</li>
<li>If you do use
third-party scripts, load them asynchronously:</li>
</ul>

<ul class="alpha">
<li>Read more about&nbsp;<a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/third-party-scripts"><b><span>Third Party Scripts</span></b></a></li>
<li>The AT&amp;T ARO diagnostic tool
can help you measure the impact of third-party scripts on your app. When ARO
analyzes an app, it tests for third-party scripts and if it identifies a file
containing 2 or more third-party scripts that are located on another domain,
the app fails the test, and the identified files are listed in the test
results.&nbsp;<a
href="http://developer.att.com/application-resource-optimizer"><b><span>Learn more about ARO</span></b></a>.</li>
</ul>

<h3 id="5_8_asynchronous_javaScript"><b><span>5.8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Asynchronous
JavaScript</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Speed up page rendering.<o:p></o:p></span></p>

<p class=MsoNormal><span>When specifying JavaScript files to be loaded in the HEAD section
of an HTML document, it's important to consider the two different ways that the
file load can occur.<o:p></o:p></span></p>

<ul>
<li>Synchronous (sync):
The file will finish loading before the parsing of the page continues.</li>
<li>Asynchronously (<span
class=SpellE>async</span>): The rest of the page will continue being parsed
while the file is downloaded.</li>
<li>Loading JavaScript files synchronously blocks other files from
being downloaded in parallel, and files downloaded in the HEAD of your HTML
will block the rendering of your HTML because the downloads must be completed
before the BODY of the HTML document is parsed.</li>
<li>A Best Practice Recommendation is to ensure that JavaScript files
in the HEAD of your HTML are loaded asynchronously so that they do not delay
the rendering of the page.</li>
<li>On the AT&amp;T Developer site you can read a lot more about&nbsp;<a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/asynchronous-load-of-javascript-in-html"><b><span>Asynchronous Loading of JavaScript in HTML</span></b></a><b><span>.</span></b></li>
<li>The AT&amp;T ARO
diagnostic tool tests HTML documents to see if there are JavaScript files in
the HEAD which are not being loaded asynchronously. If there are JavaScript
files in the HEAD not being loaded asynchronously, the test will fail and ARO
will list all of the files in the test results.&nbsp;<a
href="http://developer.att.com/application-resource-optimizer"><b><span>Learn more about ARO</span></b></a>.</li>
</ul>

<h3 id="5_9_file_compression"><b><span>5.9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File
Compression</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span class=GramE><span>Helps your app page render faster.</span></span><span><o:p></o:p></span></p>

<p class=MsoNormal><span>Compressing text files makes them smaller and faster to send. And
unzipping files on a mobile device has low overhead. So it is recommended that
you compress text files while they are being sent over wireless networks.<o:p></o:p></span></p>

<p class=MsoNormal><span>A large percentage of
mobile apps are serving text files uncompressed, which affects the app's
performance.<o:p></o:p></span></p>

<p class=MsoNormal><span>The most common
compression schemas are ‘<span class=SpellE>gzip</span>' and ‘deflate'. Major
mobile platforms support for <span class=SpellE>gzip</span> and deflate, but
implementation will differ.<o:p></o:p></span></p>

<p class=MsoNormal><span>In order to compress the files, compression needs to be supported,
and there needs to be an agreement that it's alright to exchange compressed
files. The agreement has two parts.<o:p></o:p></span></p>

<ul>
<li>The app sends a header telling the server it accepts compressed content.
Accept-Encoding: <span class=SpellE>gzip</span>, deflate</li>
<li>The server sends a response if the content is actually compressed:
Content-Encoding: <span class=SpellE>gzip</span></li>
</ul>


<p class=MsoNormal><span>If the server doesn't send the content-encoding response header,
it means the file will not be compressed, which is the default on many servers.
The &quot;Accept-encoding&quot; header is just a request, not a demand. If the
server does support compressed content, the app will accept the uncompressed
version.<o:p></o:p></span></p>

<p class=MsoNormal><span>The Best Practice
Recommendation is to compress text files whenever possible.<o:p></o:p></span></p>

<ul>
<li>Read more about&nbsp;<a
href="http://developer.att.com/application-resource-optimizer/docs/best-practices/text-file-compression"><b><span>Text File Compression</span></b></a>.</li>
<li>You can use the
AT&amp;T ARO diagnostic tool to make sure you are compressing text files
correctly. ARO runs automated tests for uncompressed text files, and if over 5%
of the text files are not compressed, the app fails this test.&nbsp;<a
href="http://developer.att.com/application-resource-optimizer"><b><span>Lean more about ARO</span></b></a>.</li>
</ul>

<h2 id="6_detailed_recommendations"><b><span>6&nbsp;&nbsp;&nbsp;Detailed
Recommendations</span></b><b><span><o:p></o:p></span></b></h2>

<h3 id="6_1_ios"><b><span>6.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iOS</span></b><b><span><o:p></o:p></span></b></h3>

<h3 id="6_1_1_asynchrony"><b><span>6.1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Asynchrony</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>An app's main thread is responsible for all activities including handling
of the system messages, input events, etc. iOS makes sure that the main thread
is always alive by a mechanism called <span class=SpellE>WatchDog</span>. This
can terminate the process if it does not respond within approximately 20
seconds. Therefore, if any synchronous operations are called, you need to be
sure that these operations can be completed as fast as possible. This becomes
critical in the mobile network environment, as network timeouts are much longer
than the <span class=SpellE>WatchDog's</span>. For example, domain name
resolution will be timed out after 30 seconds if there is no response from the
network.<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>iOS</span></span><span> APIs are designed to simplify development as much as possible,
and in most cases you don't even need to think about creating separate threads,
as everything is done transparently and asynchronously. However, some of the
methods hide synchronous networking which should be used very carefully and
only in separate threads. Apple provided a list of such methods such as:<o:p></o:p></span></p>

<ul>
<li>Utility methods:
	<ul>
    	<li>-<span class=SpellE>initWithContentsOfUrl<span
class=GramE>:encoding:error</span></span>:</li>
    	<li>+<span class=SpellE>stringWithConten-tsOfURL<span
class=GramE>:encoding:error</span></span>:</li>
    </ul>
</li>

<li>DNS:
<ul>
<li>gethostbyname</li>
<li>gethostbyaddr</li>
<li><span>NSHost</span>(only in Mac OS X)</li>
</ul>
</li>
<li>+sendSynchronousRequest<span
class=GramE>:returningResponse:error</span>:</li>

</ul>


<p class=MsoNormal><span>As explained earlier, network asynchrony is not just calling
network functions from the main thread to not block UI, but also handling
requests and responses independently from each other. This can be done by using
request queues and, although the standard iOS SDK does not provide this
functionality, there are a few third party libraries that do.<o:p></o:p></span></p>

<p class=MsoNormal><span>For example, <span class=SpellE>ASIHTTPRequest</span> library
gives rich network functionality through an Object C library by wrapping lower
level C API – <span class=SpellE>CFNetwork</span>. Some developers may even
prefer <span class=SpellE>ASIHTTPRequest</span> rather than standard Foundation
API, as it implements many additional features such as:<o:p></o:p></span></p>

<ul>
<li>Request queue</li>
<li>Simple API for sending POST requests with files attached and post values</li>
<li>Tracking progress of a single request or the whole queue with automatic update
of <span class=SpellE>UIProgressView</span></li>
<li><span class=SpellE><span class=GramE>gzip</span></span> compressed request bodies</li>
<li>Resuming interrupted downloads Section 3.2</li>
<li>Background-mode requests</li>
<li>Client certificates support Section 3.4</li>
<li>Automatic support of network indicator</li>
<li>Automatic retry</li>
<li>Persistent connections – to reuse single HTTP connections for a several small
requests</li>
</ul>

<h4><b><span>References</span></b><span><o:p></o:p></span></h4>

<h4><span class=SpellE><b><span>ASIHTTPRequest</span></b></span><b><span>&nbsp;documentation</span></b><span><o:p></o:p></span></h4>

<h4><a href="http://allseeing-i.com/ASIHTTPRequest/How-to-use">http://allseeing-i.com/ASIHTTPRequest/How-to-use</a><span><o:p></o:p></span></h4>

<h3 id="6_1_2_connection_loss_and_error_handling"><b><span>6.1.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConnectionLoss and Error Handling<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>As described in Section 3.2, it is a good idea to make your app
aware of the device connection status. If there is no connection, the app can
switch to offline mode, avoiding network errors and protecting the user
experience.<o:p></o:p></span></p>

<p class=MsoNormal><span>Apple provides sample code in the "Reachability" project (see
reference below) which can be used for detecting network status and notifying
changes. The method <span class=SpellE>reachabilityForInternetConnection</span>
would be appropriate for most of the cases.<o:p></o:p></span></p>

<p class=MsoNormal><span>If the app detects that there is no Internet connection and
offline mode should be used, then local data shall be used. The simplest
solution without building a local database would be to use standard <span
class=SpellE>NSURLRequest</span>, but with custom cache storage that supports
on-disk cache (as described in Section 5.1.3) and cache policy parameter set to
<span class=SpellE>NSURLRequestReturnCacheDataDontLoad</span>. This will avoid
pointless attempts to establish a network connection, and will return the
result immediately, if anything has been cached. The rest of the app can be
left unchanged with error handling as if it was using the network.<o:p></o:p></span></p>

<p class=MsoNormal><span>For any network request that uploads data to a server regardless
of size, for instance, uploading a picture, or updating status on a social
network, it is advisable to use the Task Completion API to ensure content is
delivered even if the user <span class=SpellE>minimises</span> the app. It is
also important to ensure entered content is not lost if the network connection
drops, and that the task can be retried without the need to re-enter the data
or retake the picture.<o:p></o:p></span></p>

<p class=MsoNormal><span>Long downloads, such as music files, digital issues of magazines
or any other large files, should be <span class=SpellE>resumable</span>. If the
server and the content support HTTP partial download, the request for restoring
the download from any part of the file can be initiated by adding the HTTP
Range header:<o:p></o:p></span></p>

<p class=MsoNormal><span>// Requests part of file
starting from 1024th byte<o:p></o:p></span></p>

<p class=MsoNormal><span>[<span class=SpellE>URLRequest</span>
<span class=SpellE>setValue</span>: @&quot;bytes=1024-&quot; <span
class=SpellE>forHTTPHeaderField</span>: @&quot;Range&quot;];<o:p></o:p></span></p>

<p class=MsoNormal><b><span>References</span></b><span><o:p></o:p></span></p>

<p class=MsoNormal><b><span>Reachability</span></b><span><o:p></o:p></span></p>

<h5><a
href="http://developer.apple.com/library/ios/samplecode/Reachability/"><span>http://developer.apple.com/library/ios/samplecode/Reachability/</span></a><span><o:p></o:p></span></h5>

<p class=MsoNormal><b><span>Network reachability</span></b><span><o:p></o:p></span></p>

<h5><a href="http://blog.ddg.com/?p=24"><span>http://blog.ddg.com/?p=24</span></a><span><o:p></o:p></span></h5>

<h3 id="6_1_3_caching"><b><span>6.1.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Caching</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>The Foundation framework provides simple to use cache management,
giving developers control over what can be cached and where. Standard <span
class=SpellE>NSURLCache</span> is very limited, although the full Mac OS X2
version supports on-disk and on-memory caches, the iOS version can store only
in memory. Furthermore, by default the capacity of memory cache gets set to
zero, meaning that even memory cache will not work if it is not enabled
explicitly.<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>A simple test shows that memory capacity is set
to zero by <span class=SpellE>WebView</span> (even if it is not used in the UI)
from a separate thread.</span></span><span>
To make matters worse, the point at which this happens is not documented. A
simple and reliable workaround is to subclass <span class=SpellE>NSURLCache</span>
and redefine method <span class=SpellE>setMemoryCapacity</span> which will
ignore all calls with value 0 and will pass through all other values to the
original method.<o:p></o:p></span></p>

<p class=MsoNormal><span>Example<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>-(</span></span><span>void)<span class=SpellE>setMemoryCapacity</span>:(<span
class=SpellE>NSUInteger</span>)<span class=SpellE>memoryCapacity</span> {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=GramE>if</span> (<span class=SpellE>memoryCapacity</span> == 0) {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>return</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; [<span
class=GramE>super</span> <span class=SpellE>setMemoryCapacity:memoryCapacity</span>];<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>The standard class <span
class=SpellE>NSURLRequest</span> includes a parameter <span class=SpellE>cachePolicy</span>
that can retrieve the following values:<o:p></o:p></span></p>

<ul>
<li>NSURLRequestUseProtocolCachePolicy – the default cache policy for the protocol that is being used for the particular URL request. Suitable for most of the cases in online mode</li>
<li>NSURLRequestRelaodIgnoringCacheData – ignores any local cache and will try to load data from the originating source. Suitable for online mode and for certain use cases, when data should not be cached, for example, for keep-alive connections</li>
<li>NSURLRequestReturnCacheDataElseLoad – returns data from cache even if it is expired. If there is no cached version, then it will try to download the data from the originating source. Suitable for certain types of content such as static photos</li>
<li>NSURLRequestReturnCacheDataDontLoad – returns data only if it has been stored in local cache and does not attempt to retrieve it from the origination source if there is no cached version. Suitable for offline mode</li>
</ul>


<p class=MsoNormal><span>Example:<o:p></o:p></span></p>

<p class=MsoNormal><span>// <span class=GramE>Creating</span>
URL request<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span>NSURLRequest</span></span><span> *<span class=SpellE>theRequest</span> = [<span class=SpellE>NSURLRequest</span>
<span class=SpellE>requestWithUrl</span>:<br>
&nbsp;&nbsp;&nbsp; [NSURL <span class=SpellE>URLWithString</span>:@"http://www.hudriks.com/example.html"]<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=SpellE><span class=GramE>cachePolicy:</span>NSUrlRequestUseProtocolCachePolicy</span><o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=GramE>timeoutInterval:</span>60.0];<o:p></o:p></span></p>

<p class=MsoNormal><span>// Initiation the
connection with the request<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span>NSURLConnection</span></span><span> *<span class=SpellE>theConnection</span> = [[<span class=SpellE>NSURLConnection</span>
<span class=SpellE>alloc</span>]<br>
&nbsp;&nbsp;&nbsp; <span class=SpellE>initWithRequest<span class=GramE>:theRequest</span></span>
<span class=SpellE>delegate:self</span>];<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>if</span></span><span> (<span class=SpellE>theConnection</span>) {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; // <span
class=GramE>Prepare</span> for receiving the data<o:p></o:p></span></p>

<p class=MsoNormal><span>} else {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; //
Handle the error<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<p class=MsoNormal><span>The framework also allows the response to be altered before it
gets stored into local cache by implementing <span class=SpellE>connection<span
class=GramE>:willCacheResponse</span></span>:. Usually, this method is used to
avoid caching of some private data, and some implementations do not cache any
traffic that goes through encrypted protocols such as HTTPS.<o:p></o:p></span></p>

<p class=MsoNormal><span>If in-memory cached is used, it would be reasonable to clean up
the cached data if the application receives a<span class=GramE>&nbsp; memory</span>
warning.<o:p></o:p></span></p>

<p class=MsoNormal><span>Currently, the standard <span class=SpellE>NSURLCache</span> does
not support all features of HTTP cache such as conditional HTTP request
headers, for instance, "If-None-Match", "If-Modified-Since", described in
Section 3.3.<o:p></o:p></span></p>

<p class=MsoNormal><span>Although, the default <span class=SpellE>NSURLCache</span> is very
limited and cannot help much for implementing offline mode, the API still gives
a solid framework that can be used for simple integration of your own implementation
of cache or subclass of <span class=SpellE>NSURLCache</span> class.<o:p></o:p></span></p>

<p class=MsoNormal><span>There are a few
implementations of custom cache classes, for example:<o:p></o:p></span></p>

<ul>
<li>SDURLCache – subclass of NSURLCache with on-disk cache support</li>
</ul>


<h3><b><span>6.1.3.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cache
in Web Applications<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Key facts from Yahoo!'s research into how mobile Safari works on
the iPhone regarding caching can be used for designing and implementing web
applications:<o:p></o:p></span></p>

<p class=MsoNormal><a href="http://yuiblog.com/blog/2008/02/06/iphone-cacheability/" target="_blank"><span>http://yuiblog.com/blog/2008/02/06/iphone-cacheability/</span></a><o:p></o:p></p>

<p class=MsoNormal><span>In order to be cached by
Safari, the HTTP content should include either "Expires" or "Cache-Control"
header.<o:p></o:p></span></p>

<p class=MsoNormal><span>Expires: &lt;Expiration
time in GMT Format&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span>Cache-Control: max-age =
&lt;Expiration time in seconds&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span>The browser's cache applies a limit to the cacheable content,
which should not be larger than 25 KB (or 15 KB according to the latest tests)
of uncompressed data. Even if it is transferred using HTTP compression, the
browser will still <span class=SpellE>uncompress</span> it before trying to put
it into cache. This means, that the correct distribution of content over small
files and the <span class=SpellE>minimisation</span> of each file,
particularly, JavaScript, CSS and HTML, becomes highly important for the
performance of mobile web applications.<o:p></o:p></span></p>

<h3 id="6_1_4_references"><b><span>6.1.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;References</span></b><b><span><o:p></o:p></span></b></h3>

<h4><span class=SpellE><b><span>SDURLCache</span></b></span><b><span> class</span></b><span><o:p></o:p></span></h4>

<h5><a href="https://github.com/rs/SDURLCache"><span>https://github.com/rs/SDURLCache</span></a><span><o:p></o:p></span></h5>

<h4><b><span>URL Loading System
Programming Guide</span></b><span><o:p></o:p></span></h4>

<h5><a
href="https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/URLLoadingSystem/URLLoadingSystem.html"><span>https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/URLLoadingSystem/URLLoadingSystem.html</span></a><span><o:p></o:p></span></h5>

<h3 id="6_1_5_security"><b><span>6.1.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Security</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Although the iOS operating system is based on Mac OS X and most of
the security has been inherited from there, because of the differences in the
usage there are some discrepancies in the APIs and security models.<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>iOS</span></span><span> security is based on three main services in the
Core Services layer, which are:<o:p></o:p></span></p>

<ul>
<li>Keychain Services – secure storage of passwords, keys, certificates and other secrets</li>
<li>Certificate, Key and Trust Services – creating and managing certificates, creating encryption keys, encryption and decryption of data, signing and verification of digital signatures</li>
<li>Randomisation Services – cryptographically secure pseudorandom numbers</li>
</ul>

<p class=MsoNormal><span>On a higher level, <span class=SpellE>CFNetwork</span> and subsequently
URL Loading System use these services, for instance for providing secure
transport protocols and supporting SSL and HTTPS connections.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_118"
 o:spid="_x0000_i1043" type="#_x0000_t75" alt="clip_image036" style='width:443.25pt;
 height:186pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image015.gif"
  o:title="clip_image036"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=591 height=248
src="SAG_files/image015.gif"
alt="clip_image036" v:shapes="Picture_x0020_118"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 14</span></b><span>:
<span class=SpellE>CFNetwork</span> Component Diagram<o:p></o:p></span></p>

<p class=MsoNormal><span>Keychain Services in iOS has a major difference from the Mac OS X
version. In Mac OS X, Keychain securely saves passwords and if an application
requests information, the user is asked to give permission by entering his
password.<o:p></o:p></span></p>

<p class=MsoNormal><span>In iOS the device is already secured by PIN number, and, therefore
the user is not asked to enter any passwords or confirmations. However,
Keychain allows access only to signed <span class=GramE>apps,</span> each has
individual storage and cannot access information from any other applications.<o:p></o:p></span></p>

<p class=MsoNormal><span>As mentioned earlier, URL Loading System supports the HTTPS
protocol by default, so developers do not need to put any extra effort in
establishing a secure connection with the server (if the server also supports
HTTPS).<o:p></o:p></span></p>

<p class=MsoNormal><span>Apple has also done a great job in supporting developers and we
highly recommend that you take note of the following documents from the Apple
Developer Network:<o:p></o:p></span></p>

<ul>
<li>Secure Coding Guide: covers all aspects of security, not only network security. Explains in detail topics such as buffer overflow, stack overflow, input validation, how these can be used by attackers to run malicious code and how this can be avoided. The design of secure user interface is also touched on in the document which explains that security should not compromise usability of an app ¦</li>
<li>Security Overview: gives more details about cryptography and secure APIs in iOS and Mac OS X</li>
<li>Keychain Services Programming Guide: contains a section related to keychain services in iOS and gives guidance about how the relevant APIs should be used</li>
<li>Certificate, Key, and Trust Services Programming Guide: Explains how the APIs for managing and using certificates and encryption/decryption of the data should be used.</li>
</ul>



<h3 id="6_1_6_push_notification"><b><span>6.1.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P</span></b><b><span>ush Notifications<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Apple Push Notification service (APNs) is a robust and highly
efficient service for propagating information from the cloud to iOS devices.
Each device establishes an accredited and encrypted connection with the service
and receives notifications over this persistent connection. Apps are notified
about information waiting for them on their back end servers, and expected to
pull this information from the server. If the app is not running, notification
is handled through the UI and alerts the user to launch the app.<o:p></o:p></span></p>

<p class=MsoNormal><span>More details on APNs are
available at:<o:p></o:p></span></p>

<p class=MsoNormal><a
href="https://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Introduction/Introduction.html"><span>https://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Introduction/Introduction.html</span></a><span><o:p></o:p></span></p>

<h3 id="6_1_7_data_formats"><b><span>6.1.7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Data&nbsp;</span></b><b><span>Formats<o:p></o:p></span></b></h3>

<h3><b><span>6.1.7.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JSON<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>JSON is very popular
these days and some web sites provide access to their APIs only using JSON
rather than XML.<o:p></o:p></span></p>

<p class=MsoNormal><span>The most widely used Objective-C JSON parsers are YAJL, JSON
Framework and Touch JSON (see references below). Each has its own advantages
and disadvantages.<o:p></o:p></span></p>

<p class=MsoNormal><span>YAJL is sequential access parser which is similar to SAX parser
for XML. As it does not need to keep all data in memory, the obvious advantages
are low memory footprint and parsing speed which would be suitable for huge
amounts of data or even streams of data.<o:p></o:p></span></p>

<p class=MsoNormal><span>The Touch JSON library shows good results in speed benchmark and
it has a very simple to use API. For example, to parse JSON into <span
class=SpellE>NSDictionary</span> object, the code looks like this:<o:p></o:p></span></p>

<p class=MsoNormal><span>SBJSON *<span
class=SpellE>jsonParser</span> = [[SBJSON new] <span class=SpellE>autorelease</span>];<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span>NSString</span></span><span>
*<span class=SpellE>jsonString</span> = ...;<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>return</span></span><span> [<span class=SpellE>jsonParser</span> <span
class=SpellE>objectWithString:jsonString</span> <span class=SpellE>error:NULL</span>];<o:p></o:p></span></p>

<p class=MsoNormal><span>It can be even simpler
by using <span class=SpellE>NSString</span> extensions:<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span>NSString</span></span><span>
*<span class=SpellE>jsonString</span> = ...;<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>return</span></span><span> [<span class=SpellE>jsonString</span> <span
class=SpellE>JSONValue</span>];<o:p></o:p></span></p>

<p class=MsoNormal><span>Encoding to JSON can be
done by <span class=SpellE>NSObject</span> extension:<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span>NSString</span></span><span>
*<span class=SpellE>jsonString</span> = ...;<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span>NSDictionary</span></span><span> *data = ...;<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span class=GramE><span>jsonString</span></span></span><span> = [data <span class=SpellE>JSONRepresentation</span>];<o:p></o:p></span></p>

<h3><b><span>6.1.7.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XML<o:p></o:p></span></b></h3>

<p class=MsoNormal><span class=GramE><span>iOS</span></span><span> SDK provides only the event-driven XML parser <span class=SpellE>NSXMLParser</span>
which works in the same way as the SAX parser, but instead of callback
functions it sends messages to its delegate:<o:p></o:p></span></p>

<ul>
<li>parser:didStartElement:namespaceURI:qualifiedName:attributes:</li>
<li>parser:foundCharacters:</li>
<li>parser:didEndElement:namespaceURI:qualifiedName:</li>
</ul>

<p class=MsoNormal><span>There is also an alternative third party event-driven XML parser
called <span class=SpellE>AQXMLParser</span> that gives considerable memory
savings.<o:p></o:p></span></p>

<p class=MsoNormal><span>If the app needs a tree-based parser, despite memory consumption,
it is possible to use the libxml2 library that is already included on the <span
class=GramE>iPhone,</span> however, it is a pure-C interface. The other
alternative might be using Objective-C Touch XML framework which is a wrapper
for the libxml2 library.<o:p></o:p></span></p>

<p class=MsoNormal><span>As a rule of thumb, light-weight protocols should be used as they
are much more suited to the mobile environment. A good example is using REST
where possible instead of SOAP as REST protocols are much more suited to the
mobile environment.<o:p></o:p></span></p>

<h4><b><span>References</span></b><span><o:p></o:p></span></h4>

<h4><b><span>YAJL</span></b><span><o:p></o:p></span></h4>

<h5><a href="http://github.com/gabriel/yajl-objc"><span>http://github.com/gabriel/yajl-objc</span></a><span><o:p></o:p></span></h5>

<h4><b><span>JSON Framework</span></b><span><o:p></o:p></span></h4>

<h5><a href="http://github.com/stig/json-framework"><span>http://github.com/stig/json-framework</span></a><span><o:p></o:p></span></h5>

<h4><b><span>Touch JSON</span></b><span><o:p></o:p></span></h4>

<h5><a href="http://github.com/TouchCode/TouchJSON"><span>http://github.com/TouchCode/TouchJSON</span></a><span><o:p></o:p></span></h5>

<h4><span class=SpellE><b><span>AQXMLParser</span></b></span><span><o:p></o:p></span></h4>

<h5><a href="http://github.com/AlanQuatermain/aqtoolkit"><span>http://github.com/AlanQuatermain/aqtoolkit</span></a><span><o:p></o:p></span></h5>

<h4><b><span>Touch XML</span></b><span><o:p></o:p></span></h4>

<h5><a href="http://github.com/TouchCode/TouchXML"><span>http://github.com/TouchCode/TouchXML</span></a><span><o:p></o:p></span></h5>

<h3 id="6_1_8_compression"><b><span>6.1.8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compression</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span class=GramE><span>iOS</span></span><span> supports compression (<span class=SpellE>gzip</span> and deflate)
by default and automatically adds "Accept-Encoding" header to all requests and
then decompresses the response. This increases the efficiency of data traffic.<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span>ASIHTTPRequest</span></span><span> library supports <span class=SpellE>gzip</span> only.<o:p></o:p></span></p>

<h3 id="6_1_9_background_foreground_modes"><b><span>6.1.9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Background
/ Foreground&nbsp;</span></b><b><span>Modes<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>With version 4, iOS started supporting multitasking on almost all
devices apart from the iPhone 2G, iPhone 3G and corresponding models of the
iPod Touch. However, the iOS version is not the same as the multitasking that
developers are used to on desktop operating systems. The main difference is
that iOS multitasking limits background activities due to the limited resources
of the mobile device and the different usage of mobile apps.<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>iOS</span></span><span> gives developers seven different background
services that can be implemented in apps:<o:p></o:p></span></p>

<ul>
<li>Fast application switching – suspending the app with preservation of its state and quick resume</li>
<li>Push notifications – delivery of backend information to an app not currently running in foreground mode</li>
<li>Local notifications – scheduling of delivery of push-style notifications while an app is suspended or closed</li>
<li>Background audio – playing audio content through the unified playback system on the device while an app is in background mode</li>
<li>Task completion – gives extra time to complete a task in background</li>
<li>Location and navigation – tracking the location changes</li>
<li>Voice over IP – making and receiving calls using an Internet connection</li>
</ul>

<p class=MsoNormal><span>Almost all these services may involve network activities (apart
from fast application switching and local notifications), and extra care should
be taken to not reduce device battery performance or overload the network.<o:p></o:p></span></p>

<p class=MsoNormal><span>Push notification is a well <span class=SpellE>optimised</span>
technology compared to polling data. However, if not used carefully, it can
cause problems in the network, mainly related to simultaneous broadcast of
notifications to many devices (latest news, promotional offers, etc.).<o:p></o:p></span></p>

<p class=MsoNormal><span>Other background services such as background audio, task
completion, location and navigation and VoIP can be used for establishing
frequent network connections, and can therefore drain the battery very quickly.
The general advice here is to consider which data requires immediate delivery
and which can be aggregated with its delivery postponed.<o:p></o:p></span></p>

<p class=MsoNormal><span>The Task Completion API gives some flexibility for developers to
run almost any code, however, the intention is to give the app extra time to
finish activities initiated while the app is in background mode. As soon as
these are complete, the app can be suspended without using any resources.<o:p></o:p></span></p>

<p class=MsoNormal><span>This can be very useful for network operations that may take a
long time or require a certain level of reliability, for instance uploading
pictures, or sending a text message/email. To start a connection in background
mode, method <span class=SpellE>beginBackgroundTaskWithExpirationHandler</span>:
in <span class=SpellE>UIApplication</span> should be called and when the
activity is finished or it has failed, then <span class=SpellE>endBackgroundTask</span>:
should be called iOS.<o:p></o:p></span></p>

<p class=MsoNormal><span>However, if the Task Completion API is not used, then the corresponding
delegates for <span class=SpellE>NSURLConnection</span> are still called after
resuming the app. If this happens within the network timeout (by default, 60
seconds), then the response may still be delivered, otherwise, delegate <span
class=SpellE>didFailWithError</span>: is called.<o:p></o:p></span></p>

<h3><b><span>6.1.9.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Backward
Compatibility<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>As multitasking is not supported on the iPhone 3G and 2G and the
iPod Touch 1st and 2nd generations, even if they have iOS 4 installed, it is
important to check if an app can use the corresponding APIs on the device.<o:p></o:p></span></p>

<p class=MsoNormal><span>This can be done as
follows:<o:p></o:p></span></p>

<p class=MsoNormal><span>[[<span class=SpellE>UIDevice</span>
<span class=SpellE>currentDevice</span>] <span class=SpellE>isMultitaskingSupported</span>]<o:p></o:p></span></p>

<p class=MsoNormal><span>Or<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>if(</span></span><span>[<span class=SpellE>someObject</span> <span
class=SpellE>respondsToSelector</span>: @selector(<span class=SpellE>methodForMultitasking</span>))
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; ! [<span
class=SpellE><span class=GramE>someObject</span></span> <span class=SpellE>methodForMultitasking</span>];<o:p></o:p></span></p>

<p class=MsoNormal><span>} else {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; //
...<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<h3><b><span>6.1.9.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Network
Usage<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>In order to maintain connections in VoIP applications, iOS
provides a mechanism to set a <span class=SpellE>keepalive</span> handler with <span
class=SpellE>setKeepAliveTimeout<span class=GramE>:handler</span></span>: on <span
class=SpellE>UIApplication</span>, which will be called automatically by the
system. The minimum interval is 10 <span class=GramE>minutes,</span> however,
using slightly less than 30 minutes seems to be the most optimal for <span
class=SpellE>maximising</span> battery life.<o:p></o:p></span></p>

<p class=MsoNormal><span>The operating system does not guarantee that <span class=SpellE>keepalive</span>
handler will be called exactly at the requested time, as it performs various <span
class=SpellE>optimisations</span> for waking up the system and aligning several
timers to be triggered simultaneously.<o:p></o:p></span></p>

<p class=MsoNormal><span>To ensure optimal use of resources, apps should share a TCP
connection where possible.&nbsp; Therefore, a single TCP session should be used
for all communication but if this is not possible, no more than four TCP
connections should be used at any one time.<o:p></o:p></span></p>

<p class=MsoNormal><span>Similarly, apps should not keep connections open when they have
completed their task(s). All TCP sessions should be torn down correctly with
FINs and should not be left in an undetermined state. This removes the need for
a persisting state in the mobile (memory/battery) and in the network.<o:p></o:p></span></p>

<h3><b><span>6.1.9.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Device
States<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Apart from supporting multitasking, the app should also be aware
of different states, such as <span class=GramE>screen</span> lock/unlock,
switching to phone call and back. In the main, this can be done by handling <span
class=SpellE>applicationDidBecomeActive</span><span class=GramE>:,</span> <span
class=SpellE>applicationWillResignActive</span>:. If there are any heavy
operations that use the device's resources (graphics, network), then it would
be better to suspend them if possible.<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>iOS</span></span><span> also allows the app to prevent the device from going to sleep
mode as follows<o:p></o:p></span></p>

<p class=MsoNormal><span>[[<span class=SpellE>UIApplication</span>
<span class=SpellE>sharedApplication</span>] <span class=SpellE>setIdleTimerDisabled</span>:
YES]<o:p></o:p></span></p>

<p class=MsoNormal><span>If the app accesses the network using the Wi-Fi connection and
needs to be connected even when the device is in sleep mode, the <span
class=SpellE>UIRequiresPersistentWiFi</span> key must be included in the app's <span
class=SpellE>Info.plist</span> file. The inclusion of this key lets the system
know that it should display the network selection dialogue if it detects any
active Wi-Fi hot spots. It also lets the system know that it should not attempt
to shut down the Wi-Fi hardware while your app is running. Without this key,
any Wi-Fi connectivity will be disconnected after a while.<o:p></o:p></span></p>

<h3><b><span>6.1.9.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;References
Audio Session in Screen Lock<o:p></o:p></span></b></h3>

<h5><a
href="https://developer.apple.com/library/ios/#documentation/Audio/Conceptual/AudioSessionProgrammingGuide/Introduction/Introduction.html"><span>https://developer.apple.com/library/ios/#documentation/Audio/Conceptual/AudioSessionProgrammingGuide/Introduction/Introduction.html</span></a><span><o:p></o:p></span></h5>

<h3 id="6_1_10_scheduling"><b><span>6.1.10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scheduling</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Scheduling the network activities of a third party app in synch
with requests from other third party apps is not supported on iOS.<o:p></o:p></span></p>

<h3 id="6_2_android"><b><span>6.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Android™</span></b><b><span><o:p></o:p></span></b></h3>

<h3 id="6_2_1_asynchrony"><b><span>6.2.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Asynchrony</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Section 2.2.1 sets out the generic principles surrounding the use
of asynchrony to enhance user experience during network activity. These
principles are as applicable to Android as to other platforms.<o:p></o:p></span></p>

<p class=MsoNormal><span>The speed and efficiency of a long-running, data-intensive
operation often improves when you split it into smaller operations running on
multiple threads. On a device that has a CPU with multiple processors (cores),
the system can run the threads in parallel, rather than making each
sub-operation wait for a chance to run. For example, decoding multiple image
files in order to display them on a thumbnail screen runs substantially faster
when you do each decode on a separate thread.<o:p></o:p></span></p>

<p class=MsoNormal><span>It may be worthwhile
extending the technique slightly to introduce some notion of "throttling" to
avoid fully saturating the available bandwidth. This will improve the overall
user experience (by allowing network requests from other parts of the UI to be
met) and improve resilience to adverse network conditions (a fully saturated
connection is more likely to lead to failed requests).<o:p></o:p></span></p>

<h3><b><span>6.2.1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementation
Details<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Android implements the
subset of the Apache Http APIs <span class=SpellE>org.apache.http</span> to
support network activity using the "blocking" I/O model. Non-blocking I/O <span
class=SpellE>org.apache.http.impl.nio</span> is not supported at present, so
apps need to implement asynchrony using standard Java constructs and the
supporting classes provided by the Android framework.<o:p></o:p></span></p>

<p class=MsoNormal><span>Figure 14 shows the classes required to support asynchrony in a
simple Android app that fetches and displays a bitmap from the network in
response to a button press. It consists of two activities <span class=SpellE>MainActivity</span>,
<span class=SpellE>ShowBitmapActivity</span> and a helper class <span
class=SpellE>AsyncHttpReq</span>.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_96"
 o:spid="_x0000_i1042" type="#_x0000_t75" alt="clip_image038" style='width:444pt;
 height:296.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image016.gif"
  o:title="clip_image038"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=592 height=395
src="SAG_files/image016.gif"
alt="clip_image038" v:shapes="Picture_x0020_96"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><!--[if mso & !supportInlineShapes & supportFields]><span
style='mso-element:field-begin;mso-field-lock:yes'></span><span
style='mso-spacerun:yes'> </span>SHAPE <span
style='mso-spacerun:yes'> </span>\* MERGEFORMAT <span style='mso-element:field-separator'></span><![endif]--><!--[if gte vml 1]><v:rect
 id="Rectangle_x0020_95" o:spid="_x0000_s1029" alt="Anchor" style='width:24pt;
 height:24pt;visibility:visible;mso-wrap-style:square;mso-left-percent:-10001;
 mso-top-percent:-10001;mso-position-horizontal:absolute;
 mso-position-horizontal-relative:char;mso-position-vertical:absolute;
 mso-position-vertical-relative:line;mso-left-percent:-10001;mso-top-percent:-10001;
 v-text-anchor:top' o:gfxdata="UEsDBBQABgAIAAAAIQC2gziS/gAAAOEBAAATAAAAW0NvbnRlbnRfVHlwZXNdLnhtbJSRQU7DMBBF
90jcwfIWJU67QAgl6YK0S0CoHGBkTxKLZGx5TGhvj5O2G0SRWNoz/78nu9wcxkFMGNg6quQqL6RA
0s5Y6ir5vt9lD1JwBDIwOMJKHpHlpr69KfdHjyxSmriSfYz+USnWPY7AufNIadK6MEJMx9ApD/oD
OlTrorhX2lFEilmcO2RdNtjC5xDF9pCuTyYBB5bi6bQ4syoJ3g9WQ0ymaiLzg5KdCXlKLjvcW893
SUOqXwnz5DrgnHtJTxOsQfEKIT7DmDSUCaxw7Rqn8787ZsmRM9e2VmPeBN4uqYvTtW7jvijg9N/y
JsXecLq0q+WD6m8AAAD//wMAUEsDBBQABgAIAAAAIQA4/SH/1gAAAJQBAAALAAAAX3JlbHMvLnJl
bHOkkMFqwzAMhu+DvYPRfXGawxijTi+j0GvpHsDYimMaW0Yy2fr2M4PBMnrbUb/Q94l/f/hMi1qR
JVI2sOt6UJgd+ZiDgffL8ekFlFSbvV0oo4EbChzGx4f9GRdb25HMsYhqlCwG5lrLq9biZkxWOiqY
22YiTra2kYMu1l1tQD30/bPm3wwYN0x18gb45AdQl1tp5j/sFB2T0FQ7R0nTNEV3j6o9feQzro1i
OWA14Fm+Q8a1a8+Bvu/d/dMb2JY5uiPbhG/ktn4cqGU/er3pcvwCAAD//wMAUEsDBBQABgAIAAAA
IQAAsebOvQIAAMgFAAAOAAAAZHJzL2Uyb0RvYy54bWysVN1u0zAUvkfiHSzfZ0k69yfR0qlrGoQ0
YGLwAG7iNBaOHWy36UC8O8dO27XbDQJ8YR2fY3/n7/O5ud23Au2YNlzJDMdXEUZMlqricpPhr1+K
YIaRsVRWVCjJMvzEDL6dv31z03cpG6lGiYppBCDSpH2X4cbaLg1DUzaspeZKdUyCsVa6pRaOehNW
mvaA3opwFEWTsFe66rQqmTGgzQcjnnv8umal/VTXhlkkMgyxWb9rv6/dHs5vaLrRtGt4eQiD/kUU
LeUSnJ6gcmop2mr+CqrlpVZG1faqVG2o6pqXzOcA2cTRi2weG9oxnwsUx3SnMpn/B1t+3D1oxKsM
J9ApSVvo0WeoGpUbwVAyxqhipoSCLWTZKO3q1XcmhWeP3YN2GZvuXpXfDJJq2cArtjAdvAcuANxR
pbXqG0YrCDx2EOEFhjsYQEPr/oOqIAC6tcpXc1/r1vmAOqG9b9rTqWlsb1EJyuuIzCJobQmmg+w8
0PT4uNPGvmOqRU7IsIboPDjd3Rs7XD1ecb6kKrgQoKepkBcKwBw04BqeOpsLwrf5ZxIlq9lqRgIy
mqwCEuV5sCiWJJgU8XScX+fLZR7/cn5jkja8qph0bo6Ui8mftfRA/oEsJ9IZJXjl4FxIRm/WS6HR
jgLlC798ycHyfC28DMPXC3J5kVI8ItHdKAmKyWwakIKMg2QazYIoTu6SSUQSkheXKd1zyf49JdQD
G8ejse/SWdAvcov8ep0bTVtuYagI3mYYqAHLXaKpY+BKVl62lItBPiuFC/+5FNDuY6M9Xx1FB/av
VfUEdNUK6ATMg/EHAvyOHxj1MEoybL5vqWYYifcSKJ/EhLjZ4w9kPB3BQZ9b1ucW6j9ahi1Gg7i0
w7zadppvGvAU+8JItYBvUnNPYfeFhqgOnwvGhc/kMNrcPDo/+1vPA3j+GwAA//8DAFBLAwQUAAYA
CAAAACEATKDpLNgAAAADAQAADwAAAGRycy9kb3ducmV2LnhtbEyPQUvDQBCF74L/YRnBi9iNIlJi
NkUKYhGhmGrP0+yYBLOzaXabxH/fqR70MsPjDW++ly0m16qB+tB4NnAzS0ARl942XBl43zxdz0GF
iGyx9UwGvinAIj8/yzC1fuQ3GopYKQnhkKKBOsYu1TqUNTkMM98Ri/fpe4dRZF9p2+Mo4a7Vt0ly
rx02LB9q7GhZU/lVHJyBsVwP283rs15fbVee96v9svh4MebyYnp8ABVpin/HcMIXdMiFaecPbINq
DUiR+DPFu5uL2v1unWf6P3t+BAAA//8DAFBLAQItABQABgAIAAAAIQC2gziS/gAAAOEBAAATAAAA
AAAAAAAAAAAAAAAAAABbQ29udGVudF9UeXBlc10ueG1sUEsBAi0AFAAGAAgAAAAhADj9If/WAAAA
lAEAAAsAAAAAAAAAAAAAAAAALwEAAF9yZWxzLy5yZWxzUEsBAi0AFAAGAAgAAAAhAACx5s69AgAA
yAUAAA4AAAAAAAAAAAAAAAAALgIAAGRycy9lMm9Eb2MueG1sUEsBAi0AFAAGAAgAAAAhAEyg6SzY
AAAAAwEAAA8AAAAAAAAAAAAAAAAAFwUAAGRycy9kb3ducmV2LnhtbFBLBQYAAAAABAAEAPMAAAAc
BgAAAAA=
" filled="f" stroked="f">
 <o:lock v:ext="edit" aspectratio="t"/>
 <w:wrap type="none"/>
 <w:anchorlock/>
</v:rect><![endif]--><!--[if mso & !supportInlineShapes & supportFields]><v:shape
 id="_x0000_i1041" type="#_x0000_t75" style='width:24pt;height:24pt'>
 <v:imagedata croptop="-65520f" cropbottom="65520f"/>
</v:shape><span style='mso-element:field-end'></span><![endif]--><b><span>Figure 15</span></b><span><span>:
Asynchrony example</span></span><span><o:p></o:p></span></p>

<p class=MsoNormal><span>Figure 15 shows the execution sequence of the app. <span
class=GramE>Broadly</span> speaking this has five phases, each of which runs
asynchronously with each other.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_94"
 o:spid="_x0000_i1040" type="#_x0000_t75" alt="Description: AsynchronySequenceDiagramSimplified"
 style='width:414pt;height:405.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image017.jpg"
  o:title=" AsynchronySequenceDiagramSimplified"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=552 height=541
src="SAG_files/image017.jpg"
alt="Description: AsynchronySequenceDiagramSimplified" v:shapes="Picture_x0020_94"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 16</span></b><span>:
Asynchrony example – Sequence diagram<o:p></o:p></span></p>

<p class=MsoNormal><span>Each phase illustrates a different aspect of asynchrony:<o:p></o:p></span></p>

<ul>
<li>The application's MainActivity class is responsible for creating the initial UI (including a button click listener).  More importantly it creates an instance of Handler that will be used to receive asynchronously coarse-grained  status messages during the course of the HTTP request</li>
<li>The button listener's onClick method is invoked asynchronously when the user presses the button. At this point an instance of AsyncHttpReq is constructed and its Thread is started. Sometime later the Thread associated with the AsyncHttpReq will run. It sends a message back to the handler to indicate that processing of the request has begun. A further message is sent with the result when the request is complete (or times out). These messages are sent asynchronously</li>
<li>HTTP activity uses the blocking APIs and may take some time to complete depending on network conditions and image size</li>
<li>When the handler receives a message indicating that the request has been successful it starts the UI to display the bitmap</li>
</ul>


<p class=MsoNormal><span>This example does not implement throttling, as each request will
be processed as soon as the associated <span class=GramE>Thread</span> is run, potentially
saturating the available bandwidth. In its simplest form throttling could be
implemented using a queue and limiting the number of simultaneously active
requests.<o:p></o:p></span></p>

<p class=MsoNormal><span>After Android 1.5 a lightweight method is introduced by the
platform to simplify the task. A utility class called <span class=SpellE>AsyncTask</span>
is written to provide a simple way to achieve background processing, without
worrying too much about the low-level details (threads, message loops etc.). It
provides call-back methods that help to schedule tasks and also to easily
update the UI whenever required – demonstrated in the article "Painless
Threading" (see below).<o:p></o:p></span></p>

<p class=MsoNormal><span>However, please bear in mind that <span class=SpellE>AsyncTask</span>
is a lightweight solution with some limits:<o:p></o:p></span></p>

<ul>
<li>AsyncTask uses a static internal work queue with a hard-coded limit of 10 elements. Trying to download 30 images from the server, for example, would cause the work queue to quickly overflow and many tasks would get rejected
<ul>
<li>AsyncTask can't survive its Activity being torn down by the OS and recreated. If this behavior is not desired, it is recommended to use a Service instead. AsyncTask is meant to be used for short operations of around a few seconds only</li>
</ul>
</li>
<li>It is not possible to interact with background thread and exceptions are not well handled</li>
<li>AsyncTask uses a static internal work queue with a hard-coded limit of 10 elements. Trying to download 30 images from the server, for example, would cause the work queue to quickly overflow and many tasks would get rejected
<ul>
	<li>AsyncTask can't survive its Activity being torn down by the OS and recreated. If this behavior is not desired, it is recommended to use a Service instead. AsyncTask is meant to be used for short operations of around a few seconds only</li>
</ul>
</li>
<li>It is not possible to interact with background thread and exceptions are not well handled</li>
</ul>



<h4><b><span>References</span></b><span><o:p></o:p></span></h4>

<h4><b><span>Painless Threading</span></b><span><o:p></o:p></span></h4>

<h5><a href="http://android-developers.blogspot.com/2009/05/painless-threading.html"><span>http://android-developers.blogspot.com/2009/05/painless-threading.html</span></a><span><o:p></o:p></span></h5>

<h3><b><span>6.2.1.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Non-Blocking
User Interface<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Unresponsive user interfaces are perhaps the most common cause of
user frustration with a particular app. With Android, unavoidable delays and
unresponsive applications typically lead to a blocked UI.<o:p></o:p></span></p>

<h3><b><span>6.2.1.2.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unavoidable
Delays<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>It is quite common for an <span class=SpellE>app</span> to be
faced with unavoidable delays, for instance when downloading large files from
the network or processing large images. However even when a delay is
unavoidable the app should try to ensure that the UI is not blocked.<o:p></o:p></span></p>

<p class=MsoNormal><span>Android provides some UI widgets to help improve the user
experience during these delays. When the delay is known to be brief (less than
five seconds, for instance) it is acceptable to use the <span class=SpellE>ProgressDialog</span>
(see Figure 16).<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_93"
 o:spid="_x0000_i1039" type="#_x0000_t75" alt="clip_image043" style='width:415.5pt;
 height:107.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image018.gif"
  o:title="clip_image043"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=554 height=143
src="SAG_files/image018.gif"
alt="clip_image043" v:shapes="Picture_x0020_93"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 17</span></b><span>:
Android <span class=SpellE>ProgressDialog</span><o:p></o:p></span></p>

<p class=MsoNormal><span>These still block the UI but are at least preferable to a frozen
screen. For longer delays the <span class=SpellE>ProgressBar</span> view can be
incorporated as part of the layout and driven from a helper thread associated
with the current activity. This allows the other parts of the UI to remain
active.<o:p></o:p></span></p>

<h3><b><span>6.2.1.2.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unresponsive
Applications<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>When an app blocks the Android UI for more than a few seconds, the
"Application Not Responding" (ANR) message will display, requiring the user to
choose whether to continue with or abandon the app.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_92"
 o:spid="_x0000_i1038" type="#_x0000_t75" alt="Description: 20110127_ANR"
 style='width:117pt;height:156pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image019.jpg"
  o:title=" 20110127_ANR"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=156 height=208
src="SAG_files/image019.jpg"
alt="Description: 20110127_ANR" v:shapes="Picture_x0020_92"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 18</span></b><span>:
Activity Not Responding Dialog<o:p></o:p></span></p>

<p class=MsoNormal><span>Clearly this is highly undesirable. In most cases, the user will
close the app, and the internal data-structures will need to be recomputed if
the user subsequently reruns the app.<o:p></o:p></span></p>

<p class=MsoNormal><span>To avoid this, apps should be structured to <span class=SpellE>minimise</span>
the amount of work done in any methods that run in the main thread (typically
the Activity life-cycle methods e.g. <span class=SpellE><span class=GramE>onCreate</span></span><span
class=GramE>(</span>), <span class=SpellE>onResume</span>()). For Activities,
the easiest way to do this is to offload the work to a child thread and provide
a Handler class which the child can use to indicate when the work is complete.<o:p></o:p></span></p>

<p class=MsoNormal><span>Garbage collection can also lead to noticeable delays in the user
interface. To a certain extent this is unavoidable but <span class=SpellE>minimising</span>
the number of objects that are created in main thread methods will help.<o:p></o:p></span></p>

<h3 id="6_2_2_offline_mode"><b><span>6.2.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offline&nbsp;</span></b><b><span>Mode<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>A common problem with mobile app design is the default assumption that
a connection is always available, and the lack of a connection is treated as a
corner case or error condition. This approach is reinforced through the common
use of emulators (which are effectively always connected) during the
development process.<o:p></o:p></span></p>

<p class=MsoNormal><span>A safer approach is to assume that a connection is seldom
available and design the architecture of the app accordingly. This approach
tends to encourage the development of stronger abstractions between the app and
its data and this in turn is likely to lead to an architecture that lends
itself more easily to the kind of asynchronous implementation discussed
earlier. Taking this approach to its logical extreme, apps would direct all
network traffic to a local service implementing a shared intelligent local persistent
cache.<o:p></o:p></span></p>

<p class=MsoNormal><span>Whatever approach you decide to take, Android provides several
options for storing and accessing persistent data.<o:p></o:p></span></p>

<h4><b><span>References</span></b><span><o:p></o:p></span></h4>

<h4><b><span>Data Storage</span></b><span><o:p></o:p></span></h4>

<h5><a
href="http://developer.android.com/guide/topics/data/data-storage.html"><span>http://developer.android.com/guide/topics/data/data-storage.html</span></a><span><o:p></o:p></span></h5>

<h4><b><span>Bandwidth Awareness</span></b><span><o:p></o:p></span></h4>

<p class=MsoNormal><span>The Android Connectivity Manager can be used to determine the
connection state, and the application can also register to receive status
updates. An instance of <span class=SpellE>NetworkInfo</span> can be obtained
via the Android Connectivity Manager, and with it, it is possible to determine
if the currently used Network interface is roaming and possibly limit network
traffic.<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>Where a throttling strategy has been used, (as
outlined in Section 5.2.1), the connection status can be used to dynamically
alter the throttle settings e.g. to increase the number of simultaneous
requests that are allowed when a Wi-Fi connection is present.</span></span><span><o:p></o:p></span></p>

<h3 id="6_2_3_caching"><b><span>6.2.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Caching</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Android's browser makes use of internal APIs to support HTTP
caching. These APIs are not available to other applications and so extra effort
is needed if caching is to be supported. According to RFC-2616, a possible
sequence diagram could be as follows:<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_85"
 o:spid="_x0000_i1037" type="#_x0000_t75" alt="Description: http-cache-sequence"
 style='width:411pt;height:376.5pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image020.jpg"
  o:title=" http-cache-sequence"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=548 height=502
src="SAG_files/image020.jpg"
alt="Description: http-cache-sequence" v:shapes="Picture_x0020_85"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 19</span></b><span>:
Http Caching – Sequence diagram<o:p></o:p></span></p>

<p class=MsoNormal><span>The full implementation of HTTP cache is laborious. Apache <span
class=SpellE>HttpClient</span> implements <span class=SpellE>CachingHttpClient</span>,
a drop-in replacement for a <span class=SpellE>DefaultHttpClient</span>, to
provide an HTTP/1.1-compliant caching layer, but it is not available under
Android. The flow in Figure 18 has to be implemented manually. A simple
conditional get can be implemented as below:<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>class</span></span><span> <span class=SpellE>ConditionalGetExample</span>
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;
String <span class=SpellE>entityTag</span> = &quot;&quot;;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;
String <span class=SpellE>lastModified</span> = &quot;&quot;;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=GramE>public</span> void start() throws <span class=SpellE>HttpException</span>,
<span class=SpellE>IOException</span> {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>HttpClient</span> client = new <span class=SpellE><span
class=GramE>DefaultHttpClient</span></span><span class=GramE>(</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>HttpGet</span> request = new <span class=SpellE><span
class=GramE>HttpGet</span></span><span class=GramE>(</span>(&quot;http://www.apache.org");&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>setHeaders</span></span><span class=GramE>(</span>request);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>HttpResponse</span> response = <span class=SpellE><span
class=GramE>client.executeMethod</span></span><span class=GramE>(</span>method);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>processResults</span></span><span
class=GramE>(</span>response);&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;
}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>private</span> void <span class=SpellE>setHeaders</span>(<span
class=SpellE>HttpGet</span>&nbsp; request) {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>request.setHeader</span></span><span
class=GramE>(</span>&quot;If-None-Match&quot;, <span class=SpellE>entityTag</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>request.setRequestHeader</span></span><span
class=GramE>(</span>&quot;If-Modified-Since&quot;, <span class=SpellE>lastModified</span>
));<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp; &nbsp;&nbsp;}<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=GramE>private</span> void <span class=SpellE>processResults</span>(<span
class=SpellE>HttpResponse</span> response) throws <span class=SpellE>HttpException</span>
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>if(</span><span class=SpellE>response.getStatusLine</span>().<span
class=SpellE>getStatusCode</span>() ==<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>HttpStatus.SC_NOT_MODIFIED</span>) {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>Log.d</span></span><span class=GramE>(</span>"Http
cache",<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Content not modified
since last request&quot;);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>return</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>else</span> {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>entityTag</span></span> = <span
class=SpellE>retrieveHeader</span>(method, &quot;<span class=SpellE>ETag</span>&quot;);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>lastModified</span></span> = <span
class=SpellE>retrieveHeader</span>(method, &quot;Last-Modified&quot;);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// process fresh content here!<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=GramE>private</span> String <span class=SpellE>retrieveHeader</span>(<span
class=SpellE>HttpResponse</span> response, String name)<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>throws</span> <span class=SpellE>HttpException</span> {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>Header[</span>] headers = <span class=SpellE>response.getHeaders</span>(name);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
String value = &quot;&quot;;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>if(</span><span class=SpellE>header.length</span> &gt; 0) {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>value</span> = header[0].<span class=SpellE>getName</span>();<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>return</span> value;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<p class=MsoNormal><span>If you are using <span class=SpellE>HttpUrlConnection</span> from
the java.net package, then Java's response cache mechanism might be another
approach. There are three abstract classes: <span class=SpellE>ResponseCache</span>,
<span class=SpellE>CacheRequest</span>, <span class=SpellE><span class=GramE>CacheResponse</span></span>.
You would need to extend these classes for your own cache implementation. The
flow of events is something like the following:<o:p></o:p></span></p>

<ul>
<li>A concrete class of ResponseCache registers with the system by using the static method ResponseCache. setDefault(ResponseCache)</li>
<li>There are two methods in the ResponseCache that are invoked by the protocol handlers. get() returns a CacheResponse and put() returns a CacheRequest</li>
<li>The creation of a URLConnection and attempt to read content creates the appropriate stream handler, which checks for the content in the cache by invoking ResponseCache.get()</li>
<li>If the content is found in the cache, it is returned. Otherwise a request is sent to the origin server, the response is sent to ResponseCache.put() to see if the content is cacheable (based on the response headers)</li>
</ul>

<h3 id="6_2_4_security"><b><span>6.2.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Security</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Android exposes a number
of standard Java APIs to support security:<o:p></o:p></span></p>


<ul>
<li>java.security package provides classes and interfaces supporting the security framework:</li>
<li>Generation and storage of public cryptographic keys</li>
<li>Message digest and signature generation</li>
<li>Secure random number generation</li>
<li>javax.crypto package provides additional classes and interfaces for common cryptographic operations:</li>
<li>Symmetric, asymmetric, block and stream ciphers</li>
<li>Secure streams and sealed objects</li>
<li>javax.security.* packages</li>
<li>Authentication and authorisation</li>
<li>Public key certificates</li>
</ul>


<p class=MsoNormal><span>The whole framework is "pluggable" in the sense that the
underlying cryptography implementation is abstracted away from the public APIs
so that 3<sup>rd</sup>&nbsp;party providers can be supported. Android makes use
of two security providers: Bouncy Castle and the Apache Harmony APIs. These are
explicitly instantiated in the <span class=SpellE>java.security</span> package,
extensive use of which is made throughout other parts of the Android framework
to support e.g. HTTPS, SSL Web kit browser etc.<o:p></o:p></span></p>

<p class=MsoNormal><span>Use of these APIs within the context of Android is not well documented.
However as the APIs are standardized there are plenty of generic examples of
their use.<o:p></o:p></span></p>

<h3 id="6_2_5_push_notifications"><b><span>6.2.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P</span></b><b><span>ush Notifications<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Google Cloud Messaging (GCM) is the preferred method of pushing
data to a device as it significantly impacts <span class=SpellE>optimisation</span>.
Alternative methods such as SMS are also possible but not covered in this
document.<o:p></o:p></span></p>

<ul>
<li>Existing applications using C2DM (Cloud To Device Messaging) are encouraged to migrate to GCM and any new application development should exclusively use GCM.</li>
<li>GCM is only available for devices running Android version 2.2 and requires Google Play Store.</li>
<li>As opposed to C2DM (Android's old cloud messaging system), GCM does not impose any quota on the number of messages delivered to Android devices. GCM is not meant for pushing the entire payload to a device, but to notify the application that it can go fetch new information available in its server.</li>
</ul>

<h3 id="6_2_6_data_formats"><b><span>6.2.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Data&nbsp;</span></b><b><span>Formats<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Android includes support for both JSON and XML interchange
formats. JSON support is provided by four classes in the <span class=SpellE>org.json</span>
package:<o:p></o:p></span></p>

<ul>
<li>JSONArray – Indexed sequence of values</li>
<li>JSONObject – Set of name/value mappings</li>
<li>JSONStringer – String conversion</li>
<li>JSONTokener – Parse JSON encoded strings into corresponding objects</li>
<li>android.util provides two further classes for reading/writing JSON encoded stream of tokens (includes examples)</li>
</ul>


<p class=MsoNormal><span>JSON is <span class=SpellE>standardised</span> through RFC 4627
and so, not unsurprisingly, plenty of examples of its use can be found on the
web. The Android framework itself makes fairly extensive use of JSON – for
example Android In-App Billing transaction information is contained in a JSON
string.<o:p></o:p></span></p>

<p class=MsoNormal><span>Android support for XML is provided by the following packages:<o:p></o:p></span></p>

<ul>
<li>org.xml.sax – Core SAX APIs ¦ org.xmlpull – Support for XML pull parsing</li>
<li>javax.xml.datatype – XML/Java type mappings</li>
<li>javax.xml.namespace – XML namespace processing</li>
<li>javax.xml.parsers – Processing for XML documents supporting pluggable parses for SAX and DOM</li>
<li>javax.xml.transform – Transformations from Source to Result with support for DOM, SAX2 and stream- and URI-specific transformations</li>
<li>javax.xml.validation – API for the validation of XML documents</li>
<li>javax.xml.xpath – API for the evaluation of XPath expressions (a simple concise language for selecting nodes from an XML document)</li>
<li>android.xml – XML utility methods</li>
</ul>

<p class=MsoNormal><span>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=SpellE>org.xml.sax</span>
– Core SAX APIs ¦ <span class=SpellE>org.xmlpull</span> – Support for XML pull
parsing<o:p></o:p></span></p>

<p class=MsoNormal><span>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=SpellE>javax.xml.datatype</span>
– XML/Java type mappings<o:p></o:p></span></p>

<p class=MsoNormal><span>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=SpellE>javax.xml.namespace</span>
– XML namespace processing<o:p></o:p></span></p>

<p class=MsoNormal><span>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=SpellE>javax.xml.parsers</span>
– Processing for XML documents supporting pluggable parses for SAX and DOM<o:p></o:p></span></p>

<p class=MsoNormal><span>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=SpellE>javax.xml.transform</span>
– Transformations from Source to Result with support for DOM, SAX2 and stream-
and URI-specific transformations<o:p></o:p></span></p>

<p class=MsoNormal><span>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=SpellE>javax.xml.validation</span>
– API for the validation of XML documents<o:p></o:p></span></p>

<p class=MsoNormal><span>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class=SpellE>javax.xml.xpath</span>
– API for the evaluation of <span class=SpellE>XPath</span> expressions (a
simple concise language for selecting nodes from an XML document)<o:p></o:p></span></p>

<p class=MsoNormal><span>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android.xml – XML
utility methods<o:p></o:p></span></p>

<p class=MsoNormal><span>Again the Android framework makes extensive use of XML – e.g. the
Android application manifest, UI layout files and <span class=SpellE>internationalisation</span>
all use XML.<o:p></o:p></span></p>

<h4><b><span>References</span></b><span><o:p></o:p></span></h4>

<h5><a href="http://developer.android.com/reference/org/json/package-summary.html"><span>http://developer.android.com/reference/org/json/package-summary.html</span></a><span><o:p></o:p></span></h5>

<h3 id="6_2_7_compression"><b><span>6.2.7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compression</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Android supports <span class=SpellE>gzip</span> and deflate
compression for HTTP content. However compression is not enabled by default and
so developers need to explicitly add the "Accept-Encoding" header to the
request and handle the received content according to its "Content-Encoding"
header.<o:p></o:p></span></p>

<p class=MsoNormal><span>The following sample code shows how to add compression using
interceptors with the Apache <span class=SpellE>HTTPClient</span>:<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span>DefaultHttpClient</span></span><span> <span class=SpellE>httpclient</span> = new <span
class=SpellE><span class=GramE>DefaultHttpClient</span></span><span
class=GramE>(</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>// <span class=GramE>Add</span> <span class=SpellE>gzip</span>
header to requests using an interceptor<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span class=GramE><span>httpclient.addRequestInterceptor</span></span></span><span
class=GramE><span>(</span></span><span>new <span class=SpellE>GzipHttpRequestInterceptor</span>());&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal><span>// <span class=GramE>Add</span>
<span class=SpellE>gzip</span> compression to responses using an interceptor<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span class=GramE><span>httpclient.addResponseInterceptor</span></span></span><span
class=GramE><span>(</span></span><span>new <span class=SpellE>GzipHttpResponseInterceptor</span>());<o:p></o:p></span></p>

<p class=MsoNormal><span>...<o:p></o:p></span></p>

<p class=MsoNormal><span>//Request interceptor
for adding <span class=SpellE>gzip</span> accept header<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>private</span></span><span> final class <span class=SpellE>GzipHttpRequestInterceptor</span>
implements <span class=SpellE>HttpRequestInterceptor</span> {<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>public</span></span><span> void process(final <span class=SpellE>HttpRequest</span>
request, final <span class=SpellE>HttpContext</span> context) throws <span
class=SpellE>HttpException</span>, <span class=SpellE>IOException</span> {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=GramE>if</span> (!<span class=SpellE>request.containsHeader</span>(&quot;Accept-Encoding&quot;))
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>request.addHeader</span></span><span
class=GramE>(</span>&quot;Accept-Encoding&quot;, &quot;<span class=SpellE>gzip</span>&quot;);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<p class=MsoNormal><span>//Response interceptor
for handling compressed responses<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>private</span></span><span> final class <span class=SpellE>GzipHttpResponseInterceptor</span>
implements <span class=SpellE>HttpResponseInterceptor</span> {<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>public</span></span><span> void process(final <span class=SpellE>HttpResponse</span>
response, final <span class=SpellE>HttpContext</span> context) throws <span
class=SpellE>HttpException</span>, <span class=SpellE>IOException</span> {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=SpellE>HttpEntity</span> entity = <span class=SpellE><span class=GramE>response.getEntity</span></span><span
class=GramE>(</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;
Header <span class=SpellE>header</span> = <span class=SpellE><span class=GramE>entity.getContentEncoding</span></span><span
class=GramE>(</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=GramE>if</span> (header != null) {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>HeaderElement</span></span><span
class=GramE>[</span>] codecs = <span class=SpellE>header.getElements</span>();<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>for</span> (<span class=SpellE>int</span> i = 0; i &lt; <span
class=SpellE>codecs.length</span>; i++) {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>if</span> (codecs[i].<span class=SpellE>getName</span>().<span
class=SpellE>equalsIgnoreCase</span>(&quot;<span class=SpellE>gzip</span>&quot;))
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>response.setEntity</span></span><span
class=GramE>(</span>new <span class=SpellE>GzipDecompressingEntity</span>(<span
class=SpellE>response.getEntity</span>()));<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>return</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<p class=MsoNormal><span>//Compression entity
used in response interceptor<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>static</span></span><span> class <span class=SpellE>GzipDecompressingEntity</span>
extends <span class=SpellE>HttpEntityWrapper</span> {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>public</span> <span class=SpellE>GzipDecompressingEntity</span>(final
<span class=SpellE>HttpEntity</span> entity) {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>super(</span>entity);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
@Override<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>public</span> <span class=SpellE>InputStream</span> <span
class=SpellE>getContent</span>() throws <span class=SpellE>IOException</span>, <span
class=SpellE>IllegalStateException</span> {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>InputStream</span> <span class=SpellE>wrappedin</span> = <span
class=SpellE><span class=GramE>wrappedEntity.getContent</span></span><span
class=GramE>(</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>return</span> new <span class=SpellE>GZIPInputStream</span>(<span
class=SpellE>wrappedin</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
@Override<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>public</span> long <span class=SpellE>getContentLength</span>()
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>return</span> -1;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<h3 id="6_2_8_background_foreground_modes"><b><span>6.2.8&nbsp; Background / Foreground Modes<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Android <span
class=SpellE>recognises</span> five different process states:<o:p></o:p></span></p>

<ul>
<li>Foreground process: This is the part of the app that is currently visible and with which the user is interacting. More precisely an Activity is considered to be in the foreground between calls to the onResume() and onPause() methods, so typically the onPause() method is where application data ought to be persisted and CPU intensive tasks terminated (e.g. application threads, animation + other content rendering)</li>
<li>Visible process: Although this part of the app is no longer in the foreground some of its UI components are visible.  An example of this would be when a dialog box is in the foreground partially obscuring the other activity's UI</li>
<li>Service process: These are started by startService() and do not fall into either of the previous process states as services do not present a UI. Service processes keep running until they are explicitly stopped or the system runs  out of memory</li>
<li>Background process: Activities whose onStop() method has been called. As no part of the activity's UI is visible it is assumed that these processes can be killed at any time (by implication this means that the application must have saved its state correctly as a side effect of earlier life-cycle methods)</li>
<li>Empty process: These are retained to improve start-up performance of other components</li>
</ul>


<p class=MsoNormal><span>For Activities, Android also provides the <span class=SpellE><span
class=GramE>onSaveInstanceState</span></span><span class=GramE>(</span>) to
help with persistence. This is called (immediately prior to <span class=SpellE><span
class=GramE>onPause</span></span><span class=GramE>(</span>)) when the app is
to be destroyed by the system. This allows discrimination between this
condition (when the user might expect the app's last state to be restored the
next time it is run) and when the user has shut down the app (and might
therefore expect it to run from the start next time).<o:p></o:p></span></p>

<p class=MsoNormal><span>For activity lifecycle methods from <span class=SpellE><span
class=GramE>onPause</span></span><span class=GramE>(</span>) onwards the
application process can be killed at any time after the method returns.<o:p></o:p></span></p>

<p class=MsoNormal><span>Services should not in general run in the foreground, nor should
they run continuously in the background. They should instead be triggered by
some event or woken up periodically to perform a task, and then call <span
class=SpellE><span class=GramE>stopService</span></span><span class=GramE>(</span>),
in order to <span class=SpellE>minimise</span> memory and CPU consumption and
to avoid the risk of being killed by the OS.<o:p></o:p></span></p>

<p class=MsoNormal><span>As mentioned in Section 3.6, if developers want their apps to
obtain/update the latest information at the time when users start interacting
with a device already in sleep mode, it is recommended to trigger the related
network activity when the device screen is unlocked (rather than when the
screen display just turns on). In terms of Android, this means using the
ACTION_USER_PRESENT intent to trigger such network activity, rather than using
the ACTION_USER_SCREEN intent. The ACTION_USER_PRESENT intent is notified when
the device screen is unlocked, whereas the ACTION_USER_SCREEN intent is also
notified when the screen display is just turned on.<o:p></o:p></span></p>

<h3 id="6_2_9_scheduling"><b><span>6.2.9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scheduling</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Scheduling an app's network activities in synch with network
activity requests from other apps will reduce the <span class=SpellE>signalling</span>
load as they are batched together. This is achieved by using <span
class=SpellE>AlarmManager</span> with <span class=SpellE>setInexactRepeat</span>
and an interval constant provided in <span class=SpellE>AlarmManager</span>,
e.g. INTERVAL_HALF_HOUR. These constants are special in that <span
class=SpellE>AlarmManager</span>. <span class=SpellE><span class=GramE>setInexactRepeat</span></span>
will fire the intents at a regular intervals simultaneously, but not at exactly
specified times<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span>AlarmManager</span></span><span> am = (<span class=SpellE>AlarmManager</span><span
class=GramE>)<span class=SpellE>context.getSystemService</span></span>(<span
class=SpellE>Context.ALARM_SERVICE</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>Intent <span class=SpellE>intent</span> = new <span class=GramE>Intent(</span>context,
<span class=SpellE>Poller.class</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span>PendingIntent</span></span><span> <span class=SpellE>pIntent</span> = <span
class=SpellE><span class=GramE>PendingIntent.getService</span></span><span
class=GramE>(</span>context,0,intent, 0);<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>long</span></span><span> interval = <span class=SpellE>AlarmManager.INTERVAL_FIFTEEN_MINUTES</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>long</span></span><span> <span class=SpellE>firstPoll</span> = <span class=SpellE>System.currentTimeMillis</span>();<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span class=GramE><span>am.setInexactRepeating</span></span></span><span
class=GramE><span>(</span></span><span
class=SpellE><span>AlarmManager.RTC</span></span><span>, <span class=SpellE>firstPoll</span>, interval,
<span class=SpellE>pIntent</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>The alarm type can be either <span class=SpellE>AlarmManager.RTC</span>,
which uses absolute time (wall clock time), or <span class=SpellE>AlarmManager.ELAPSED_REALTIME</span>,
which uses relative time (time since boot).<o:p></o:p></span></p>

<p class=MsoNormal><span>Unless there really is a need to wake up the application at the
scheduled alarm time, ensure that <span class=SpellE>AlarmManager.RTC</span> / <span
class=SpellE>AlarmManager.ELAPSED_REALTIME</span> <span class=GramE>is</span>
used and not <span class=SpellE>AlarmManager.RTC_WAKEUP</span> / <span
class=SpellE>AlarmManager.ELAPSED_REALTIME_WAKEUP</span>, i.e. don't wake up
the application unless some other app is also being woken up. On devices with
Google services, schedulers run regularly and will make sure the specified app
wakes up now and then.&nbsp;<o:p></o:p></span></p>

<h3 id="6_2_10_spreading_network_activity_timing_among_different_devices"><b><span>6.2.10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S</span></b><b><span>preading Network Activity Timing <span
class=GramE>Among</span> Different Devices<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>As mentioned in Section 3.7, it is recommended to design apps to
spread network activity timing across different devices as much as possible.
Some tips in designing Android apps to fulfil this goal are explained below.<o:p></o:p></span></p>

<h3><b><span>6.2.10.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Apps requiring
periodic network activity but not necessarily at exact times<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>For applications requiring periodic network activities but not
necessarily at exact times (e.g. the RSS newsfeed example mentioned in Section
3.7), it is ideal to evenly spread the network activity timings across devices.<o:p></o:p></span></p>

<p class=MsoNormal><span>One way to <span class=SpellE>realise</span> such <span
class=SpellE>behaviour</span> would be to:<o:p></o:p></span></p>

<ul>
<li>Use setRepeating / setInexactRepeating of AlarmManager to schedule alarms for an app with:</li>
<li>Alarm type set to AlarmManager.ELAPSED_REALTIME; and</li>
<li>The base timing of the first alarm set to a timing which would be spread across devices (e.g. the timing when the app's activity is displayed).</li>
</ul>


<h3><b><span>6.2.10.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Apps
Requiring Network Activity at Exact Times<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>For applications requiring network activities at exact times of a
day (e.g. the weather widget example mentioned in Section 3.7), it is better to
spread the network activity timings across devices within an acceptable time
window.<o:p></o:p></span></p>

<p class=MsoNormal><span>One way to <span class=SpellE>realise</span> such <span
class=SpellE>behaviour</span> would be to:<o:p></o:p></span></p>

<ul>
<li>Use&nbsp;<i><span>set</span></i><span>&nbsp;/&nbsp;</span><span class=SpellE><i><span>setRepeating</span></i></span><span>&nbsp;/&nbsp;</span><span class=SpellE><i><span>setInexactRepeating</span></i></span>&nbsp;of <span class=SpellE>AlarmManager</span> to schedule alarms
for an app with:</li>
<li>Alarm type set to AlarmManager.RTC; and</li>
<li>Timing of the (first) alarm set to a summed value of:</li>
<li>The desired exact timing (e.g. 17hr:00min); and</li>
<li>A random offset within the acceptable time window (e.g. a random offset obtained using a uniform distribution function between 0min and 5min).</li>
</ul>

<h3><b><span>6.2.10.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Synched NW
Activity Timing of an App Due to WAKEUP of <span class=GramE>Another</span> App<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>By using the mechanisms mentioned above, it is possible to spread
network activity timings of an app across devices. However, even for apps designed
with such mechanisms, the network activity timings may be synched across
devices due another app with alarms scheduled at exact timings using the WAKEUP
functionality (i.e. alarm type set to <span class=SpellE>AlarmManager.RTC_WAKEUP</span>).
This <span class=SpellE>behaviour</span> is illustrated in Figure 19 below.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_63"
 o:spid="_x0000_i1036" type="#_x0000_t75" alt="clip_image049" style='width:443.25pt;
 height:296.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image021.gif"
  o:title="clip_image049"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=591 height=395
src="SAG_files/image021.gif"
alt="clip_image049" v:shapes="Picture_x0020_63"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 20</span></b><span>:
Synched NW activity timing due to WAKEUP of another app<o:p></o:p></span></p>

<p class=MsoNormal><span>In Figure 19, "App A" and "App B" are both installed on Device X
and Device Y, where:<o:p></o:p></span></p>

<ul>
<li>"App A":</li>
<li>Uses repeated alarms with a 1 hour interval for periodic network activities;</li>
<li>Does not use the WAKEUP functionality;</li>
<li>"App B":</li>
<li>Has an alarm set at 7PM on both Device X and Device Y; Uses the WAKEUP functionality.</li>
</ul>


<p class=MsoNormal><span>Originally, the alarm / network activity timing of "App A" is
designed to be spread across Device X and Device Y (i.e. up to the 5PM hour).
By the alarm timing of "App A" in the 6PM hour, Device X and Device Y have gone
to sleep mode, and hence the intents / network activity for "App A" are pended
in both devices. At 7PM, Device X and Device Y wake up due to the scheduled
alarm of "App B" using the WAKEUP functionality. The pended intent of "App A"
is fired at this timing, and results in synched network activity of Device X
and Device Y. Note that "App B" may be an alarm clock, which does not incur
network activity by itself.<o:p></o:p></span></p>

<p class=MsoNormal><span>One way to avoid such unintended synching of an app's network
activity timing across devices would be to:<o:p></o:p></span></p>

<ul>
<li>Utilize the sleep method of Thread class (i.e. Thread.sleep) to suspend an app's task (even for a short period of time), where:</li>
<li>When receiving intents from the AlarmManager for an app, Thread.sleep (with even a short period of sleep time) is called before actually running the tasks for that app; and</li>
<li>A random sleep time (e.g. a random time obtained using a uniform distribution function between 0min and 1min) is used.</li>
</ul>



<p class=MsoNormal><span>With such careful implementation, for the example illustrated in
Figure 19, the network activity timing of "App A" at 7PM (due to the wake up
caused by "App B") can be spread to a certain extent across Device X and Device
Y.<o:p></o:p></span></p>

<p class=MsoNormal><span>It is noted that periodic network activity of an app can also be <span
class=SpellE>realised</span> by using <span class=SpellE>AlarmManager</span>
with set (instead of <span class=SpellE>setRepeating</span> / <span
class=SpellE>setInexactRepeating</span>), i.e. by entering set after every time
tasks for that app are invoked. However, such design will increase the
probability of synched network activity timing of the app across devices. For
example, in the case illustrated in Figure 19, the network activity timing for
"App A" is synched across Device X and Device Y at the 7PM due to the WAKEUP
event caused by "App B". If "App A" has used set to schedule the hourly alarms,
the periodic alarm / network activity timing for "App A" from thereon will be
continuously synched across Device X and Device Y. By using <span class=SpellE>setRepeating</span>
or <span class=SpellE>setInexactRepeating</span> instead, such unintended
periodic synching can be avoided, since the base time for the periodically
repeated alarms are kept unchanged. Therefore, it is recommended to use <span
class=SpellE>setRepeating</span> / <span class=SpellE>setInexactRepeating</span>
when scheduling alarms periodically.&nbsp;<o:p></o:p></span></p>

<h3><b><span>6.2.10.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Alarm Type for <span
class=SpellE>setInexactRepeating</span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>As mentioned above, using <span class=SpellE>AlarmManager</span>
with <span class=SpellE>setInexactRepeating</span> is useful in bundling
network activities of multiple apps within a device and spreading network
activity timings across different devices. However, for earlier Android OS
versions (e.g. Gingerbread and earlier), it has been noticed that when <span
class=SpellE>AlarmManager.RTC</span> is used for the alarm type, the alarms are
scheduled at specific wall clock times (e.g. XXhr<span class=GramE>:00min</span>,
XXhr:15min, XXhr:30min, XXhr:45min). This may result in unintended
concentration of network activities across different devices, and hence the use
of <span class=SpellE>AlarmManager.ELAPSED_REALTIME</span> rather than <span
class=SpellE>AlarmManager.RTC</span> is recommended.<o:p></o:p></span></p>

<h3 id="6_3_windows_phone"><b><span>6.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Windows
Phone</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>For a general overview of Windows Phone networking, please refer
to the following article:<o:p></o:p></span></p>

<h4><b><span>Windows® Networking in Silverlight for Windows Phone&nbsp;</span></b><span><o:p></o:p></span></h4>

<p class=MsoNormal><a
href="http://msdn.microsoft.com/en-us/library/ff637320(VS.95).aspx"><span>http://msdn.microsoft.com/en-us/library/ff637320(VS.95).aspx</span></a><span><o:p></o:p></span></p>

<h3 id="6_3_1_asynchrony"><b><span>6.3.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Asynchrony&nbsp;<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Windows Phone is designed to operate in multithreaded mode and
support asynchronous communication out of the box. All network access in
Windows Phone is asynchronous and the main networks APIs do not expose
synchronous methods to <span class=SpellE>minimise</span> the impact on the
performance of the UI. As network resources can be accessed in a number of
ways, it is important to understand the multithreaded architecture.<o:p></o:p></span></p>

<p class=MsoNormal><span>Every Silverlight application will have the following threads by
default:&nbsp;<o:p></o:p></span></p>

<ul>
<li>UI thread – responsible for handling user input, drawing new visuals, and calling back to user code </li>
<li>Main thread – responsible for handling user code, such as loading and processing of data, implementing business logic, etc. </li>
</ul>


<p class=MsoNormal><span>It is essential to keep the UI thread as free as possible, as
maintaining a lightweight UI thread is the key factor of a responsive app.
Access to the network resources can be performed from both the user code and
XAML mark-up. All objects referenced from XAML are downloaded and processed
asynchronously by the Silverlight engine. Network resources accessed from the
user code are handled by the APIs of the System.Net namespace which includes:&nbsp;<o:p></o:p></span></p>

<ul>
<li>WebClient class – provides common methods for sending data to and receiving data from a resource identified by a URI.</li>
<li>WebClient is a wrapper class around the HttpWebRequest class and can be easier to use because it returns result data to the app on the UI thread. WebClient supports events. WebClient is a higher level API than HttpWebRequest with callbacks made on UI thread and support of events</li>
<li>HttpWebRequest class – is a lower level API compared with WebClient and provides richer functionality and  better control over HTTP communication. Callbacks are implemented through a delegate function and made  on the Main thread</li>
</ul>



<p class=MsoNormal><span>Although both of these classes support asynchronous communication
only, it is important to understand the differences between them.&nbsp;<o:p></o:p></span></p>

<h3><b><span>6.3.1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span
class=SpellE>WebClient</span> Class<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>This class is designed for use from Silverlight controls that are
hosted in a XAML page. It provides the simplest way of accessing network
resources but must be used carefully as it operates in the UI thread and can
impact UI responsiveness. Developers should ensure that all code referenced by
event handlers only performs tasks that are related to updating the UI,
otherwise this will delay the return of control to the UI thread and make UI
operation sluggish.<o:p></o:p></span></p>

<p class=MsoNormal><span>Here is an example:<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>try</span></span><span><o:p></o:p></span></p>

<p class=MsoNormal><span>{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=SpellE>System.Uri</span> <span class=SpellE>uri</span> = new <span
class=GramE>Uri(</span>&quot;http://www.bing.com&quot;);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=SpellE>WebClient</span> <span class=SpellE>webClient</span> = new <span
class=SpellE><span class=GramE>WebClient</span></span><span class=GramE>(</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; //
Assign callback event handler<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=SpellE>webClient.OpenReadCompleted</span> +=<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>new</span> <span class=SpellE>OpenReadCompletedEventHandler</span>(<span
class=SpellE>webClient_OpenReadCompleted</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; // <span
class=GramE>Create</span> a <span class=SpellE>HttpWebrequest</span> object to
the desired URL<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=SpellE><span class=GramE>webClient.OpenReadAsync</span></span><span
class=GramE>(</span><span class=SpellE>uri</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>catch</span></span><span> (Exception ex)<o:p></o:p></span></p>

<p class=MsoNormal><span>{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; //
TODO: your exception handling code<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=SpellE>webClientTextBlock.Text</span> =<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;Exception <span class=GramE>raised</span>! Message: <span class=GramE>&quot;
+</span> <span class=SpellE>ex.Message</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>void</span></span><span> <span class=SpellE>webClient_OpenReadCompleted</span>(object
sender, <span class=SpellE>OpenReadCompletedEventArgs</span> e)<o:p></o:p></span></p>

<p class=MsoNormal><span>{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=GramE>try</span><o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>using</span> (<span class=SpellE>StreamReader</span> reader =
new <span class=SpellE>StreamReader</span>(<span class=SpellE>e.Result</span>))<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>webClientTextBlock.Text</span> = <span class=SpellE><span
class=GramE>reader.ReadToEnd</span></span><span class=GramE>(</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=GramE>catch</span> (<span class=SpellE>WebException</span> ex)<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// TODO: your exception handling code<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;<span class=SpellE>webClientTextBlock.Text</span> =<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;<span class=SpellE>WebException</span> <span class=GramE>raised</span>!
Message: &quot; + <span class=SpellE>ex.Message</span> +<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;\<span class=SpellE>nStatus</span><span class=GramE>: &quot;</span> + <span
class=SpellE>ex.Status</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=GramE>catch</span> (Exception ex)<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// TODO: your exception handling code<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>webClientTextBlock.Text</span> =<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;Exception <span class=GramE>raised</span>! Message: <span class=GramE>&quot;
+</span> <span class=SpellE>ex.Message</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<h3><b><span>6.3.1.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span
class=SpellE>HttpWebRequest</span> Class<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>This class is designed for use from the user code and should
normally be considered for accessing data feeds, submitting data to the cloud
and manual handling of static network resources. Callbacks are processed via <span
class=SpellE>AsyncCallback</span> delegate function and are made on the Main
thread. This means that all code updating the UI must be <span class=SpellE>synchronised</span>
with the UI thread, otherwise access to any UI controls or UI related classes
(such as <span class=SpellE>BitmapImage</span>) will result in a <span
class=SpellE>System.InvalidOperationException</span>. In order to <span
class=SpellE>synchronise</span> output with the UI thread it is necessary to
invoke the code through a dispatcher.<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span class=GramE><span>Dispatcher.BeginInvoke</span></span></span><span
class=GramE><span>(</span></span><span>() =&gt; { /* UI update code */ });<o:p></o:p></span></p>

<p class=MsoNormal><span>Before invoking the dispatcher, you should ensure the processing
of all non-UI related data is complete. Keep this block of code as compact as
possible, only perform UI updates and don't perform any unnecessary
calculations as anything executed here may further delay the rendering of the
UI.<o:p></o:p></span></p>

<p class=MsoNormal><span>Here is an example of how to use the <span class=SpellE>HttpWebRequest</span>
class:<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>try</span></span><span><o:p></o:p></span></p>

<p class=MsoNormal><span>{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=SpellE>System.Uri</span> <span class=SpellE>uri</span> = new <span
class=GramE>Uri(</span>&quot;http://www.bing.com&quot;);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; // <span
class=GramE>Create</span> a <span class=SpellE>HttpWebRequest</span> object to
the desired URL<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=SpellE>HttpWebRequest</span> <span class=SpellE>httpWebRequest</span> = (<span
class=SpellE>HttpWebRequest</span><span class=GramE>)<span class=SpellE>WebRequest.Create</span></span>(<span
class=SpellE>uri</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; //
Start the asynchronous request<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=SpellE>IAsyncResult</span> result = (<span class=SpellE>IAsyncResult</span><span
class=GramE>)<span class=SpellE>httpWebRequest.BeginGetResponse</span></span>(<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>new</span> <span class=SpellE>AsyncCallback</span>(<span
class=SpellE>ResponseCallback</span>), <span class=SpellE>httpWebRequest</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>catch</span></span><span> (<span class=SpellE>WebException</span> ex)<o:p></o:p></span></p>

<p class=MsoNormal><span>{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; //
TODO: your exception handling code<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=SpellE><span class=GramE>Dispatcher.BeginInvoke</span></span><span
class=GramE>(</span>() =&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>httpWebRequestTextBlock.Text</span> =<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;<span class=SpellE>WebException</span> <span class=GramE>raised</span>!
Message: &quot; + <span class=SpellE>ex.Message</span> +<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;\<span class=SpellE>nStatus</span><span class=GramE>: &quot;</span> + <span
class=SpellE>ex.Status</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; });<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>catch</span></span><span> (Exception ex)<o:p></o:p></span></p>

<p class=MsoNormal><span>{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; //
TODO: your exception handling code<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=SpellE><span class=GramE>Dispatcher.BeginInvoke</span></span><span
class=GramE>(</span>() =&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>httpWebRequestTextBlock.Text</span> =<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;Exception <span class=GramE>raised</span>! Message: <span class=GramE>&quot;
+</span> <span class=SpellE>ex.Message</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; });<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>private</span></span><span> void <span class=SpellE>ResponseCallback</span>(<span
class=SpellE>IAsyncResult</span> result)<o:p></o:p></span></p>

<p class=MsoNormal><span>{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=GramE>try</span><o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>HttpWebRequest</span> <span class=SpellE>httpWebRequest</span>
= (<span class=SpellE>HttpWebRequest</span><span class=GramE>)<span
class=SpellE>result.AsyncState</span></span>;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// <span class=GramE>Obtain</span> <span class=SpellE>WebResponse</span> from
the callback result parameter<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>WebResponse</span> <span class=SpellE>webResponse</span> = <span
class=SpellE><span class=GramE>httpWebRequest.EndGetResponse</span></span><span
class=GramE>(</span>result);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>using</span> (Stream <span class=SpellE>responseStream</span>
= <span class=SpellE>webResponse.GetResponseStream</span>())<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>using</span> (<span class=SpellE>StreamReader</span> <span
class=SpellE>responseStreamReader</span> =<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>new</span> <span class=SpellE>StreamReader</span>(<span
class=SpellE>responseStream</span>))<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// Read response body<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>string</span> contents = <span class=SpellE>responseStreamReader.ReadToEnd</span>();<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// <span class=GramE>Invoke</span> dispatcher to access UI thread<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>Dispatcher.BeginInvoke</span></span><span
class=GramE>(</span>() =&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// Update UI control<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>httpWebRequestTextBlock.Text</span> = contents;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
});<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=GramE>catch</span> (<span class=SpellE>WebException</span> ex)<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// TODO: your exception handling code<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>Dispatcher.BeginInvoke</span></span><span
class=GramE>(</span>() =&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>httpWebRequestTextBlock.Text</span> =<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;<span class=SpellE>WebException</span> <span class=GramE>raised</span>!
Message: &quot; + <span class=SpellE>ex.Message</span> +<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;\<span class=SpellE>nStatus</span><span class=GramE>: &quot;</span> + <span
class=SpellE>ex.Status</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
});<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=GramE>catch</span> (Exception ex)<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// TODO: your exception handling code<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>Dispatcher.BeginInvoke</span></span><span
class=GramE>(</span>() =&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>httpWebRequestTextBlock.Text</span> =<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;Exception <span class=GramE>raised</span>! Message: <span class=GramE>&quot;
+</span> <span class=SpellE>ex.Message</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
});<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<h3><b><span>6.3.1.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Managing
Asynchronous Requests<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>In most cases the monitoring of asynchronous requests is not
necessary as responses will automatically fail in the case of network errors
resulting in <span class=SpellE>WebException</span> being raised. Network error
exceptions must be always handled appropriately by code, but in some scenarios
it will be necessary to implement the following:<o:p></o:p></span></p>

<ul>
<li>Timeout handling – in asynchronous programming, it is the responsibility of the client application to implement its own time-out mechanism</li>
<li>Cancellation of requests – for example when the user wants to manually terminate network requests</li>
</ul>


<p class=MsoNormal><span>If an app requires management of asynchronous requests for any
reason, references to all issued requests need to be stored and their states
passed across asynchronous calls within the thread. This technique is based on
storing parameters related to individual requests in the <span class=SpellE>RequestState</span>
class. To implement timeout handling and cancellation of asynchronous requests,
follow this article:<o:p></o:p></span></p>

<h5><a href="http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.abort(v=vs.80).aspx"><span>http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.abort(v=vs.80).aspx</span></a><span><o:p></o:p></span></h5>

<p class=MsoNormal><b><span>Note</span></b><span>: Always remember that <span
class=SpellE>WebClient</span> callbacks are made on the UI thread<o:p></o:p></span></p>

<p class=MsoNormal><b><span>Note:</span></b><span>&nbsp;Keep non-UI
related code out of the dispatched code when using <span class=SpellE>HttpWebRequest</span><o:p></o:p></span></p>

<h4><b><span>References</span></b><span><o:p></o:p></span></h4>

<h4><span class=SpellE><b><span>HttpWebRequest</span></b></span><b><span> class</span></b><span><o:p></o:p></span></h4>

<h5><a href="http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest(v=VS.95).aspx"><span>http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest(v=VS.95).aspx</span></a><span><o:p></o:p></span></h5>

<h4><span class=SpellE><b><span>WebClient</span></b></span><b><span> class</span></b><span><o:p></o:p></span></h4>

<h5><a href="http://msdn.microsoft.com/en-us/library/system.net.webclient(v=VS.95).aspx"><span>http://msdn.microsoft.com/en-us/library/system.net.webclient(v=VS.95).aspx</span></a><span><o:p></o:p></span></h5>

<h4><b><span>Making Asynchronous Requests</span></b><span><o:p></o:p></span></h4>

<h5><a href="http://msdn.microsoft.com/en-us/library/86wf6409.aspx"><span>http://msdn.microsoft.com/en-us/library/86wf6409.aspx</span></a><span><o:p></o:p></span></h5>

<h3 id="6_3_2_connection_loss_and_error_handling"><b><span>6.3.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connection
Loss and&nbsp;</span></b><b><span>Error Handling<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Regardless of the network error recovery strategy chosen for an
app, it is absolutely necessary to ensure that:<o:p></o:p></span></p>

<ul>
<li>Your app never crashes due to a network error</li>
<li>Your app informs the user about network issues in an unobtrusive way<br><br>The application error recovery strategy may be as simple as instructing the user to restart the app in order to refresh,  or may be more sophisticated implementing offline mode with manual or automatic retry or network status monitoring features. Depending on the chosen strategy, this list of facts and options is worth considering:</li>
<li>XAML referenced network resources are loaded automatically by Silverlight and are difficult to monitor. You will have to load these resources into the UI yourself in order to have a better control</li>
<li>Always catch exceptions from WebCllient or HttpWebRequest when initiating requests and reading responses, otherwise your application will crash. The WebException.Status property contains a WebExceptionStatus value that indicates the source of the error. Code samples for your convenience are given in the previous section 5.3.1.</li>
<li>Monitor errors globally and integrate network health flags into ViewModel so that you can consistently report connectivity errors and perhaps offer a recovery action<br><br>If all network resources are managed through user code, then consider the following: </li>
<li>Design the data transfer routine so it can be restarted at any time. Different parts of an app will likely have different routines </li>
<li>Manage asynchronous network requests to allow safe cancellation of them. Example technique is covered in the previous section 5.3.1 Asynchrony -> Managing asynchronous requests </li>
<li>Store successfully loaded resources in persistent storage, so they are not reloaded every time – this will be a part of an offline mode implementation. Don't forget to clean up the cache. See sections 5.3.3 Caching for extra information </li>
<li>Monitor connection status events in order to automatically restart failed data transfer routines <br><br>Implementation of good recovery strategy is simpler if the app follows the Model-View-ViewModel (MVVM) design pattern. Errors are dealt with at the data layer and status reported to the UI through ViewModel. <br><br>MVVM design pattern is well covered in this article: <a href="http://msdn.microsoft.com/en-us/magazine/dd419663.aspx" target="_blank"><span>http://msdn.microsoft.com/en-us/magazine/dd419663.aspx</span></a></li>
</ul>


<h3><b><span>6.3.2.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Automatic
Retry&nbsp;<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Consider implementing automatic retry only when performing lengthy
or scheduled data transfers. Don't perform the retry immediately after the
failure, as the failed network interface requires time to recover. Also, limit
the number of <span class=GramE>retries,</span> otherwise the app can drain the
device battery. Here is an example of a good algorithm:&nbsp;<o:p></o:p></span></p>

<ul>
<li>First retry after one minute </li>
<li>Second retry after five minutes </li>
<li>Third (and last) retry after 15 minutes </li>
</ul>


<p class=MsoNormal><span>Tip: Consider Automatic retry for network applications which work
under Lock Screen&nbsp;<o:p></o:p></span></p>

<h3><b><span>6.3.2.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checking
Network Connection Status<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Checking connection status on Windows Phone is impractical as this
information is not immediately available to the app. It may take a couple of
seconds to determine the type of connection.<o:p></o:p></span></p>

<p class=MsoNormal><span>This information is obtained via the <span class=SpellE>NetworkInterfaceType</span>
property of the <span class=SpellE>NetworkInterface</span> class of the <span
class=SpellE>Microsoft.Phone.Net.NetworkInformation</span> namespace. The <span
class=SpellE>NetworkInterfaceType</span> property returns one of the following
values:<o:p></o:p></span></p>


<ul>
<li>Wireless80211</li>
<li>Ethernet</li>
<li>MobileBroadbandGSM</li>
<li>MobileBroadbandCDMA</li>
<li>None</li>
</ul>


<p class=MsoNormal><span>Below is an example of how to obtain status and monitor changes of
network connection type:<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>using</span></span><span> System;<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>using</span></span><span> <span class=SpellE>System.Net.NetworkInformation</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>using</span></span><span> <span class=SpellE>System.Threading</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>using</span></span><span> <span class=SpellE>System.Windows</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>using</span></span><span> <span class=SpellE>Microsoft.Phone.Controls</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>using</span></span><span> <span class=SpellE>Microsoft.Phone.Net.NetworkInformation</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span class=GramE><span>namespace</span></span><span> <span class=SpellE>ConnectionStatus</span><o:p></o:p></span></p>

<p class=MsoNormal><span>{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; <span
class=GramE>public</span> partial class <span class=SpellE>MainPage</span> : <span
class=SpellE>PhoneApplicationPage</span><o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// <span class=GramE>Indicates</span> type of the current connection to the
internet<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>private</span> <span class=SpellE>NetworkInterfaceType</span>
<span class=SpellE>internetConnectionType</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// Main Page Constructor<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>public</span> <span class=SpellE>MainPage</span>()<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>InitializeComponent</span></span><span
class=GramE>(</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// <span class=GramE>Subscribes</span> to the Network Address Change
notifications<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>NetworkChange.NetworkAddressChanged</span> += new<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>NetworkAddressChangedEventHandler(</span>NetworkChange_NetworkAddressChanged);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// Standard <span class=SpellE>Page_Loaded</span> event handler<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>private</span> void <span class=SpellE>PhoneApplicationPage_Loaded</span>(object
sender,<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>RoutedEventArgs</span> e)<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>CheckCurrentNetworkType</span></span><span
class=GramE>(</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// Network Address Changed notifications event handler<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>private</span> void <span class=SpellE>NetworkChange_NetworkAddressChanged</span>(object
sender,<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>EventArgs</span> e)<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>CheckCurrentNetworkType</span></span><span
class=GramE>(</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=GramE>private</span> void <span class=SpellE>CheckCurrentNetworkType</span>()<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// <span class=GramE>Checking</span> the network type is not instantaneous<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// so it is advised to always do it on a background thread<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>ThreadPool.QueueUserWorkItem</span></span><span
class=GramE>(</span>(o) =&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// <span class=GramE>Determining</span> type of current network interface<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>internetConnectionType</span></span> =<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>Microsoft.Phone.Net.NetworkInformation</span></span><span
class=GramE>.</span><o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>NetworkInterface.NetworkInterfaceType</span>;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
// <span class=GramE>Synchronizing</span> with the UI thread in order to update
control<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>Dispatcher.BeginInvoke</span></span><span
class=GramE>(</span>() =&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE>textBlockConnectionType.Text</span> =<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span class=SpellE><span class=GramE>internetConnectionType.ToString</span></span><span
class=GramE>(</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
});<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
});<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<h3><b><span>6.3.2.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bandwidth
Awareness<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>In general, app developers do not care how the app's interaction
with the Internet is routed; i.e. whether it goes over a mobile or Wi-Fi
connection. However for some apps the type of connection matters, such as those
that offer an enhanced experience over a high-bandwidth Wi-Fi connection or
those <span class=GramE>that aim</span> for efficient use of a broadband mobile
network.<o:p></o:p></span></p>

<h4><b><span>References</span></b><span><o:p></o:p></span></h4>

<h4><span class=SpellE><b><span>NetworkInterface</span></b></span><b><span> class</span></b><span><o:p></o:p></span></h4>

<h5><a href="http://msdn.microsoft.com/en-%20us/library/microsoft.phone.net.networkinformation.networkinterface.networkinterfacetype%28v=VS.92%29.aspx"><span>http://msdn.microsoft.com/en-
us/library/microsoft.phone.net. networkinformation.networkinterface. networkinterfacetype%28v= VS.92%29.aspx</span></a><span><o:p></o:p></span></h5>

<h3 id="6_3_3_caching"><b><span>6.3.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Caching</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Caching of network resources is only partially supported by the
Silverlight engine. The Silverlight UI has in-memory resource cache designed
for improving rendering performance and <span class=SpellE>optimisation</span>
of memory. In most cases this cache is filled with local resources, but network
resources can be referenced as well. In general this only provides an advantage
for network resources referenced multiple times from within the XAML mark-up.
As this cache is stored in memory it isn't persistent and all data is lost with
every process restart. When it is most important to improve the performance of
apps during the tombstoning cycle, this feature becomes absolutely impractical
as all data loaded from the network is lost as soon as the app is closed or
suspended.<o:p></o:p></span></p>

<p class=MsoNormal><span>The bad news with respect to HTTP caching is that neither <span
class=SpellE>WebClient</span> nor <span class=SpellE>HttpWebRequest</span>
implement any caching features. Additional effort is required by the developer,
but depending on requirements it might be possible to put in place some simple
workarounds:<o:p></o:p></span></p>

<ul>
<li>Cached data feed – before parsing a recently downloaded XML or JSON data feed, first save it locally and then parse. Next time check whether the data has to bereloaded based on a fixed time interval. If not, load it from the local storage and process. This provides a good solution to Windows Phone Tombstoning</li>
<li>Image Cache – the approach here is to save downloaded images to the isolated storage first and then update the UI. If the namespace of image URL references is consistent it may be possible to implement simple naming for image files stored in one folder; otherwise a more sophisticated naming algorithm is needed. For any subsequent requests, first check whether the app already has a copy of the requested image, and then load it from the folder. This can be good for images that never change, otherwise a content expiration policy needs to be implemented and integrated with the server</li>
</ul>


<p class=MsoNormal><span>A few other tips:<o:p></o:p></span></p>

<ul>
<li>Bear in mind that not all data should be cached - it depends on the sensitivity of the information, its dynamic nature, etc.</li>
<li>Some data may never change or expire, such as logos</li>
<li>Design independent data loader classes which can be reused throughout the app</li>
<li>Don't integrate the data loader with the UI, always feed data through ViewModel</li>
<li>Use HttpWebRequest class with data loader, as it enables access to storage APIs and ViewModel on the main thread from the callback delegate; synchronisation with the UI thread will happen in ViewModel</li>
<li>The server component may already implement an expiration policy and communicate it via cache-control, last-modified or etag http headers (see RFC 2616 for full specification). It is relatively easy to read these attributes from WebResponse class</li>
</ul>

<p class=MsoNormal><span>Below are a few examples from the Windows Phone community:<o:p></o:p></span></p>

<p class=MsoNormal><i><span>Offline Data Cache in Windows Phone</span></i><span><o:p></o:p></span></p>

<h5><a
href="http://blogs.msdn.com/b/ukadc/archive/2010/10/21/offline-data-cache-in-windows-phone-7.aspx"><span>http://blogs.msdn.com/b/ukadc/archive/2010/10/21/offline-data-cache-in-windows-phone-7.aspx</span></a><span><o:p></o:p></span></h5>

<p class=MsoNormal><i><span>Image Caching on Tombstoning</span></i><span><o:p></o:p></span></p>

<h5><a
href="http://briankassay.com/blog/?p=95"><span>http://briankassay.com/blog/?p=95</span></a><span><o:p></o:p></span></h5>

<h3 id="6_3_4_security"><b><span>6.3.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Security</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Secure HTTPS communication is transparently supported by Windows
Phone at all levels including Silverlight UI framework (XAML referenced
resources) <span class=SpellE>WebClient</span> and <span class=SpellE>HttpWebRequest</span>
APIs:<o:p></o:p></span></p>

<p class=MsoNormal><span>// Uri to secure
resource<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span>System.Uri</span></span><span>
<span class=SpellE>uri</span> = new <span class=GramE>Uri(</span>&quot;https://service.live.com&quot;);<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span>WebClient</span></span><span>
<span class=SpellE>webClient</span> = new <span class=SpellE><span class=GramE>WebClient</span></span><span
class=GramE>(</span>);<o:p></o:p></span></p>

<p class=MsoNormal><span>Or<o:p></o:p></span></p>

<p class=MsoNormal><span>// Uri to secure resource<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span>System.Uri</span></span><span>
<span class=SpellE>uri</span> = new <span class=GramE>Uri(</span>&quot;https://service.live.com&quot;);<o:p></o:p></span></p>

<p class=MsoNormal><span>// <span class=GramE>Create</span>
a <span class=SpellE>HttpWebRequest</span> object to the desired URL<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span>HttpWebRequest</span></span><span> <span class=SpellE>httpWebRequest</span> = (<span class=SpellE>HttpWebRequest</span><span
class=GramE>)<span class=SpellE>WebRequest.Create</span></span>(<span
class=SpellE>uri</span>);<o:p></o:p></span></p>

<h3><b><span>6.3.4.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Authentication<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Windows Phone only supports Basic Authentication protocol which
does not encrypt user name or password. However, in order to implement secure
authentication using Basic Authentication protocol, it is only necessary to
ensure that:<o:p></o:p></span></p>

<ul>
<li>Communication at the time of authentication is performed over encrypted HTTPS connection </li>
<li>Data exchange after authentication is always performed over HTTPS connection </li>
</ul>


<p class=MsoNormal><span>It is not enough to exchange encrypted user credentials over
unencrypted HTTP protocol or authenticate the user over HTTPS and then
communicate over HTTP. The user's authentication token can be stolen and
credentials compromised.&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal><span>Tip: Always communicate over HTTPS when using unencrypted
authentication otherwise user credentials will be compromised&nbsp;<o:p></o:p></span></p>

<h3><b><span>6.3.4.1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mutual
Authentication<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Although trusted certificates can be installed on the Windows
Phone, in the current release, the platform does provide access to the
installed certificates from apps. As a result mutual authentication scenarios –
when the client sends its own certificates to the web service in addition to
receiving one – cannot be implemented.<o:p></o:p></span></p>

<h3><b><span>6.3.4.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Storing
User Credentials<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Isolated storage on Windows Phone is considered secure. However,
you should make additional efforts to encrypt user credentials before saving.
This will protect the information if access to the application storage is
obtained through physical device theft, following a jailbreak, or via accessing
devices' backup files. Windows Phone supports a number of encryption protocols
including AES, SHA1 and SHA256.<o:p></o:p></span></p>

<p class=MsoNormal><span>Use an example from the following source in order to encrypt your
data:<o:p></o:p></span></p>

<p class=MsoNormal><a
href="http://robtiffany.com/windows-phone-7/dont-forget-to-encrypt-your-windows-phone-7-data"><span>http://robtiffany.com/windows-phone-7/dont-forget-to-encrypt-your-windows-phone-7-data</span></a><span><o:p></o:p></span></p>

<h4><b><span>References</span></b><span><o:p></o:p></span></h4>

<h4><b><span>Web Service Security for Windows Phone</span></b><span><o:p></o:p></span></h4>

<h5><a
href="http://msdn.microsoft.com/library/windows/apps/gg521147(v=vs.105).aspx"><span>http://msdn.microsoft.com/library/windows/apps/gg521147(v=vs.105).aspx</span></a><span><o:p></o:p></span></h5>

<h4><b><span>Security for Windows Phone</span></b><span><o:p></o:p></span></h4>

<h5><a
href="http://msdn.microsoft.com/library/windows/apps/ff402533(v=vs.105).aspx"><span>http://msdn.microsoft.com/library/windows/apps/ff402533(v=vs.105).aspx</span></a><span><o:p></o:p></span></h5>

<h4><span class=SpellE><b><span>System.Security.Cryptography</span></b></span><b><span> Namespace</span></b><span><o:p></o:p></span></h4>

<h5><a
href="http://msdn.microsoft.com/en-us/library/system.security.cryptography(v=VS.95).aspx"><span>http://msdn.microsoft.com/en-us/library/system.security.cryptography(v=VS.95).aspx</span></a><span><o:p></o:p></span></h5>

<h3 id="6_3_5_push_notifications"><b><span>6.3.5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P</span></b><b><span>ush Notifications<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Microsoft Push Notification Service (MPNS) provides a resilient,
dedicated, and persistent channel to send data to a Windows Phone application
from a web service in a power-efficient way. Each device maintains one
connection with MPNS to receive notifications from the cloud. MPNS <span
class=SpellE>prioritises</span> delivery of notifications and differentiates
between Immediate, Medium and Low priorities. Medium and Low priority
notifications are normally delayed and aggregated with other messages to reduce
impact on device battery life, network traffic and therefore network <span
class=SpellE>signalling</span>. MPNS also differentiates between Toast, Tile
and RAW Notifications.<o:p></o:p></span></p>

<p class=MsoNormal><span>More information on APNs is available at:<o:p></o:p></span></p>

<h5><a
href="http://msdn.microsoft.com/library/windows/apps/ff402558(v=vs.105).aspx"><span>http://msdn.microsoft.com/library/windows/apps/ff402558(v=vs.105).aspx</span></a><span><o:p></o:p></span></h5>

<h3 id="6_3_6_data_ormats"><b><span>6.3.6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Data&nbsp;</span></b><b><span>Formats<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Windows Phone provides extensive support for XML-based services
out-of-the-box including WCF, XML <span class=SpellE>serialisation</span>, DOM
parser, Language Integrated Query (LINQ), XSD validation, etc.<o:p></o:p></span></p>

<p class=MsoNormal><span>JSON is only partially supported, with a limited <span
class=SpellE>serialiser</span>. For richer support of JSON, consider Open
Source product Json.NET (see reference below) which has a more flexible <span
class=SpellE>serialiser</span>, LINQ, conversion of JSON to and from XML.<o:p></o:p></span></p>

<h4><b><span>References</span></b><span><o:p></o:p></span></h4>

<h4><b><span>Json.Net</span></b><span><o:p></o:p></span></h4>

<h5><a href="http://json.codeplex.com/"><span>http://json.codeplex.com/</span></a><span><o:p></o:p></span></h5>

<h4><span class=SpellE><b><span>DataContractJsonSerializer</span></b></span><b><span> class</span></b><span><o:p></o:p></span></h4>

<h5><a
href="http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.datacontractjsonserializer(v=VS.95).aspx"><span>http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.datacontractjsonserializer(v=VS.95).aspx</span></a><span><o:p></o:p></span></h5>

<h3 id="6_3_7_compression">
<b><span>6.3.7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compression</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>The current Windows Phone APIs do not support HTTP compression and
fixing this issue is extremely difficult due to a number of limitations.
Although decompressing content encoded with <span class=SpellE>GZip</span> and
Deflate algorithms is not difficult, and open source libraries such as
Silverlight <span class=SpellE>SharpZipLib</span> are available, integration
with <span class=SpellE>WebClient</span> and <span class=SpellE>HttpWebRequest</span>
APIs is currently not possible due to protection put on HTTP Header
"Accept-Encoding".<o:p></o:p></span></p>

<p class=MsoNormal><span>Example:<o:p></o:p></span></p>

<p class=MsoNormal><span>// <span class=GramE>The</span>
following code will throw <span class=SpellE>ArgumentException</span> with the
following message:<o:p></o:p></span></p>

<p class=MsoNormal><span>// The 'Accept-Encoding'
header cannot be modified directly.<o:p></o:p></span></p>

<p class=MsoNormal><span>// Parameter name: name<o:p></o:p></span></p>

<p class=MsoNormal><span class=SpellE><span class=GramE><span>httpWebRequest.Headers</span></span></span><span
class=GramE><span>[</span></span><span
class=SpellE><span>HttpRequestHeader.AcceptEncoding</span></span><span>] = &quot;<span class=SpellE>gzip</span>&quot;;<o:p></o:p></span></p>

<h3 id="6_3_8_background_foreground_modes"><b><span>6.3.8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></b><b><span>Background /
Foreground&nbsp;</span></b><b><span>Modes<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Third party apps on the Windows Phone platform can only work in
the foreground and under the Lock Screen if permitted to do so. Every time a
normal app loses focus or calls Launcher or Chooser, it is immediately
instructed to shut down and is given 10 seconds to save data. This process,
called Tombstoning, supports the navigation interface and app with some tools
allowing the app to restore, save and then restore its state when reactivated.
Tombstoning, if not properly addressed, can have a significant impact on
network traffic, and user experience in general as apps often reload data from
the network when reactivated. This is considered bad practice and should always
be addressed by developers. Where appropriate, delay frequent updates – for
instance don't refresh a weather feed if the data was loaded minutes ago.<o:p></o:p></span></p>

<h4><b><span>References</span></b><span><o:p></o:p></span></h4>

<h4><b><span>Silverlight <span class=SpellE>SharpZipLib</span></span></b><span><o:p></o:p></span></h4>

<h5><a
href="http://slsharpziplib.codeplex.com/"><span>http://slsharpziplib.codeplex.com/</span></a><span><o:p></o:p></span></h5>

<h4><b><span>Execution Model for Windows Phone (Tombstoning)</span></b><span><o:p></o:p></span></h4>

<h5><a
href="http://msdn.microsoft.com/library/windows/apps/ff817008(v=vs.105).aspx"><span>http://msdn.microsoft.com/library/windows/apps/ff817008(v=vs.105).aspx</span></a><span><o:p></o:p></span></h5>

<h3 id="6_3_9_scheduling"><b><span>6.3.9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scheduling</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Since the major release of Windows Phone 7.5 ‘Mango', Windows
Phone addresses the need for scheduling of some background activities via
Background Agents. These allow an app to execute code in the background, even
when the app is not running in the foreground. Different types of Scheduled
Tasks are designed for different types of background processing scenarios, with
different <span class=SpellE>behaviours</span> and constraints.<o:p></o:p></span></p>

<ul>
<li>PeriodicTask – Implements periodic agent which runs for a small amount of time on a regular recurring interval
</li>
<li>ResourceIntensiveTask – Implements periodic agent which runs for a relatively long period of time when the phone meets a set of requirements</li>
</ul>


<p class=MsoNormal><span>Each app may have only one background agent, implemented as an app
component but with its lifecycle managed independently by the OS. In a
simplistic example, the OS would periodically execute all registered agents in
turn, so that only one agent is active at a time and has a limited time to run.
As soon as one agent finishes its procedure or gets terminated because of
reaching duration limit, the next agent is executed, and so on until the cycle
is complete. <span class=SpellE>PeriodicTask</span> and <span class=SpellE>ResourceIntensiveTask</span>
agents have different schedule, duration and constraints, in order to <span
class=SpellE>optimise</span> power consumption, network <span class=SpellE>signalling</span>
and traffic, and to <span class=SpellE>minimise</span> the impact on the user
experience.<o:p></o:p></span></p>

<p class=MsoNormal><span>For an overview, best practices and implementation details, refer
to:&nbsp;</span><a
href="http://msdn.microsoft.com/library/windows/apps/hh202942(v=vs.105).aspx"><span>http://msdn.microsoft.com/library/windows/apps/hh202942(v=vs.105).aspx</span></a><span><o:p></o:p></span></p>

<p class=MsoNormal><span>Windows Phone SDK includes a project template called Windows Phone
Scheduled Task Agent for use when implementing a background agent. Refer
to&nbsp;</span><a
href="http://msdn.microsoft.com/en-us/library/windows/apps/hh202942(v=vs.105).aspx"><span>http://msdn.microsoft.com/en-us/library/windows/apps/hh202942(v=vs.105).aspx</span></a><span>.<o:p></o:p></span></p>

<h2 id="7_video_delivery_over_mobile_networks"><b><span>7&nbsp;&nbsp;&nbsp;Video
Delivery over Mobile Networks</span></b><b><span><o:p></o:p></span></b></h2>

<h3 id="7_1_image_quality_experienced_by_customers_using_video_delivery_service"><b><span>7.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Image
Quality Experienced by Customers Using Video Delivery Service</span></b><b><span><o:p></o:p></span></b></h3>

<h3 id="7_1_1_factors_affecting_the_image_quality_of_video_delivery_service"><b><span>7.1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Factors
Affecting the Image Quality of Video Delivery Service</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>There are numerous factors that affect the quality of images
experienced by users (Quality of Experience) in video delivery service.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_27"
 o:spid="_x0000_i1032" type="#_x0000_t75" alt="clip_image051" style='width:450.75pt;
 height:242.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image022.gif"
  o:title="clip_image051"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=601 height=323
src="SAG_files/image022.gif"
alt="clip_image051" v:shapes="Picture_x0020_27"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 21</span></b><span><span>: Major Factors
Affecting the Elements and Image Quality of Video Delivery</span></span><span><o:p></o:p></span></p>

<p class=MsoNormal><span>Figure 1: illustrates elements of video delivery service over a
mobile network as well as major factors that affect the video image quality.
Video content is encoded in a format suitable for transmission over the network
and storage in the delivery server of a content provider. Operator networks
receive video content over the Internet, etc. and forward it via a radio link
such as an LTE network to smartphones, tablets, and other video viewing
terminals. The terminal that receives the video content decodes the data into
images that are to be displayed on its screen.<o:p></o:p></span></p>

<p class=MsoNormal><span>The image quality of video delivery service is affected by
different factors including the following:<o:p></o:p></span></p>

<p class=MsoNormal><span>1.&nbsp;&nbsp;&nbsp; Image encoding conditions;<o:p></o:p></span></p>

<p class=MsoNormal><span>2.&nbsp;&nbsp;&nbsp; Throughput characteristics of transmission of
encoded data over a mobile network;<o:p></o:p></span></p>

<p class=MsoNormal><span>3.&nbsp;&nbsp;&nbsp; Performance of the video viewing terminal.<o:p></o:p></span></p>

<p class=MsoNormal><span>First, the Image encoding conditions for video delivery include
the following aspects:<o:p></o:p></span></p>

<ul type=disc>
 <li class=MsoNormal><span>Coding scheme<o:p></o:p></span></li>
 <li class=MsoNormal><span>Encoding bitrate – When the
     bitrate is set low, it results in lack of sharpness (blurring) or
     mosaic-like distortions, which is called "block-noise", in images.<o:p></o:p></span></li>
 <li class=MsoNormal><span>Image resolution – When the image resolution is low, it
     reduces the definition of images.<o:p></o:p></span></li>
 <li class=MsoNormal><span>Frame rate – When the frame rate
     is low, it reduces the smoothness of motions, resulting in flickering and
     jerky images.<o:p></o:p></span></li>
</ul>

<p class=MsoNormal><span>Second, when the throughput of the mobile network is too low, the
download of video data cannot catch up with the playback of a video on the
terminal. As a result, the playback is halted until a certain amount of video
data is stored again in the terminal, which is called re-buffering. Such
throughput degradation can be caused by packet loss, packet transmission delay,
and delay variations that occur in the network.<o:p></o:p></span></p>

<p class=MsoNormal><span>Furthermore, regarding the performance of the video viewing
terminal, the image quality achieved on the terminal differs depending on its
decoding and display capabilities. Compared with smartphones, tablet terminals
have larger screens. This makes image deterioration on tablet terminals more
easily perceived even when both terminals are showing video with the same image
quality.<o:p></o:p></span></p>

<p class=MsoNormal><span>The factors affecting image quality are not mutually independent
but related. For instance, a higher encoding bitrate generally improves image
quality. However, if an unnecessarily high bitrate is used for video content
transfer, it may cause network congestion, resulting in throughput degradation.
Achieving efficient video delivery considering the level of congestion in a
mobile network requires a deep understanding of such quality factors.<o:p></o:p></span></p>

<h3 id="7_1_2_relationship_between_encoding_conditions_and_image_quality"><b><span>7.1.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relationship
between Encoding Conditions and Image Quality</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Understanding the relationship between encoding conditions and
image quality is most important to deliver video to users with optimized image
quality in accordance with the level of congestion in a mobile network. Please
note that encoding conditions hereinafter described include the coding schemes,
encoding bitrates, image resolutions, and frame rates to be adopted. In this
section, the relationship between encoding bitrate and image quality and the
relationship between image resolution/frame rate and image quality are
discussed.<o:p></o:p></span></p>

<h3><b><span>7.1.2.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relationship
between Encoding Bitrate and Image Quality<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Figure 22: shows a general relationship between encoding bitrate
and image quality. The horizontal axis shows the encoding bitrate while the
vertical axis shows the image quality. The higher the encoding bitrate is set,
the closer the image quality gets to that of the original video (the video
before encoding). However, the image quality comparable to that of the original
video can be obtained when a certain level of encoding bitrate is secured.
However, the effect of image quality improvement becomes more marginal when the
encoding bitrate is set too high beyond what is necessary.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_25"
 o:spid="_x0000_i1031" type="#_x0000_t75" alt="clip_image053" style='width:6in;
 height:261.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image023.gif"
  o:title="clip_image053"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=576 height=349
src="SAG_files/image023.gif"
alt="clip_image053" v:shapes="Picture_x0020_25"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 22</span></b><span><span>: Relationship between
Encoding Bitrate and Image Quality</span></span><span><o:p></o:p></span></p>

<p class=MsoNormal><span>The value of encoding bitrate that gives sufficient image quality
varies among coding schemes. Even when the same coding scheme is applied, the
image quality is different depending on encoder implementation (i.e. difference
in the encoding efficiency). Even when the same encoder is used, the image
quality may still be different depending on the level of definition and amount
of motion in the video. In general, video with a lower level of definition and
a smaller amount of motion can achieve high image quality at a lower bitrate.
However, a video with a higher level of definition and a larger amount of
motion requires a higher encoding bitrate to achieve high image quality. These
relationships are summarized in Figure 23:<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_24"
 o:spid="_x0000_i1030" type="#_x0000_t75" alt="clip_image055" style='width:441.75pt;
 height:141.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image024.gif"
  o:title="clip_image055"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=589 height=189
src="SAG_files/image024.gif"
alt="clip_image055" v:shapes="Picture_x0020_24"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 23</span></b><span><span>: Effects of
Implementation of Coding Schemes and Characteristics of Video on the
Relationship between Encoding Bitrate and Image Quality</span></span><span><o:p></o:p></span></p>

<h3><b><span>7.1.2.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relationship
between Image Resolution / Frame Rate and Image Quality<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>An increasing number of content providers are handling
high-resolution images such as those for high-definition television (HDTV) in
order to provide users with high-resolution video delivery service. The current
mobile network environment, however, is not always fully prepared to ensure the
bandwidth is sufficient for delivery of an HDTV-class video. This makes it
necessary to select a suitable image resolution and frame rate in order to
achieve higher video quality with a smaller bandwidth. Coding with a low image
resolution can yield high quality image in a low bandwidth. This relationship
is shown in Figure&nbsp;<b>2</b>4 in which, as an example, the encoder using
the bitrates B1, B2, and B3 achieves their optimal video image quality for the
image resolutions of 320×240, 640×480, and 1280×720, respectively. When an
encoding bitrate lower than a level of 100 to 200kbps is used, reducing the
frame rate is effective from the standpoint of maintaining the image quality.
However, reducing the frame rate in fast-motion video such as of a sport scene
will make the flickering and jerky parts more noticeable. Degradation in the
quality of experience can be minimized for content like video telephony even at
a low frame rate. However, for content of ordinary video delivery service, a
frame rate of approximately 15 frames per second is at least necessary.<o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span><!--[if gte vml 1]><v:shape id="Picture_x0020_23" o:spid="_x0000_i1029"
 type="#_x0000_t75" alt="clip_image057" style='width:447.75pt;height:351.75pt;
 visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image025.gif"
  o:title="clip_image057"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=597 height=469
src="SAG_files/image025.gif"
alt="clip_image057" v:shapes="Picture_x0020_23"><![endif]></span></b><b><span><o:p></o:p></span></b></p>

<p class=MsoNormal align=center><b><span>Figure 24</span></b><span><span>: Relationship between
Image Resolution and Image Quality</span></span><span><o:p></o:p></span></p>

<h3 id="7_1_3_degradation_in_quality_of_qxperience_in_a_congested_mobile_network"><b><span>7.1.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Degradation
in Quality of Experience in a Congested Mobile Network</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>This section describes characteristics of degradation in the
quality of experience that occurs when a mobile network is congested. As shown
in Figure 22: above, when a sufficient throughput is secured on a mobile
network, the image quality gradually improves as the encoding bitrate is raised
until such improvement comes to saturation at a certain point. However, even
when higher image quality is achieved with a higher encoding bitrate, video
playback may frequently stall in a congested mobile network due to insufficient
throughput. This causes a drastic deterioration in the user's quality of
experience. Figure 25: demonstrates an example in which degradation in the
quality of experience occurs at the throughputs of 300 and 500 kbps. In both
cases, the use of an encoding bitrate larger than the respective throughput
causes the video playback to stall, which lowers the quality of experience.
Such video stall not only degrades the quality of experience but also greatly
affects the length of video watching time (video viewing <span class=SpellE>behaviour</span>)
of users according to some reports. Therefore, it is necessary to prevent video
from stalling in order to maintain and improve the quality of video images.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_21"
 o:spid="_x0000_i1028" type="#_x0000_t75" alt="clip_image059" style='width:436.5pt;
 height:281.25pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image026.gif"
  o:title="clip_image059"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=582 height=375
src="SAG_files/image026.gif"
alt="clip_image059" v:shapes="Picture_x0020_21"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure <span class=GramE>25<span>&nbsp;Degradation
in Quality of Experience due to Video Stall</span></span></span></b><span><o:p></o:p></span></p>

<h3 id="7_2_technological_trends_of_video_delivery"><b><span>7.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Technological
Trends of Video Delivery</span></b><b><span><o:p></o:p></span></b></h3>

<h3 id="7_2_1_high_compression_codec_technologies"><b><span>7.2.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;High-Compression
Codec Technologies</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>The latest video compression standard HEVC or officially called
"ITU-T H.265 | ISO/IEC 23008-2 High Efficiency Video Coding" was approved by
the ITU in January 2013. HEVC is an all-purpose standard designed to address a
wide range of applications from video on small screens of mobile devices to
high-definition video with HD resolution of 4K, 8K or higher. The HEVC standard
was developed to double the compression rate compared with the conventional
H.264/AVC standard.<o:p></o:p></span></p>

<p class=MsoNormal><span>First, this section describes the terms "Profile," "Level," and
"Tier," which denote the playback capability of an H.265/HEVC decoder.<o:p></o:p></span></p>

<p class=MsoNormal><span>The current H.265/HEVC standard defines the following three
Profiles:<o:p></o:p></span></p>

<p class=MsoNormal><span>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Main Profile<o:p></o:p></span></p>

<p class=MsoNormal><span>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Main 10 Profile<o:p></o:p></span></p>

<p class=MsoNormal><span>·&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Main Still Picture
Profile<o:p></o:p></span></p>

<p class=MsoNormal><span>Both Main Profile and Main 10 Profile are profiles for video
compression, using different bit depths to express one pixel. Main Profile only
supports video with a depth of 8 bits per pixel while Main 10 Profile also
supports 10 bits per pixel in addition to 8 bits per pixel. Except for bit
depth coding, both Profiles use common technical elements for coding. Both of
them only support the <span class=SpellE>chroma</span> subsampling format of
4:2:0 (in which the amount of information on <span class=SpellE>colour</span>
difference is a quarter of that of brightness), which is for consumer
applications. An extension of the H.265/HEVC standard called <span
class=SpellE>RExt</span> is being standardized to support formats with a large <span
class=SpellE>colour</span> difference, such as 4:2:2 and 4:4:4, which are
mainly used for material transmission in broadcasting stations. HEVC <span
class=SpellE>RExt</span> also aims to support video with a bit depth higher
than 10bits per pixel. Thus, HEVC <span class=SpellE>RExt</span> is a standard
mainly targeted at compression and transmission of high-definition video, such
as digital cinema and material transmission. As for interlaced video, Main
Profile and Main 10 Profile can handle this type of video. However, they have
not introduced any coding tools specialized for interlaced video and currently
only use flags to mark it in the stream. In actual processing, interlaced video
is encoded as a progressive video with its top and bottom fields separated.<o:p></o:p></span></p>

<p class=MsoNormal><span>The table below discusses Levels and Tiers. There are 13 Levels
from 1 to 6.2, each of which mainly specifies the maximum resolution and frame
rate. The <span class=GramE>Tier,</span> is divided into two, the Main Tier and
the High Tier, each of which specifies the maximum bitrate at each level.
H.264/AVC does not have a concept of Tier but specifies everything including
the maximum resolution, frame rate, and bitrate, using the Level only. However,
this makes it difficult to address a case where only the bitrate should be
restricted. H.265/HEVC, which has newly introduced the concept of Tier, is able
to specify the restriction on the resolution, frame rate, and bitrate,
separately. Table 1 below shows a list of major resolutions, and Levels and
Tiers.<o:p></o:p></span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0>
 <tr>
  <th width=79 rowspan=2>
  <p class=MsoNormal align=center><b><span>Main Levels</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=227 rowspan=2>
  <p class=MsoNormal align=center><b><span>Examples of Maximum Resolution and Frame Rate</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=306 colspan=2>
  <p class=MsoNormal align=center><b><span>Maximum Video Bitrate (kbps)</span></b><span><o:p></o:p></span></p>
  </th>
 </tr>
 <tr>
  <th width=153>
  <p class=MsoNormal align=center><b><span>Main Tier</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=153>
  <p class=MsoNormal align=center><b><span>High Tier</span></b><span><o:p></o:p></span></p>
  </th>
 </tr>
 <tr>
  <td width=79>
  <p class=MsoNormal align=center><span>1<o:p></o:p></span></p>
  </td>
  <td width=227>
  <p class=MsoNormal align=center><span>QCIF 15fps<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal align=center><span>128<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal align=center><span>&#65293;</span><span><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=79>
  <p class=MsoNormal align=center><span>2<o:p></o:p></span></p>
  </td>
  <td width=227>
  <p class=MsoNormal align=center><span>CIF 30fps<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal align=center><span>1,500<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal align=center><span>&#65293;</span><span><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=79>
  <p class=MsoNormal align=center><span>3<o:p></o:p></span></p>
  </td>
  <td width=227>
  <p class=MsoNormal align=center><span>QHD (960 × 540) 30fps<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal align=center><span>6,000<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal align=center><span>&#65293;</span><span><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=79>
  <p class=MsoNormal align=center><span>4<o:p></o:p></span></p>
  </td>
  <td width=227>
  <p class=MsoNormal align=center><span>2K × 1080 (2048 × 1080) 30fps<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal align=center><span>12,000<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal align=center><span>30,000<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=79>
  <p class=MsoNormal align=center><span>5<o:p></o:p></span></p>
  </td>
  <td width=227>
  <p class=MsoNormal align=center><span>4096 × 2160 30fps<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal align=center><span>25,000<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal align=center><span>100,000<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=79>
  <p class=MsoNormal align=center><span>6<o:p></o:p></span></p>
  </td>
  <td width=227>
  <p class=MsoNormal align=center><span>8192 × 4096 30fps<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal align=center><span>60,000<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal align=center><span>240,000<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=79>
  <p class=MsoNormal align=center><span>6.2<o:p></o:p></span></p>
  </td>
  <td width=227>
  <p class=MsoNormal align=center><span>8192 × 4096 120fps<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal align=center><span>240,000<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal align=center><span>800,000<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal align=center><b><span>Table&nbsp;</span></b><span>1:
List of Main Resolutions, Levels, and Tiers<o:p></o:p></span></p>

<p class=MsoNormal><span>Listed below are specific examples of coding technologies used in
H.265/HEVC:<o:p></o:p></span></p>

<ul>
<li>Block partitioning</li>
<li>Inter and intra prediction</li>
<li>Orthogonal transform</li>
<li>Variable-length coding</li>
<li>In-loop filter</li>
</ul>

<p class=MsoNormal><span>As is the case with major conventional coding standards,
H.265/HEVC adopts a compression scheme based on a combination of motion
compensating prediction and orthogonal transform. H.265/HEVC doubles the
compression performance of H.264/AVC by accumulating improvements in individual
coding tools. However, H.265/HEVC has no compatibility with conventional
standards. Furthermore, its complexity gradually adds more processing load, especially
at the time of compression. To cope with this, researchers and developers are
working to develop an H.265/HEVC encoder capable of high-speed operation.<o:p></o:p></span></p>

<p class=MsoNormal><span>As shown in Figure 26:, a hierarchical block portioning structure
(Coding Tree Unit – CTU) is introduced to H.265/HEVC to enable efficient coding
of video images in widely varying levels of resolution. Each block in the CTU
is further split into subdivisions called PUs (Prediction Units). By combining
all these blocks, a wide variety of blocks can be used for coding, ranging from
the minimum size of 4x4 to the maximum size of 64x64.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_18"
 o:spid="_x0000_i1027" type="#_x0000_t75" alt="clip_image061" style='width:408pt;
 height:240pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image027.gif"
  o:title="clip_image061"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=544 height=320
src="SAG_files/image027.gif"
alt="clip_image061" v:shapes="Picture_x0020_18"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 26</span></b><span><span>: Block Partitioning
Method of H.265/HEVC</span></span><span><o:p></o:p></span></p>

<p class=MsoNormal><span>The introduction of this method has enabled H.265/HEVC to perform
complex block partitioning and optimized coding according to image
characteristics in each block, leading to compression performance improvement.<o:p></o:p></span></p>

<p class=MsoNormal><span>As for intra prediction, the number of prediction modes available
for H.265/HEVC has drastically increased to 35 from 9 for H.264/AVC. This
allows more precise prediction in combination with the blocks of different
sizes described above. Inter prediction (motion prediction), which has also
increased block size options, has introduced some innovative measures. They
include the use of a newly created merge mode and multiple prediction vector
candidates. Those measures have contributed to achieving higher compression
rates.<o:p></o:p></span></p>

<p class=MsoNormal><span>A hierarchical structure has also been introduced to orthogonal
transform. The ability to combine four sizes of orthogonal transform from 4x4
to 32x32 has greatly improved compression efficiency.<o:p></o:p></span></p>

<p class=MsoNormal><span>As for variable-length coding, the only scheme available is the
Context-Adaptive Binary Arithmetic Coding (CABAC), which has high compression
performance. H.264/AVC has used the Context-based Adaptive Variable Length
Coding (CAVLC), a lightweight scheme, in spite of its low compression
efficiency. On the other hand, this option has been excluded and is not
available for H.265/HEVC in consideration of the progress of device performance
in recent years.<o:p></o:p></span></p>

<p class=MsoNormal><span>For an in-loop filter, the de-blocking filter for block noise
reduction and the Sample Adaptive Offset (SAO) for ringing and pixel value
shift control have been introduced. These have contributed to achieving a
reduction of coding distortion.<o:p></o:p></span></p>

<p class=MsoNormal><span>Table 2 provides a
comparative summary of coding tools between H.265/HEVC and H.264/AVC.<o:p></o:p></span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0>
 <tr>
  <th width=204>
  <p class=MsoNormal align=center><b><span>Coding Tool</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=204>
  <p class=MsoNormal align=center><b><span>H.264/AVC (High Profile)</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=204>
  <p class=MsoNormal align=center><b><span>H.265/HEVC</span></b><span><o:p></o:p></span></p>
  </th>
 </tr>
 <tr>
  <td width=204>
  <p class=MsoNormal><span>Intra prediction<o:p></o:p></span></p>
  </td>
  <td width=204>
  <p class=MsoNormal><span>4×4 block: 9 modes<o:p></o:p></span></p>
  <p class=MsoNormal><span>8×8 block: 9 modes<o:p></o:p></span></p>
  <p class=MsoNormal><span>16×16 block: 4 modes<o:p></o:p></span></p>
  </td>
  <td width=204>
  <p class=MsoNormal><span>35 modes for 4×4 to
  64×64 block sizes<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=204>
  <p class=MsoNormal><span>Inter prediction
  (motion prediction)<o:p></o:p></span></p>
  </td>
  <td width=204>
  <p class=MsoNormal><span>4×4 to 16×16 blocks<o:p></o:p></span></p>
  <p class=MsoNormal><span>Quarter-<span
  class=SpellE>pel</span> accuracy search<o:p></o:p></span></p>
  </td>
  <td width=204>
  <p class=MsoNormal><span>8×4/4×8 to 64×64
  blocks<o:p></o:p></span></p>
  <p class=MsoNormal><span>Quarter-<span
  class=SpellE>pel</span> accuracy search<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=204>
  <p class=MsoNormal><span>Orthogonal transform<o:p></o:p></span></p>
  </td>
  <td width=204>
  <p class=MsoNormal><span>4×4 or 8×8<o:p></o:p></span></p>
  <p class=MsoNormal><span>Integer accuracy DCT<o:p></o:p></span></p>
  </td>
  <td width=204>
  <p class=MsoNormal><span>4×4 to 32×32 (4 types)<o:p></o:p></span></p>
  <p class=MsoNormal><span>Integer accuracy DCT<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=204>
  <p class=MsoNormal><span>Variable coding<o:p></o:p></span></p>
  </td>
  <td width=204>
  <p class=MsoNormal><span>2 types:<o:p></o:p></span></p>
  <ul type=disc>
   <li class=MsoNormal><span>Context-based Adaptive
       Variable Length Coding (CAVLC)<o:p></o:p></span></li>
   <li class=MsoNormal><span>Context-Adaptive Binary
       Arithmetic Coding (CABAC)<o:p></o:p></span></li>
  </ul>
  </td>
  <td width=204>
  <p class=MsoNormal><span>1 type:<o:p></o:p></span></p>
  <ul type=disc>
   <li class=MsoNormal><span>Context-Adaptive Binary
       Arithmetic Coding (CABAC)<o:p></o:p></span></li>
  </ul>
  </td>
 </tr>
 <tr>
  <td width=204>
  <p class=MsoNormal><span>In-loop filter<o:p></o:p></span></p>
  </td>
  <td width=204>
  <p class=MsoNormal><span>1 type:<o:p></o:p></span></p>
  <ul type=disc>
   <li class=MsoNormal><span>De-blocking filter<o:p></o:p></span></li>
  </ul>
  </td>
  <td width=204>
  <p class=MsoNormal><span>2 types:<o:p></o:p></span></p>
  <ul type=disc>
   <li class=MsoNormal><span
       class=SpellE><span>Deblocking</span></span><span> filter<o:p></o:p></span></li>
   <li class=MsoNormal><span>Sample Adaptive Offset (SAO)<o:p></o:p></span></li>
  </ul>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal align=center><b><span>Table&nbsp;</span></b><span></span><span>2: Comparative Summary of Coding Tools of H.264/AVC and H.265/HEVC<o:p></o:p></span></p>

<h3 id="7_2_2_video_streaming_technologies"><b><span>7.2.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Video
Streaming Technologies</span></b><b><span><o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Video streaming technologies are available for delivery of video
content over a network. Video streaming technologies are mainly divided into
two groups depending on the protocols they use: HTTP and non-HTTP (RTSP:
Real-Time Streaming Protocol, etc.). Video delivery services today use
HTTP-based streaming technologies. This is because the HTTP protocol has
excellent conformity with standard web servers and existing server systems in
that it can make use of HTTP cache. HTTP is also highly compatible with user
systems in that it can transparently go through firewalls and NATs. Most
well-known HTTP-based streaming technologies are HTTP streaming and HTTP
adaptive streaming.<o:p></o:p></span></p>

<p class=MsoNormal><span>In video delivery, the quality of user experience is affected by
the quality of video (resolution, frame rate, etc.) and the smoothness of
playback. Raising the quality of video increases the amount of data (bitrate)
flowing over the network. The more the video bitrate exceeds the transfer
speed, the more frequently video playback will be interrupted. In this manner,
video quality and playback smoothness are in the relationship of trade-off.
This is especially the case in a mobile environment, which is characterized by
an unstable and highly fluctuating transfer speed, and the challenge is how to
ensure playback smoothness. HTTP adaptive streaming is aimed at mitigating such
trade-off.<o:p></o:p></span></p>

<h3><b><span>7.2.2.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HTTP
Streaming (Pseudo Streaming)<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>This is the most widely utilized streaming technology in video
delivery service. In HTTP streaming, when the user starts video playback, it
triggers the download of a selected video file from the web server. A video
playback application (web browser or media browser) performs sequential playback
of the buffered video data in parallel with the download of the video file.<o:p></o:p></span></p>

<p class=MsoNormal><span>The bitrate of the downloaded video data is fixed from the start
to the end of its playback. When the bitrate of the specified video data is
high, it takes a long time until the start of playback due to a large amount of
data to be buffered. Although the amount of data in the buffer is reduced as
the playback proceeds, the playback will be interrupted if the buffer is
exhausted. To restart the playback, it is necessary to obtain buffered data
once again. If the user cancels the playback at this point, the data not yet
played back will be discarded. This means that the resources of the server and
network used for the download will be wasted.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_16"
 o:spid="_x0000_i1026" type="#_x0000_t75" alt="clip_image063" style='width:447pt;
 height:303.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image028.gif"
  o:title="clip_image063"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=596 height=405
src="SAG_files/image028.gif"
alt="clip_image063" v:shapes="Picture_x0020_16"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 27</span></b><span>:
HTTP Streaming<o:p></o:p></span></p>

<h3><b><span>7.2.2.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HTTP
Adaptive Streaming<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>To deliver high-quality video to a variety of devices (PCs, TVs,
smartphones, etc.) using various network environments (Wi-Fi, 3G/ LTE, fixed
networks, etc.), a streaming technology that enables switching of bitrates
according to specific network environments has been developed. The technology
is called HTTP Adaptive Streaming.<o:p></o:p></span></p>

<p class=MsoNormal><span>Even in a mobile network, which features ever-changing network
conditions, this streaming technology can achieve almost uninterrupted, smooth
video streaming by delivering video data with a bitrate suitable to the network
environment. This technology can reduce the gap between transfer speeds and
video data bitrates. This makes it possible to reduce the amount of buffer and
thus shorten the time required before the start of playback.<o:p></o:p></span></p>

<p class=MsoNormal><span>Furthermore, with this technology, the server does not need to
send an entire video file at one time, but send a part much data of the file as
requested by the device receiving the video. This reduces the amount of data
discarded even when the user cancels the playback. Therefore, it can
effectively reduce waste of the server and network.<o:p></o:p></span></p>

<p class=MsoNormal align=center><span><!--[if gte vml 1]><v:shape id="Picture_x0020_15"
 o:spid="_x0000_i1025" type="#_x0000_t75" alt="clip_image065" style='width:448.5pt;
 height:303.75pt;visibility:visible;mso-wrap-style:square'>
 <v:imagedata src="SAG_files/image029.gif"
  o:title="clip_image065"/>
</v:shape><![endif]--><![if !vml]><img border=0 width=598 height=405
src="SAG_files/image029.gif"
alt="clip_image065" v:shapes="Picture_x0020_15"><![endif]></span><span><o:p></o:p></span></p>

<p class=MsoNormal align=center><b><span>Figure 28</span></b><span>:
HTTP Adaptive Streaming<o:p></o:p></span></p>

<h3 id="7_3_suggested_measures_of_efficient_network_utilization"><b><span>7.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Suggested
Measures of Efficient Network Utilization</span></b><b><span><o:p></o:p></span></b></h3>

<h3 id="7_3_1_optimization_of_content_bit_rate"><b><span>7.3.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Optimization
of Content Bit Rate (Image Quality)</span></b><b><span><o:p></o:p></span></b></h3>

<h3><b><span>7.3.1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Optimization
for H.264 / AVC<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Table 3 shows a general relationship between the video image
quality and the suggested image resolution and encoding bitrate for the
H.264/AVC coding technology. The "image quality" in the table means the quality
of images experienced by the user (quality of experience) who watches the
video. The image quality in the table is quantified based on the subjective
perception (subjective quality) of human users, such as "clear image," "smooth
video," and "image quality degradation perceptible but not annoying". The image
quality was determined based on the results of evaluation conducted using the
ACR Method (Absolute Category Rating Method), which is an evaluation method
adopted as an international standard. Specifically, the quality of images of
different types of content was evaluated. The suggested conditions for High,
Middle, and Low image quality levels are derived from the content which showed
average quality characteristics and evaluated to have ratings of 4, 3, and 2
respectively on the MOS (Mean Opinion Score) scale.<o:p></o:p></span></p>

<p class=MsoNormal><span>Table 3 shows results of a case using Main Profile as the profile,
a frame rate of 30fps, and a random access interval of approximately one second
(32 frames). As described earlier, when the encoding bitrate becomes low, the use
of low image resolution helps reduce image quality degradation. The table shows
a sample case in which the image resolutions are changed corresponding to the
encoding bitrates<o:p></o:p></span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0>
 <tr>
  <th width=153 rowspan=2>
  <p class=MsoNormal align=center><b><span>Coding Scheme</span></b><span><o:p></o:p></span></p>
  <p class=MsoNormal align=center><b><span>H.264/AVC</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=459 colspan=3>
  <p class=MsoNormal align=center><b><span>Image quality</span></b><span><o:p></o:p></span></p>
  </th>
 </tr>
 <tr>
  <th width=153>
  <p class=MsoNormal align=center><b><span>Low</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=153>
  <p class=MsoNormal align=center><b><span>Middle</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=153>
  <p class=MsoNormal align=center><b><span>High</span></b><span><o:p></o:p></span></p>
  </th>
 </tr>
 <tr>
  <td width=153>
  <p class=MsoNormal><span>Suggested image<o:p></o:p></span></p>
  <p class=MsoNormal><span>Resolution<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal><span>360p-equivalent<o:p></o:p></span></p>
  <p class=MsoNormal><span>(640×360)<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal><span>360p-equivalent<o:p></o:p></span></p>
  <p class=MsoNormal><span>(640×360)<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal><span>720p-equivalent<o:p></o:p></span></p>
  <p class=MsoNormal><span>(1280×720)<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=153>
  <p class=MsoNormal><span>Suggested video<o:p></o:p></span></p>
  <p class=MsoNormal><span>encoding bitrate<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal><span>S: ~350kbps<o:p></o:p></span></p>
  <p class=MsoNormal><span>T/P: ~400kbps<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal><span>S: ~700kbps<o:p></o:p></span></p>
  <p class=MsoNormal><span>T/P: ~800kbps<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal><span>S: ~1.4Mbps<o:p></o:p></span></p>
  <p class=MsoNormal><span>T/P: ~1.6Mbps<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal align=center><b><span>Table&nbsp;</span></b><span></span><span>3: Relationship between Image Quality and Suggested Image
Resolution/Encoding Bitrate for H.264/AVC<o:p></o:p></span></p>

<ul>
<li>"S" stands for Smartphones: evaluation results from video viewing on 4.7-inch smartphones.</li>
<li>"T/P" stands for Tablets and PCs: evaluation results from video viewing on 15.5-inch notebook PCs.</li>
<li>The values of the suggested video encoding bitrates are subject to change.</li>
</ul>

<h3><b><span>7.3.1.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Optimization
for H.265 / HEVC<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>An effective measure to achieve high image quality at a lower
encoding bitrate than that of H.264/AVC is to use a coding scheme with a high
compression capability. The latest H.265/HEVC coding scheme discussed in
Section 7.2.1 is said to almost double the compression efficiency compared to
H.264/AVC. Therefore, H.265/HEVC is expected to be widely utilized in the
mobile video delivery market in the future. Table 4 shows a general
relationship between image quality and suggested image resolutions and encoding
bitrates for the current H.265/HEVC coding technology. The table shows results
of a case study that uses Main Profile as the profile, a frame rate of 30fps,
and a random access interval of approximately one second (32 frames). Future
improvements in H.265/HEVC implementation technology are expected to achieve
even higher compression levels.<o:p></o:p></span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0>
 <tr>
  <th width=153 rowspan=2>
  <p class=MsoNormal align=center><b><span>Coding Scheme</span></b><span><o:p></o:p></span></p>
  <p class=MsoNormal align=center><b><span>H.265/HEVC</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=459 colspan=3>
  <p class=MsoNormal align=center><b><span>Image quality</span></b><span><o:p></o:p></span></p>
  </th>
 </tr>
 <tr>
  <th width=153>
  <p class=MsoNormal align=center><b><span>Low</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=153>
  <p class=MsoNormal align=center><b><span>Middle</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=153>
  <p class=MsoNormal align=center><b><span>High</span></b><span><o:p></o:p></span></p>
  </th>
 </tr>
 <tr>
  <td width=153>
  <p class=MsoNormal><span>Suggested image<o:p></o:p></span></p>
  <p class=MsoNormal><span>Resolution<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal><span>360p-equivalent<o:p></o:p></span></p>
  <p class=MsoNormal><span>(640×360)<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal><span>360p-equivalent<o:p></o:p></span></p>
  <p class=MsoNormal><span>(640×360)<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal><span>720p-equivalent<o:p></o:p></span></p>
  <p class=MsoNormal><span>(1280×720)<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=153>
  <p class=MsoNormal><span>Suggested video<o:p></o:p></span></p>
  <p class=MsoNormal><span>encoding bitrate<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal><span>S: ~200kbps<o:p></o:p></span></p>
  <p class=MsoNormal><span>T/P: ~200kbps<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal><span>S: ~350kbps<o:p></o:p></span></p>
  <p class=MsoNormal><span>T/P: ~400kbps<o:p></o:p></span></p>
  </td>
  <td width=153>
  <p class=MsoNormal><span>S: ~700kbps<o:p></o:p></span></p>
  <p class=MsoNormal><span>T/P: ~800khbps<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal align=center><b><span>Table&nbsp;</span></b><span>4:
Relationship between Image Quality and Suggested Image Resolution/Encoding
Bitrate for H.265/HEVC<o:p></o:p></span></p>


<ul>
<li>"S" stands for Smartphones: evaluation results from video viewing on 4.7-inch smartphones.</li>
<li>"T/P" stands for Tablets and PCs: evaluation results from video viewing on 15.5-inch notebook PCs.</li>
<li>The values of the suggested video encoding bitrates are subject to change.</li>
<li>In H.265/HEVC, when a high image resolution is used, coding may take a long time.</li>
</ul>


<h3 id="7_3_2_optimization_of_delivery_bit_rate"><b><span>7.3.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Optimization
of Delivery Bit Rate (Quality of Experience)</span></b><b><span><o:p></o:p></span></b></h3>

<h3><b><span>7.3.2.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Video
Streaming Technologies Suitable for a Mobile Environment<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Table 5 shows the status of support on Android and iOS platforms
for the streaming technologies discussed in Section 7.2.2. HTTP Adaptive
Streaming has multiple technologies. Although they share the same basic concept
of switching content files according to the state of the network, they adopt
different file formats. MPEG-DASH (Dynamic Adaptive Streaming over HTTP) is an
ISO/IEC standard and is officially supported on Android 4.4 and higher. HLS
(HTTP Live Streaming) is a proprietary technology of Apple Inc., although it is
supported on both Android and iOS platforms. These two HTTP Adaptive Streaming
technologies and HTTP streaming are the three technology options for video
delivery for mobile devices. As stated in Section 7.2.2, in light of a mobile
environment, the adoption of HTTP Adaptive Streaming (MPEG-DASH or HLS) is
expected to improve user experience.<o:p></o:p></span></p>

<p class=MsoNormal><span>This section describes suggested operation methods for each of the
HTTP Streaming and HTTP Adaptive Streaming technologies in a mobile
environment.<o:p></o:p></span></p>

<div align=center>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0>
 <tr>
  <th width=199 colspan=2>
  <p class=MsoNormal align=center><b><span>Technology</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=84>
  <p class=MsoNormal align=center><b><span>Specified By</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=216>
  <p class=MsoNormal align=center><b><span>Support on Android (*1)</span></b><span><o:p></o:p></span></p>
  </th>
  <th width=113>
  <p class=MsoNormal align=center><b><span>Support on iOS</span></b><span><o:p></o:p></span></p>
  </th>
 </tr>
 <tr>
  <td width=199 colspan=2>
  <p class=MsoNormal><span>HTTP Streaming<o:p></o:p></span></p>
  </td>
  <td width=84>
  <p class=MsoNormal align=center><span>–<o:p></o:p></span></p>
  </td>
  <td width=216>
  <p class=MsoNormal align=center><span>Supported<o:p></o:p></span></p>
  </td>
  <td width=113>
  <p class=MsoNormal align=center><span>Supported<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=85 rowspan=4>
  <p class=MsoNormal><span>HTTP Adaptive
  Streaming<o:p></o:p></span></p>
  </td>
  <td width=114>
  <p class=MsoNormal><span>MPEG-DASH<o:p></o:p></span></p>
  </td>
  <td width=84>
  <p class=MsoNormal align=center><span>ISO/IEC<o:p></o:p></span></p>
  </td>
  <td width=216>
  <p class=MsoNormal align=center><span>Android 4.4 and higher (*2)<o:p></o:p></span></p>
  </td>
  <td width=113>
  <p class=MsoNormal align=center><span>Not supported<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=114>
  <p class=MsoNormal><span>HLS<o:p></o:p></span></p>
  </td>
  <td width=84>
  <p class=MsoNormal align=center><span>Apple<o:p></o:p></span></p>
  </td>
  <td width=216>
  <p class=MsoNormal align=center><span>Android 4.0 and higher<o:p></o:p></span></p>
  </td>
  <td width=113>
  <p class=MsoNormal align=center><span>Supported<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=114>
  <p class=MsoNormal><span>Smooth Streaming<o:p></o:p></span></p>
  </td>
  <td width=84>
  <p class=MsoNormal align=center><span>Microsoft<o:p></o:p></span></p>
  </td>
  <td width=216>
  <p class=MsoNormal align=center><span>Not supported<o:p></o:p></span></p>
  </td>
  <td width=113>
  <p class=MsoNormal align=center><span>Not supported<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width=114>
  <p class=MsoNormal><span>HTTP Dynamic Streaming<o:p></o:p></span></p>
  </td>
  <td width=84>
  <p class=MsoNormal align=center><span>Adobe<o:p></o:p></span></p>
  </td>
  <td width=216>
  <p class=MsoNormal align=center><span>Not supported<o:p></o:p></span></p>
  </td>
  <td width=113>
  <p class=MsoNormal align=center><span>Not supported<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal align=center><b><span>Table&nbsp;</span></b><span>5:
HTTP-based Streaming Technologies<o:p></o:p></span></p>

<p class=MsoNormal><span>(*1) The support status is based on a standard Android
implementation. For the support status on smartphones, please refer to
products' specifications.<o:p></o:p></span></p>

<p class=MsoNormal><span>(*2) Android 4.4 provides a video playback API, which will be
necessary to support MPEG-DASH. The use of MPEG-DASH in video delivery requires
implementation of MPD (Media Presentation Description) file analysis and
processing of adaptive streaming logic using the above-mentioned video playback
API on the video playback application.<o:p></o:p></span></p>

<h3><b><span>7.3.2.1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HTTP
Adaptive Streaming<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>In the ever-changing state of the mobile communications
environment, it is suggested that HTTP Adaptive Streaming technology be adopted
for its ability to provide smooth and uninterrupted video streaming and to
effectively utilize network resources. While HLS and MPEG-DASH are supported on
Android OS and iOS, it is requested that the choice of technology be determined
based on whether it is supported by the target Operating System(s) in video
delivery, the content generation tools used, and the delivery server.<o:p></o:p></span></p>

<p class=MsoNormal><span>To take advantage of the benefits of Adaptive Streaming
technology, it is suggested that a set of three video stream files in three
different bitrates be prepared (in case of HLS, four files (bitrates) because a
file of an audio-only stream is also included). While the relationship between
image resolution and bitrate was explained in Section 7.3.1., it is requested
that the image resolution level in each stream be adjusted with some margins
added to lower and higher rates to make a wider range of bitrate available.<o:p></o:p></span></p>

<h3><b><span>7.3.2.1.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HTTP
Streaming (Pseudo Streaming)<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>For video delivery using HTTP streaming technology, it is
suggested that content be made available at several different bitrates and
image resolutions to allow users to choose the image quality they prefer
according to the states of their network and usage. Please refer to Section
7.3.1 for the relationship between image resolution and bitrate.<o:p></o:p></span></p>

<h3><b><span>7.3.2.1.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Download
Scheme<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>The Download scheme is highly effective to enable users to
comfortably watch video in a mobile environment. Users can experience
stress-free playback when they are on the road and in an unstable network
environment by downloading video data in a stable network environment in
advance.<o:p></o:p></span></p>

<h3><b><span>7.3.2.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time
Zone-based Delivery Rate Control<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>In Section 7.1, a drastic degradation of image quality resulting
from video stall was explained. This problem occurs in a congested mobile
network even when the encoding bitrate is raised to improve image quality. In
order to avoid such degradation, it will be effective to perform the following
delivery rate control after preparing data sets of the same video in multiple
encoding bitrates. In doing so, please use the peak time zones in your targeted
mobile network and suggested encoding bitrates in Section 7.3.1 as reference.<o:p></o:p></span></p>

<ul class="numeric">
<li>Choose video data encoded in a low bitrate for a time zone where a mobile network is congested</li>
<li>Do not use an unnecessarily high coding bitrate for access from a mobile network even in a time zone where the mobile network is not congested.</li>
</ul>

<h3><b><span>7.3.2.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UI
(User Interface) Enabling Selection of Delivery Bit Rate<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>To enable users to smoothly change bitrate according to their
network state even in the middle of playback is one of the simple and effective
means to improve quality of experience for users. This approach mitigates
users' dissatisfaction because they are given power to make a decision during
video viewing as to which to prioritize, image quality or smooth playback.<o:p></o:p></span></p>

<p class=MsoNormal><span>The above-mentioned
measure is suggested to be used in fixed rate video delivery such as HTTP
streaming and progressive download.<o:p></o:p></span></p>

<h3 id="7_3_3_other_optimization_measures"><b><span>7.3.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Other
Optimization Measures</span></b><b><span><o:p></o:p></span></b></h3>

<h3><b><span>7.3.3.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adjustment
of Still Images on Web Sites<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>In video delivery service, still images on the web sites to
introduce video have the second largest volume of data following video images
themselves. Although the use of rich still images is effective in introducing
video, slow browsing caused by "heavy" web sites is a serious issue that can
prompt users to cancel services. For the use of still images on web sites, the
following are four known approaches that can be taken. It is strongly
recommended that their introduction be considered in combination with video
delivery schemes to improve quality of experience perceived by users visiting
web sites.<o:p></o:p></span></p>

<h3><b><span>7.3.3.1.1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Resizing
for Optimal Resolution<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Still images are used in various sizes in web sites. When only the
visual quality of an image is taken into consideration, generating a reduced
version of a big file will suffice. From the standpoint of disk capacity,
however, maintaining multiple sizes of one still image may not be always
preferred. However, sending an image in an appropriate size greatly reduces the
volume of data. Data volume reduction leads not only to shorter transfer time
but also to faster and smoother drawing processing on smartphones. This
improves the quality of experience for users.<o:p></o:p></span></p>

<h3><b><span>7.3.3.1.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Image
Volume Reduction (Optimization)<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>One of the effective measures well known since the feature phone
age is the utilization of image volume reduction (optimization) tools. These
tools can reduce the volume of images by modifying them to an extent that is
difficult to recognize with the human eye. Data compression methods used by
tools include increasing compression ratio in JPEG, use of PNG24 or PNG8 in
PNG, and deletion of header information such as <span class=SpellE>Exif</span> information<o:p></o:p></span></p>

<h3><b><span>7.3.3.1.3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Utilization
of Browser Cache<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>Utilizing browser cache, known as a measure for faster web
browsing, is effective for images and large-sized JavaScript/CSS files.<o:p></o:p></span></p>

<p class=MsoNormal><span>Setting cache control of the browser on a web server used for delivery
of images enables the same images to be displayed when users open the web page
again. This is done without the need for transfer (or with a request with an
if-modified-since header) or download of images.<o:p></o:p></span></p>

<h3><b><span>7.3.3.1.4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Delayed
Image Loading<o:p></o:p></span></b></h3>

<p class=MsoNormal><span>In web pages, images are used even outside the display area. A
mechanism to delay loading of those images until the time they enter the
display area can shorten the loading time required to complete a screen
transition.<o:p></o:p></span></p>

<p class=MsoNormal><span>There are some plugins publicly available (e.g., Lazy Load Plugin
for jQuery), which can be used to facilitate the introduction of the
above-mentioned mechanism and to improve the quality of the experience for
users.<o:p></o:p></span></p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
